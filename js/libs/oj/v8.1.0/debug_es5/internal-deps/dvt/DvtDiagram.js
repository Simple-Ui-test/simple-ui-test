define(["jquery","./DvtToolkit","./DvtPanZoomCanvas","./DvtOverview"],(function(t,e){"use strict";
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */return function(t){
/**
   * @license
   * Copyright (c) 2008 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var e=function(t){this.Init(t)};t.Obj.createSubclass(e,t.Obj,"DvtDiagramLayoutContext"),e.prototype.Init=function(t){this._nodeCount=0,this._linkCount=0,this._bLocaleR2L=!1,this._nodes=new t.ojMap,this._links=new t.ojMap,this._arNodes=[],this._arLinks=[],this._dirtyContext=new t.ojMap,this.Context=t},e.prototype.setLayout=function(t){this._layout=t},e.prototype.getLayout=function(){return this._layout},e.prototype.setLayoutAttributes=function(t){this._layoutAttrs=t},e.prototype.getLayoutAttributes=function(){return this._layoutAttrs},e.prototype.addNode=function(t){this.getNodeById(t.getId())||(this._nodeCount++,this._arNodes.push(t)),this._nodes.set(t.getId(),t)},e.prototype.addNodeToMap=function(t){this._nodes.set(t.getId(),t)},e.prototype.removeNode=function(e,n){n&&(e?t.ArrayUtils.removeItem(e.getChildNodes(),n):(t.ArrayUtils.removeItem(this._arNodes,n),this._nodeCount--),this._nodes.delete(n.getId()))},e.prototype.getNodeById=function(t){return this._nodes.get(t)},e.prototype.getNodeByIndex=function(t){return this._arNodes[t]},e.prototype.getNodeCount=function(){return this._nodeCount},e.prototype.addLink=function(t){this.getLinkById(t.getId())||(this._linkCount++,this._arLinks.push(t)),this._links.set(t.getId(),t)},e.prototype.removeLink=function(e){e&&(this.getLinkById(e.getId())&&(t.ArrayUtils.removeItem(this._arLinks,e),this._linkCount--),this._links.delete(e.getId()))},e.prototype.getLinkById=function(t){return this._links.get(t)},e.prototype.getLinkByIndex=function(t){return this._arLinks[t]},e.prototype.getLinkCount=function(){return this._linkCount},e.prototype.localToGlobal=function(e,n){var i=this.GetGlobalOffset(n);return new t.DiagramPoint(e.x+i.x,e.y+i.y)},e.prototype.GetGlobalOffset=function(e){for(var n=new t.DiagramPoint(0,0);e;){n.x+=e.ContentOffset.x+e.getPosition().x,n.y+=e.ContentOffset.y+e.getPosition().y;var i=e.getContainerId();if(i){if((e=this.getNodeById(i))&&e.isDisclosed()){var o=e.getContainerPadding();o&&(n.x+=o.left,n.y+=o.top)}}else e=null}return n},e.prototype.setLocaleR2L=function(t){this._bLocaleR2L=t},e.prototype.isLocaleR2L=function(){return this._bLocaleR2L},e.prototype.setComponentSize=function(t){this._componentSize=t},e.prototype.getComponentSize=function(){return this._componentSize},e.prototype.setViewport=function(t){this._viewport=t},e.prototype.getViewport=function(){return this._viewport},e.prototype.setContainerId=function(t){this._containerId=t},e.prototype.getContainerId=function(){return this._containerId},e.prototype.setContainerPadding=function(t,e,n,i){this.getContainerId()&&(this._containerPadding={},"number"!=typeof t&&"string"!=typeof t&&(i=t.left,e=t.right,n=t.bottom,t=t.top),this._containerPadding.top=t,this._containerPadding.right=e,this._containerPadding.bottom=n,this._containerPadding.left=i)},e.prototype.getContainerPadding=function(){return this._containerPadding},e.prototype.setCurrentViewport=function(t){this._currentViewport=t},e.prototype.getCurrentViewport=function(){return this._currentViewport},e.prototype.getCommonContainer=function(e,n){for(var i=function(t,e){for(var n=[],i=e.getNodeById(t)?e.getNodeById(t).getContainerId():null;i;)n.push(i),i=e.getNodeById(i)?e.getNodeById(i).getContainerId():null;return n.reverse(),n},o=i(e,this),a=i(n,this),s=null,r=0;r<o.length&&r<a.length&&t.BaseDiagram.compareValues(this.Context,o[r],a[r]);r++)s=o[r];return s},e.prototype.getEventData=function(){return this._eventData},e.prototype.setEventData=function(t){this._eventData=t},e.prototype.setDirtyContext=function(t){this._dirtyContext=t},e.prototype.getDirtyContext=function(){return this._dirtyContext};
/**
   * @license
   * Copyright (c) 2008 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var n=function(){this.Init()};t.Obj.createSubclass(n,t.Obj,"DvtDiagramLayoutContextLink"),n.prototype.Init=function(){this._startConnectorOffset=0,this._endConnectorOffset=0,this._linkWidth=1,this._selected=!1,this._bPromoted=!1},n.prototype.setId=function(t){this._id=t},n.prototype.getId=function(){return this._id},n.prototype.setStartId=function(t){this._startId=t},n.prototype.getStartId=function(){return this._startId},n.prototype.setEndId=function(t){this._endId=t},n.prototype.getEndId=function(){return this._endId},n.prototype.setPoints=function(e){this._points="string"==typeof e?t.PathUtils.createPathArray(e):e,this.setDirty()},n.prototype.getPoints=function(){return this._points},n.prototype.setLabelPosition=function(t){this._labelPosition=t,this.setDirty()},n.prototype.getLabelPosition=function(){return this._labelPosition},n.prototype.setLabelBounds=function(t){this._labelBounds=t},n.prototype.getLabelBounds=function(){return this._labelBounds},n.prototype.setStartConnectorOffset=function(t){this._startConnectorOffset=t},n.prototype.getStartConnectorOffset=function(){return this._startConnectorOffset},n.prototype.setEndConnectorOffset=function(t){this._endConnectorOffset=t},n.prototype.getEndConnectorOffset=function(){return this._endConnectorOffset},n.prototype.setLinkWidth=function(t){this._linkWidth=t},n.prototype.getLinkWidth=function(){return this._linkWidth},n.prototype.setLayoutAttributes=function(t){this._layoutAttrs=t},n.prototype.getLayoutAttributes=function(){return this._layoutAttrs},n.prototype.setSelected=function(t){this._selected=t},n.prototype.getSelected=function(){return this._selected},n.prototype.setLabelRotationAngle=function(t){this._labelRotAngle=t,this.setDirty()},n.prototype.getLabelRotationAngle=function(){return this._labelRotAngle},n.prototype.setLabelRotationPoint=function(t){this._labelRotPoint=t,this.setDirty()},n.prototype.getLabelRotationPoint=function(){return this._labelRotPoint},n.prototype.setPromoted=function(t){this._bPromoted=t},n.prototype.isPromoted=function(){return this._bPromoted},n.prototype.setLabelValign=function(t){this._labelValign=t,this.setDirty()},n.prototype.setLabelHalign=function(t){this._labelHalign=t,this.setDirty()},n.prototype.getLabelValign=function(){return this._labelValign},n.prototype.getLabelHalign=function(){return this._labelHalign},n.prototype.setCoordinateSpace=function(t){this._coordinateContainerId=t,this.setDirty()},n.prototype.getCoordinateSpace=function(){return this._coordinateContainerId},n.prototype.setData=function(t){this._data=t},n.prototype.getData=function(){return this._data},n.prototype.setDirty=function(){this.LayoutContext&&this.LayoutContext.getDirtyContext().set(this.getId(),!0)},n.prototype.copyFrom=function(t){t&&(this.setPoints(t.getPoints()),this.setLabelPosition(t.getLabelPosition()),this.setLabelRotationAngle(t.getLabelRotationAngle()),this.setLabelRotationPoint(t.getLabelRotationPoint()),this.setLabelValign(t.getLabelValign()),this.setLabelHalign(t.getLabelHalign()),this.setCoordinateSpace(t.getCoordinateSpace()))};
/**
   * @license
   * Copyright (c) 2008 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var i=function(){this.Init()};t.Obj.createSubclass(i,t.Obj,"DvtDiagramLayoutContextNode"),i.prototype.Init=function(){this._bReadOnly=!1,this._selected=!1,this._bDisclosed=!1,this.IsRendered=!0,this.ContentOffset=new t.DiagramPoint(0,0)},i.prototype.setId=function(t){this._id=t},i.prototype.getId=function(){return this._id},i.prototype.setBounds=function(t){this._bounds=t,this._origBounds=t},i.prototype.getBounds=function(){return!this._bounds&&this.Component&&this.Component.updateNodeDims(this),this._bounds},i.prototype.setContentBounds=function(t){this._contentBounds=t,this._origContentBounds=t},i.prototype.getContentBounds=function(){return!this._contentBounds&&this.Component&&this.Component.updateNodeDims(this),this._contentBounds},i.prototype.setPosition=function(t){this._position=t,this.UpdateParentNodes(),this.setDirty()},i.prototype.getPosition=function(){return this._position},i.prototype.getRelativePosition=function(e){var n=this.LayoutContext;if(n){for(var i=new t.DiagramPoint(0,0),o=this,a=!1;o;){var s=o.getContainerId();if(s){var r=n.getNodeById(s);r&&this.Component&&!r.IsRendered&&this.Component.renderNodeFromContext(r,!0)}if(i.x+=o.ContentOffset.x+o.getPosition().x,i.y+=o.ContentOffset.y+o.getPosition().y,t.BaseDiagram.compareValues(n.Context,s,e))a=!0,o=null;else if((o=n.getNodeById(s))&&o.isDisclosed()){var d=o.getContainerPadding();d&&(i.x+=d.left,i.y+=d.top)}else o=null}return a||(i=null),i}},i.prototype.setLabelPosition=function(t){this._labelPosition=t,this.setDirty()},i.prototype.getLabelPosition=function(){return this._labelPosition},i.prototype.setLabelBounds=function(t){this._labelBounds=t},i.prototype.getLabelBounds=function(){return!this._labelBounds&&this.Component&&this.Component.updateNodeDims(this),this._labelBounds},i.prototype.setLayoutAttributes=function(t){this._layoutAttrs=t},i.prototype.getLayoutAttributes=function(){return this._layoutAttrs},i.prototype.setReadOnly=function(t){this._bReadOnly=t},i.prototype.isReadOnly=function(){return this._bReadOnly},i.prototype.setContainerId=function(t){this._containerId=t},i.prototype.getContainerId=function(){return this._containerId},i.prototype.setSelected=function(t){this._selected=t},i.prototype.getSelected=function(){return this._selected},i.prototype.setLabelRotationAngle=function(t){this._labelRotAngle=t,this.setDirty()},i.prototype.getLabelRotationAngle=function(){return this._labelRotAngle},i.prototype.setLabelRotationPoint=function(t){this._labelRotPoint=t,this.setDirty()},i.prototype.getLabelRotationPoint=function(){return this._labelRotPoint},i.prototype.SetContainerPaddingObj=function(e){this.isDisclosed()&&(this._containerPadding=e,e&&(this._origBounds&&(this._origBounds=new t.DiagramRectangle(this._origBounds.x,this._origBounds.y,this._origBounds.w-(e.left+e.right),this._origBounds.h-(e.top+e.bottom))),this._origContentBounds&&(this._origContentBounds=new t.DiagramRectangle(this._origContentBounds.x,this._origContentBounds.y,this._origContentBounds.w-(e.left+e.right),this._origContentBounds.h-(e.top+e.bottom)))))},i.prototype.setContainerPadding=function(e,n,i,o){this.isDisclosed()&&(this._containerPadding={},"number"!=typeof e&&"string"!=typeof e&&(o=e.left,n=e.right,i=e.bottom,e=e.top),this._containerPadding.top=e,this._containerPadding.right=n,this._containerPadding.bottom=i,this._containerPadding.left=o,this._origBounds&&(this._bounds=new t.DiagramRectangle(this._origBounds.x,this._origBounds.y,this._origBounds.w+o+n,this._origBounds.h+e+i)),this._origContentBounds&&(this._contentBounds=new t.DiagramRectangle(this._origContentBounds.x,this._origContentBounds.y,this._origContentBounds.w+o+n,this._origContentBounds.h+e+i)),this.setDirty())},i.prototype.getContainerPadding=function(){return this._containerPadding},i.prototype.setDisclosed=function(t){this._bDisclosed=t},i.prototype.isDisclosed=function(){return this._bDisclosed},i.prototype.setChildNodes=function(t){this._childNodes=t},i.prototype.getChildNodes=function(){return this._childNodes},i.prototype.setParentNode=function(t){this._parentNode=t},i.prototype.getParentNode=function(){return this._parentNode},i.prototype.UpdateParentNodes=function(){var t=this.getParentNode();t&&t.IsRendered&&(t.Reset(),t.UpdateParentNodes())},i.prototype.Reset=function(){this.IsRendered=!1,this.setBounds(null),this.setContentBounds(null),this.setLabelBounds(null),this.setDirty()},i.prototype.setLabelValign=function(t){this._labelValign=t,this.setDirty()},i.prototype.setLabelHalign=function(t){this._labelHalign=t,this.setDirty()},i.prototype.getLabelValign=function(){return this._labelValign},i.prototype.getLabelHalign=function(){return this._labelHalign},i.prototype.setData=function(t){this._data=t},i.prototype.getData=function(){return this._data},i.prototype.setDirty=function(){this.LayoutContext&&this.LayoutContext.getDirtyContext().set(this.getId(),!0)},i.prototype.copyFrom=function(t){t&&(this.setPosition(t.getPosition()),this.setLabelPosition(t.getLabelPosition()),this.setLabelRotationAngle(t.getLabelRotationAngle()),this.setLabelRotationPoint(t.getLabelRotationPoint()),this.setLabelValign(t.getLabelValign()),this.setLabelHalign(t.getLabelHalign()),t.getContainerPadding()&&this.setContainerPadding(t.getContainerPadding()))};
/**
   * @license
   * Copyright (c) 2008 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var o=function(t,e){this.Init(t,e)};t.Obj.createSubclass(o,t.Obj,"DvtDiagramPoint"),o.prototype.Init=function(t,e){this.x=null===t||isNaN(t)?0:t,this.y=null===e||isNaN(e)?0:e};
/**
   * @license
   * Copyright (c) 2008 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var a=function(t,e,n,i){this.Init(t,e,n,i)};t.Obj.createSubclass(a,t.Obj,"DvtDiagramRectangle"),a.prototype.Init=function(t,e,n,i){this.x=null===t||isNaN(t)?0:t,this.y=null===e||isNaN(e)?0:e,this.w=null===n||isNaN(n)?0:n,this.h=null===i||isNaN(i)?0:i},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.DiagramPoint=o,t.DiagramRectangle=a,
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.BaseDiagram=function(t,e,n){this.Init(t,e,n)},t.Obj.createSubclass(t.BaseDiagram,t.PanZoomComponent,"dvt.BaseDiagram"),t.BaseDiagram.prototype.Init=function(e,n,i){t.BaseDiagram.superclass.Init.call(this,e,n,i),this.getCtx().getStage().getElem().setAttributeNS(null,"text-rendering","geometricPrecision"),this._linksPane=new t.Container(e),this._nodesPane=new t.Container(e),this._topPane=new t.Container(e),t.Agent.isTouchDevice()&&(this._touchEventPane=new t.Container(e),this._touchEventPane.setStyle({display:"none"})),this.InitializeZoomLimits()},t.BaseDiagram.prototype.InitComponentInternal=function(){var t=this.getPanZoomCanvas();t.setMinZoom(this.getMinZoom()),t.setMaxZoom(this.getMaxZoom()),t.setAnimationDuration(this.getAnimationDuration()),t.getContentPane().addChild(this._linksPane),t.getContentPane().addChild(this._nodesPane),t.getContentPane().addChild(this._topPane),this._touchEventPane&&t.getContentPane().addChild(this._touchEventPane)},t.BaseDiagram.prototype.getAnimationDuration=function(){return t.PanZoomCanvas.DEFAULT_ANIMATION_DURATION},t.BaseDiagram.prototype.setMaxZoom=function(t){this._maxZoom=t,this.getPanZoomCanvas()&&this.getPanZoomCanvas().setMaxZoom(t)},t.BaseDiagram.prototype.getMaxZoom=function(){return this._maxZoom},t.BaseDiagram.prototype.setMinZoom=function(t){this._minZoom=t,this.getPanZoomCanvas()&&this.getPanZoomCanvas().setMinZoom(t)},t.BaseDiagram.prototype.getMinZoom=function(){return this._minZoom},t.BaseDiagram.prototype.InitializeZoomLimits=function(){this.setMaxZoom(2),this.setMinZoom(0)},t.BaseDiagram.prototype.getNodeById=function(t){return null},t.BaseDiagram.prototype.getLinkById=function(t){return null},t.BaseDiagram.prototype.GetAllLinks=function(){return[]},t.BaseDiagram.prototype.GetAllNodes=function(){return[]},t.BaseDiagram.prototype.GetAllRoots=function(){return[]},t.BaseDiagram.prototype.RefreshEmptyText=function(e){if(e&&this.getEmptyText())this._emptyTextDisplay?(this._emptyTextDisplay.setX(this.Width/2),this._emptyTextDisplay.setY(this.Height/2),t.TextUtils.fitText(this._emptyTextDisplay,this.getWidth()-2*t.TextUtils.EMPTY_TEXT_BUFFER,1/0,this)):this._emptyTextDisplay=this.CreateEmptyText(this.getEmptyText());else if(this._emptyTextDisplay){var n=this._emptyTextDisplay.getParent();n&&n.removeChild(this._emptyTextDisplay),this._emptyTextDisplay=null}},t.BaseDiagram.prototype.CreateEmptyText=function(e){var n=this.getOptions();return t.TextUtils.renderEmptyText(this,e,new t.Rectangle(0,0,this.getWidth(),this.getHeight()),this.getEventManager(),n._statusMessageStyle)},t.BaseDiagram.prototype.setEmptyText=function(t){this._emptyText=t},t.BaseDiagram.prototype.getEmptyText=function(){return this._emptyText},t.BaseDiagram.prototype.SetPanningEnabled=function(t){this._panningEnabled=t},t.BaseDiagram.prototype.IsPanningEnabled=function(){return this._panningEnabled},t.BaseDiagram.prototype.setPanDirection=function(t){this._panDirection=t,this.getPanZoomCanvas()&&this.getPanZoomCanvas().setPanDirection(t)},t.BaseDiagram.prototype.getPanDirection=function(){return this._panDirection},t.BaseDiagram.prototype.SetZoomingEnabled=function(t){this._zoomingEnabled=t},t.BaseDiagram.prototype.IsZoomingEnabled=function(){return this._zoomingEnabled},t.BaseDiagram.prototype.getSelectionHandler=function(){return this._selectionHandler},t.BaseDiagram.prototype.setSelectionMode=function(e){this._selectionHandler="single"==e?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_SINGLE):"multiple"==e?new t.SelectionHandler(this.getCtx(),t.SelectionHandler.TYPE_MULTIPLE):null,this.getEventManager().setSelectionHandler(this._selectionHandler)},t.BaseDiagram.prototype.getSelectionMode=function(){return this._selectionHandler?this._selectionHandler.getType():null},t.BaseDiagram.prototype.isSelectionSupported=function(){return!!this._selectionHandler},t.BaseDiagram.prototype.getNodesPane=function(){return this._nodesPane},t.BaseDiagram.prototype.setNodesPane=function(t){this._nodesPane=t},t.BaseDiagram.prototype.getLinksPane=function(){return this._linksPane},t.BaseDiagram.prototype.setLinksPane=function(t){this._linksPane=t},t.BaseDiagram.prototype.getTopPane=function(){return this._topPane},t.BaseDiagram.prototype.setTopPane=function(t){this._topPane=t},t.BaseDiagram.prototype.getTouchEventPane=function(){return this._touchEventPane||null},t.BaseDiagram.prototype.getBottomPane=function(){this._bottomPane||(this._bottomPane=new t.Container(this.getCtx()),this.getPanZoomCanvas().getContentPane().addChildAt(this._bottomPane,0));return this._bottomPane},t.BaseDiagram.prototype.CreateEmptyLayoutContext=function(){var n=new e(this.getCtx());return n.setLocaleR2L(t.Agent.isRightToLeft(this.getCtx())),n.setComponentSize(new t.DiagramRectangle(0,0,this.getWidth(),this.getHeight())),n},t.BaseDiagram.prototype.CreateLayoutContextNode=function(e,n,o,a){var s=new i;s.setId(e.getId?e.getId():e.getData().getId()),s.setBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(e.getLayoutBounds())),s.setContentBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(e.getContentBounds()));var r=e.getLayoutAttributes?e.getLayoutAttributes(n):e.getData()._itemData;return s.setLayoutAttributes(r),s.setData(r),s.setLabelBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(e.getLabelBounds())),s.setLabelPosition(t.DiagramLayoutUtils.convertPointToDiagramPoint(e.getLabelPosition())),s.setSelected(1==e.isSelected()),e.isDisclosed()&&(s.setDisclosed(!0),s.SetContainerPaddingObj(t.BaseDiagram.getLayoutContainerPadding(e.getContainerPadding()))),s.setContainerId(e.getGroupId()),s.Component=this,s.IsRendered=!o,s.LayoutContext=a,s},t.BaseDiagram.prototype.CreateLayoutContextLink=function(e,i,o,a,s){var r,d=new n;return d.setId(e.getId?e.getId():e.getData().getId()),d.setStartId(i||e.getData().getStartId()),d.setEndId(o||e.getData().getEndId()),e.isPromoted()?(r=e.getData()._links,this.isDataProviderMode()&&(r=r.map((function(t){return t._itemData})))):r=e.getData()._itemData,d.setLayoutAttributes(r),d.setData(r),d.setLabelBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(e.getLabelBounds())),d.setLabelPosition(t.DiagramLayoutUtils.convertPointToDiagramPoint(e.getLabelPosition())),d.setStartConnectorOffset(e.getStartConnectorOffset()),d.setEndConnectorOffset(e.getEndConnectorOffset()),d.setLinkWidth(e.getLinkWidth()),d.setSelected(1==e.isSelected()),d.setPromoted(1==e.isPromoted()),d.LayoutContext=s,d},t.BaseDiagram.prototype.ApplyLayoutContext=function(e,n){var i=e.getContainerPadding();if(i){var o=e.getContainerId();if(o){var a=this.getNodeById(o);a&&a.setContainerPadding(t.BaseDiagram.getContainerPadding(i))}}for(var s=Number.MAX_VALUE,r=Number.MAX_VALUE,d=0;d<e.getNodeCount();d++){(v=(C=e.getNodeByIndex(d)).getPosition())&&(s=Math.min(s,v.x),r=Math.min(r,v.y));var l=C.getLabelBounds(),h=C.getLabelPosition();l&&h&&(s=Math.min(s,h.x+l.x),r=Math.min(r,h.y+l.y))}for(var g=0;g<e.getLinkCount();g++){if(k=(b=e.getLinkByIndex(g)).getPoints())for(var u=t.DiagramLinkUtils.GetControlPoints(k),c=0;c<u.length;c++){var p=u[c];s=Math.min(s,p.x),r=Math.min(r,p.y)}l=b.getLabelBounds(),h=b.getLabelPosition();l&&h&&(s=Math.min(s,h.x+l.x),r=Math.min(r,h.y+l.y))}var m=new t.Point(-s,-r),_=m.x,f=m.y,y=e.getDirtyContext();for(d=0;d<e.getNodeCount();d++){var C;if((C=e.getNodeByIndex(d)).getContainerId()&&(C.ContentOffset=new t.DiagramPoint(m.x,m.y)),y.has(C.getId())){var v,D=this.getNodeById(C.getId());if((v=C.getPosition())&&D.SetPosition(v.x+_,v.y+f),this.ApplyLabelPosition(C,D,t.DiagramLayoutUtils.convertDiagramPointToPoint(v)),D.isDisclosed()){var S=C.getContainerPadding();S&&D.setContainerPadding(t.BaseDiagram.getContainerPadding(S))}}}for(g=0;g<e.getLinkCount();g++){var b=e.getLinkByIndex(g);if(y.has(b.getId())){var k,L=this.getLinkById(b.getId()),N=this.GetLinkTranslationOffset(L,b,m),E=N.x,P=N.y;(k=b.getPoints())&&L.setPoints(k),L.setTranslate(E,P),this.ApplyLabelPosition(b,L,new t.Point(0,0))}}var O=e.getViewport();O&&(this._layoutViewport=new t.Rectangle(O.x+_,O.y+f,O.w,O.h)),n&&(this._layoutOffset=new t.Point(_,f))},t.BaseDiagram.prototype.GetLinkTranslationOffset=function(e,n,i){var o=new t.Point(0,0),a=this.getCtx();if(e.getGroupId()){if(!t.BaseDiagram.compareValues(a,e.getGroupId(),n.getCoordinateSpace())){for(var s=n.getCoordinateSpace(),r=this.getNodeById(e.getGroupId());r;){var d=r.getContainerPadding();o.x-=d.left-r.GetPosition().x,o.y-=d.top-r.GetPosition().y;var l=r.getGroupId();r=t.BaseDiagram.compareValues(a,l,s)?null:this.getNodeById(l)}s||(o.x+=i.x,o.y+=i.y)}}else o=i;return o},t.BaseDiagram.prototype.GetLayoutViewport=function(){return this._layoutViewport},t.BaseDiagram.prototype.IsLayoutViewport=function(){return!!this._layoutViewport},t.BaseDiagram.prototype.ClearLayoutViewport=function(){this._layoutViewport=null},t.BaseDiagram.prototype.AdjustMinZoom=function(){if(0==this.getMinZoom()){var t=this.getPanZoomCanvas(),e=this.GetViewBounds(),n=this.CalculateMinimumScale(e);return t.setMinZoom(this.GetMinZoomFactor()*Math.min(n,t.getMaxZoom())),e}return null},t.BaseDiagram.prototype.GetMinZoomFactor=function(){return 1},t.BaseDiagram.prototype.CalculateMinimumScale=function(t){if(!t)return 0;var e=this.getPanZoomCanvas(),n=(this.Width-2*e.getZoomToFitPadding())/t.w,i=(this.Height-2*e.getZoomToFitPadding())/t.h;return Math.min(n,i)},t.BaseDiagram.prototype.GetViewBounds=function(){if(this._cachedViewBounds)return this._cachedViewBounds;for(var t,e,n,i,o,a,s,r,d,l=null,h=this.GetAllRoots(),g=0;g<h.length;g++)o=h[g],(i=this.getNodeById(o))&&i.getVisible()&&(t=i.GetNodeBounds(),e=i.getTranslateX(),n=i.getTranslateY(),t.x+=e,t.y+=n,l?(r=l.x,d=l.y,l.x=Math.min(l.x,t.x),l.y=Math.min(l.y,t.y),l.w=Math.max(r+l.w,t.x+t.w)-l.x,l.h=Math.max(d+l.h,t.y+t.h)-l.y):l=t);var u=this.GetAllLinks();for(g=0;g<u.length;g++)if(s=u[g],(a=this.getLinkById(s))&&a.getVisible()){if(a.getGroupId())continue;t=a.GetLinkBounds(),e=a.getTranslateX(),n=a.getTranslateY(),t.x+=e,t.y+=n,l?(r=l.x,d=l.y,l.x=Math.min(l.x,t.x),l.y=Math.min(l.y,t.y),l.w=Math.max(r+l.w,t.x+t.w)-l.x,l.h=Math.max(d+l.h,t.y+t.h)-l.y):l=t}return l},t.BaseDiagram.RotateBounds=function(e,n,i){if(null==n&&!i)return e;var o=new t.Point(e.x,e.y),a=new t.Point(e.x+e.w,e.y),s=new t.Point(e.x,e.y+e.h),r=new t.Point(e.x+e.w,e.y+e.h),d=new t.Matrix;null!=n&&(i&&(d=d.translate(-i.x,-i.y)),d=d.rotate(n),i&&(d=d.translate(i.x,i.y)));var l=d.transformPoint(o),h=d.transformPoint(a),g=d.transformPoint(s),u=d.transformPoint(r),c=Math.min(Math.min(l.x,h.x),Math.min(g.x,u.x)),p=Math.max(Math.max(l.x,h.x),Math.max(g.x,u.x)),m=Math.min(Math.min(l.y,h.y),Math.min(g.y,u.y)),_=Math.max(Math.max(l.y,h.y),Math.max(g.y,u.y));return new t.Rectangle(c,m,p-c,_-m)},t.BaseDiagram.prototype.ConstrainPanning=function(t,e,n,i,o){var a,s,r,d,l=this.getPanZoomCanvas();if("fixed"===this.Options.panning){var h=l.getMinZoom(),g=(l.getSize().w-n*h)/2-t*h,u=(l.getSize().h-i*h)/2-e*h,c=o/h;a=l.getSize().w-l.getSize().w*c+g*c,r=l.getSize().h-l.getSize().h*c+u*c,s=g*c,d=u*c}else{var p=l.getSize().w/2,m=l.getSize().h/2;a=p-(n+t)*o,r=m-(i+e)*o,s=p-t*o,d=m-e*o}if(this.IsLayoutViewport()){var _,f,y=this.GetLayoutViewport();-y.x*o<a?(a-=_=a+y.x*o,s+=_):-y.x*o>s&&(a-=_=-y.x*o-s,s+=_),-y.y*o<r?(r-=f=r+y.y*o,d+=f):-y.y*o>d&&(r-=f=-y.y*o-d,d+=f)}l.setMinPanX(a),l.setMinPanY(r),l.setMaxPanX(s),l.setMaxPanY(d),this.Overview&&this.Overview.updateConstraints(a,r,s,d)},t.BaseDiagram.getContainerPadding=function(t){var e=new Object;return e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e},t.BaseDiagram.getLayoutContainerPadding=function(t){var e=new Object;return e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e},t.BaseDiagram.prototype.ApplyLabelPosition=function(e,n,i){var o=e.getLabelBounds();o=t.DiagramLayoutUtils.convertDiagramRectToRect(o);var a=e.getLabelPosition();if(o&&a){var s=new t.Point(a.x-i.x,a.y-i.y),r=e.getLabelRotationAngle(),d=t.DiagramLayoutUtils.convertDiagramPointToPoint(e.getLabelRotationPoint());n.setLabelBounds(o),n.setLabelPosition(s),n.setLabelAlignments(e.getLabelHalign(),e.getLabelValign()),null!=r&&n.setLabelRotationAngle(r),d&&n.setLabelRotationPoint(d)}},t.BaseDiagram.prototype.getLayoutOffset=function(){return this._layoutOffset?this._layoutOffset:new t.Point(0,0)},t.BaseDiagram.prototype.getCustomObjKeyboardBoundingBox=function(e){var n=e.getElem().getBoundingClientRect(),i=this.getPanZoomCanvas().getContentPane().getElem().getBoundingClientRect(),o=this.getPanZoomCanvas().getContentPane().getMatrix();return new t.Rectangle(n.left-i.left+o.getTx(),n.top-i.top+o.getTy(),n.width,n.height)},t.BaseDiagram.compareValues=function(e,n,i){return!n&&!i||t.Obj.compareValues(e,n,i)},
/**
   * @license
   * Copyright (c) 2011 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.BaseDiagramKeyboardHandler=function(t,e){this.Init(t,e)},t.Obj.createSubclass(t.BaseDiagramKeyboardHandler,t.PanZoomCanvasKeyboardHandler,"dvt.BaseDiagramKeyboardHandler"),t.BaseDiagramKeyboardHandler._OUTGOING=0,t.BaseDiagramKeyboardHandler._INGOING=1,t.BaseDiagramKeyboardHandler.prototype.Init=function(e,n){t.BaseDiagramKeyboardHandler.superclass.Init.call(this,e,n),this._diagram=e},t.BaseDiagramKeyboardHandler.prototype.GetDiagram=function(){return this._diagram},t.BaseDiagramKeyboardHandler.prototype.isSelectionEvent=function(e){return e.keyCode!=t.KeyboardEvent.TAB&&(this.isNavigationEvent(e)&&!e.ctrlKey)},t.BaseDiagramKeyboardHandler.prototype.isMultiSelectEvent=function(e){return e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey},t.BaseDiagramKeyboardHandler.prototype.getFirstNavigableLink=function(e,n,i){var o=n.keyCode;if(!i||i.length<1||!e)return null;for(var a=i[0],s=e.getKeyboardBoundingBox(),r=s.x+s.w/2,d=0;d<i.length;d++){var l=i[d],h=l.getKeyboardBoundingBox(),g=h.x+h.w/2;if(o==t.KeyboardEvent.OPEN_ANGLED_BRACKET&&g<=r||o==t.KeyboardEvent.CLOSE_ANGLED_BRACKET&&g>=r){a=l;break}}return a},t.BaseDiagramKeyboardHandler.prototype.getNextNavigableLink=function(e,n,i,o){if(!o)return null;if(!n)return o[0];if(!e)return n;this._addSortingAttributes(e,o),o.sort(this._getLinkComparator()),this._removeSortingAttributes(o);for(var a=i.keyCode==t.KeyboardEvent.DOWN_ARROW,s=0,r=0;r<o.length;r++){if(o[r]===n){s=a?r==o.length-1?0:r+1:0==r?o.length-1:r-1;break}}return o[s]},t.BaseDiagramKeyboardHandler.prototype.GetVisibleNode=function(t){return null},t.BaseDiagramKeyboardHandler.prototype._getClockwiseAngle=function(t,e){var n=this.GetVisibleNode(e.getStartId?e.getStartId():e.getData().getStartId()),i=this.GetVisibleNode(e.getEndId?e.getEndId():e.getData().getEndId()),o=t==n?i:n,a=this._getNodeCenter(t),s=this._getNodeCenter(o),r=Math.atan2(s.y-a.y,s.x-a.x);return r=r<0?r+2*Math.PI:r},t.BaseDiagramKeyboardHandler.prototype._getNodeCenter=function(e){var n=e.getKeyboardBoundingBox();return new t.Point(n.x+n.w/2,n.y+n.h/2)},t.BaseDiagramKeyboardHandler.prototype._getNodesDistance=function(t){var e=this.GetVisibleNode(t.getStartId?t.getStartId():t.getData().getStartId()),n=this.GetVisibleNode(t.getEndId?t.getEndId():t.getData().getEndId()),i=this._getNodeCenter(e),o=this._getNodeCenter(n);return Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2))},t.BaseDiagramKeyboardHandler.prototype._getLinkDirection=function(e,n){return e==this.GetVisibleNode(n.getEndId?n.getEndId():n.getData().getEndId())?t.BaseDiagramKeyboardHandler._INGOING:t.BaseDiagramKeyboardHandler._OUTGOING},t.BaseDiagramKeyboardHandler.prototype._getLinkComparator=function(){return function(e,n){var i=e.__angle,o=n.__angle,a=-1;return!t.BaseDiagramKeyboardHandler._anglesAreEqualWithinTolerance(i,o)&&i>o?a=1:t.BaseDiagramKeyboardHandler._anglesAreEqualWithinTolerance(i,o)&&(e.__distance>n.__distance||n.__distance==e.__distance&&e.__direction>n.__direction?a=1:n.__distance==e.__distance&&e.__direction==n.__direction&&(a=0)),a}},t.BaseDiagramKeyboardHandler.prototype._removeSortingAttributes=function(t){for(var e=0;e<t.length;e++){var n=t[e];n.__angle=void 0,n.__distance=void 0,n.__direction=void 0}},t.BaseDiagramKeyboardHandler.prototype._addSortingAttributes=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.__angle=this._getClockwiseAngle(t,i),i.__distance=this._getNodesDistance(i),i.__direction=this._getLinkDirection(t,i)}},t.BaseDiagramKeyboardHandler._anglesAreEqualWithinTolerance=function(t,e){var n=Math.abs(t-e)<=1e-7;return n||(n=Math.abs(2*Math.PI+Math.min(t,e)-Math.max(t,e))<=1e-7),n},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.BaseDiagramNode=function(t,e,n){this.Init(t,e,n)},t.Obj.createSubclass(t.BaseDiagramNode,t.Container,"dvt.BaseDiagramNode"),t.BaseDiagramNode.prototype.Init=function(e,n,i){t.BaseDiagramNode.superclass.Init.call(this,e,null,n),this._diagram=i,this._bDisclosed=!1,this._selected=!1,this._selectable=!0},t.BaseDiagramNode.prototype.GetDiagram=function(){return this._diagram},t.BaseDiagramNode.prototype.getData=function(){return null},t.BaseDiagramNode.prototype.getLayoutBounds=function(t){return this.getContentBounds(t)},t.BaseDiagramNode.prototype.getContentBounds=function(t){return null},t.BaseDiagramNode.prototype.setLabelPosition=function(e){e&&(this._labelPos=e,t.BaseDiagramNode.PositionLabel(this._labelObj,e,this.getLabelBounds(!0),this.getLabelRotationAngle(),this.getLabelRotationPoint()))},t.BaseDiagramNode.prototype.getLabelPosition=function(){return this._labelPos},t.BaseDiagramNode.prototype.getLabelBounds=function(t){return null},t.BaseDiagramNode.prototype.setLabelBounds=function(t){},t.BaseDiagramNode.prototype.getContainerPadding=function(){return null},t.BaseDiagramNode.prototype.setContainerPadding=function(t,e,n,i){},t.BaseDiagramNode.prototype.isDisclosed=function(){return this._bDisclosed},t.BaseDiagramNode.prototype.setDisclosed=function(t){this._bDisclosed=t},t.BaseDiagramNode.prototype.isSelected=function(){return this._selected},t.BaseDiagramNode.prototype.setSelected=function(t){this._selected=t},t.BaseDiagramNode.prototype.setSelectable=function(t){this._selectable=t},t.BaseDiagramNode.prototype.isSelectable=function(){return this.GetDiagram().isSelectionSupported()&&this._selectable},t.BaseDiagramNode.prototype.setLabelRotationAngle=function(e){this._labelRotAngle=e,t.BaseDiagramNode.PositionLabel(this._labelObj,this.getLabelPosition(),this.getLabelBounds(!0),e,this.getLabelRotationPoint())},t.BaseDiagramNode.prototype.getLabelRotationAngle=function(){return this._labelRotAngle},t.BaseDiagramNode.prototype.setLabelRotationPoint=function(e){this._labelRotPoint=e,t.BaseDiagramNode.PositionLabel(this._labelObj,this.getLabelPosition(),this.getLabelBounds(!0),this.getLabelRotationAngle(),e)},t.BaseDiagramNode.prototype.getLabelRotationPoint=function(){return this._labelRotPoint},t.BaseDiagramNode.prototype.GetNodeBounds=function(){var e=this.getLayoutBounds(!0),n=new t.Rectangle(e.x,e.y,e.w,e.h),i=i=this.getLabelPosition(),o=this.getLabelRotationAngle(),a=this.getLabelRotationPoint(),s=this.getLabelBounds(!0);return i&&s&&(null!=o&&(s=t.BaseDiagram.RotateBounds(s,o,a)),n.x=Math.min(e.x,s.x+i.x),n.y=Math.min(e.y,s.y+i.y),n.w=Math.max(e.x+e.w,s.x+i.x+s.w)-n.x,n.h=Math.max(e.y+e.h,s.y+i.y+s.h)-n.y),n},t.BaseDiagramNode.CalcLabelMatrix=function(e,n,i,o){var a=new t.Matrix;return null!=i&&(o&&(a=a.translate(-o.x,-o.y)),a=a.rotate(i),o&&(a=a.translate(o.x,o.y))),e&&(a=a.translate(e.x,e.y)),a},t.BaseDiagramNode.PositionLabel=function(e,n,i,o,a){if(e){var s=t.BaseDiagramNode.CalcLabelMatrix(n,i,o,a);e.setMatrix(s)}},t.BaseDiagramNode.prototype.SetPosition=function(t,e){this.setTranslate(t,e)},t.BaseDiagramNode.prototype.GetPosition=function(){return new t.Point(this.getTranslateX(),this.getTranslateY())},t.BaseDiagramNode.prototype.getNextNavigable=function(t){return null},t.BaseDiagramNode.prototype.getKeyboardBoundingBox=function(e){if(this._customNodeContent)return this._diagram.getCustomObjKeyboardBoundingBox(this);var n=this.getContentBounds(e),i=this.localToStage(new t.Point(n.x,n.y)),o=this.localToStage(new t.Point(n.x+n.w,n.y+n.h));return new t.Rectangle(i.x,i.y,o.x-i.x,o.y-i.y)},t.BaseDiagramNode.prototype.getTargetElem=function(){return this.getElem()},t.BaseDiagramNode.prototype.showKeyboardFocusEffect=function(){},t.BaseDiagramNode.prototype.hideKeyboardFocusEffect=function(){},t.BaseDiagramNode.prototype.isShowingKeyboardFocusEffect=function(){},t.BaseDiagramNode.prototype.getCategories=function(){return null},t.BaseDiagramNode.prototype.addOutLinkId=function(t){this._outLinkIds||(this._outLinkIds=[]),this._outLinkIds.push(t)},t.BaseDiagramNode.prototype.removeOutLinkId=function(t){if(this._outLinkIds){var e=this._outLinkIds.indexOf(t);-1!=e&&this._outLinkIds.splice(e,1)}},t.BaseDiagramNode.prototype.getOutLinkIds=function(){return this._outLinkIds},t.BaseDiagramNode.prototype.addInLinkId=function(t){this._inLinkIds||(this._inLinkIds=[]),this._inLinkIds.push(t)},t.BaseDiagramNode.prototype.removeInLinkId=function(t){if(this._inLinkIds){var e=this._inLinkIds.indexOf(t);-1!=e&&this._inLinkIds.splice(e,1)}},t.BaseDiagramNode.prototype.getInLinkIds=function(){return this._inLinkIds},t.BaseDiagramNode.prototype.setLabelAlignments=function(t,e){},t.BaseDiagramNode.prototype.getGroupId=function(){return null},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.BaseDiagramLink=function(t,e,n){this.Init(t,e,n)},t.Obj.createSubclass(t.BaseDiagramLink,t.Container,"dvt.BaseDiagramLink"),t.BaseDiagramLink.prototype.Init=function(e,n,i){t.BaseDiagramLink.superclass.Init.call(this,e,null,n),this._diagram=i,this._selected=!1,this._selectable=!0},t.BaseDiagramLink.prototype.GetDiagram=function(){return this._diagram},t.BaseDiagramLink.prototype.setEndConnectorType=function(t){},t.BaseDiagramLink.prototype.getEndConnectorType=function(){return null},t.BaseDiagramLink.prototype.setStartConnectorType=function(t){},t.BaseDiagramLink.prototype.setStartConnector=function(t){this._startConnector=t},t.BaseDiagramLink.prototype.getStartConnector=function(){return this._startConnector},t.BaseDiagramLink.prototype.setEndConnector=function(t){this._endConnector=t},t.BaseDiagramLink.prototype.getEndConnector=function(){return this._endConnector},t.BaseDiagramLink.prototype.setShape=function(t){this._shape=t},t.BaseDiagramLink.prototype.getShape=function(){return this._shape},t.BaseDiagramLink.prototype.setLabelRotationAngle=function(e){this._labelRotAngle=e,t.BaseDiagramLink.PositionLabel(this._labelObj,this.getLabelPosition(),this.getLabelBounds(),e,this.getLabelRotationPoint())},t.BaseDiagramLink.prototype.getLabelRotationAngle=function(){return this._labelRotAngle},t.BaseDiagramLink.prototype.setLabelRotationPoint=function(e){this._labelRotPoint=e,t.BaseDiagramLink.PositionLabel(this._labelObj,this.getLabelPosition(),this.getLabelBounds(),this.getLabelRotationAngle(),e)},t.BaseDiagramLink.prototype.getLabelRotationPoint=function(){return this._labelRotPoint},t.BaseDiagramLink.prototype.getLabelPosition=function(){return this._labelPos},t.BaseDiagramLink.prototype.setLabelPosition=function(e){e&&(this._labelPos=e,t.BaseDiagramLink.PositionLabel(this._labelObj,e,this.getLabelBounds(),this.getLabelRotationAngle(),this.getLabelRotationPoint()))},t.BaseDiagramLink.prototype.getLabelBounds=function(){return null},t.BaseDiagramLink.prototype.setLabelBounds=function(t){},t.BaseDiagramLink.prototype.getStartConnectorOffset=function(){return 0},t.BaseDiagramLink.prototype.getEndConnectorOffset=function(){return 0},t.BaseDiagramLink.prototype.setSelectable=function(t){this._selectable=t},t.BaseDiagramLink.prototype.isSelectable=function(){return this.GetDiagram().isSelectionSupported()&&this._selectable},t.BaseDiagramLink.prototype.isSelected=function(){return this._selected},t.BaseDiagramLink.prototype.setSelected=function(t){this._selected=t},t.BaseDiagramLink.prototype.setPromoted=function(t){this._bPromoted=t},t.BaseDiagramLink.prototype.isPromoted=function(){return this._bPromoted},t.BaseDiagramLink.prototype.setLinkWidth=function(t){},t.BaseDiagramLink.prototype.getLinkWidth=function(){return 1},t.BaseDiagramLink.prototype.setLinkStyle=function(t){},t.BaseDiagramLink.prototype.getLinkStyle=function(){return"solid"},t.BaseDiagramLink.prototype.setLinkColor=function(t){},t.BaseDiagramLink.prototype.getLinkColor=function(){return null},t.BaseDiagramLink.prototype.getConnectorTemplate=function(t){return null},t.BaseDiagramLink.prototype.GetAppliedLinkStyle=function(){return this.getLinkStyle()},t.BaseDiagramLink.prototype.GetAppliedLinkWidth=function(){return this.getLinkWidth()},t.BaseDiagramLink.prototype.GetAppliedLinkColor=function(){return this.getLinkColor()},t.BaseDiagramLink.prototype.CreateConnector=function(e,n,i,o){if(n||o){var a;if(!o){var s=this._shape.getStroke();a=new t.Stroke(s.getColor(),s.getAlpha(),s.getWidth())}var r=t.DiagramLinkConnectorUtils.CreateConnectorShape(this.getCtx(),n,o,a,this);return r&&(this._shape.addChild(r),t.DiagramLinkConnectorUtils.TransformConnector(r,n,o,e,i)),r}},t.BaseDiagramLink.prototype.GetLinkBounds=function(){var e=new t.Rectangle(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),n=this.getPoints();if(n)for(var i,o,a,s,r,d=t.DiagramLinkUtils.GetControlPoints(n),l=0;l<d.length;l++)i=d[l],o=Math.max(e.x+e.w,i.x),a=Math.max(e.y+e.h,i.y),s=Math.min(e.x,i.x),r=Math.min(e.y,i.y),e.x=s,e.y=r,e.w=o-s,e.h=a-r;var h=new t.Rectangle(e.x,e.y,e.w,e.h),g=this.getLabelPosition(),u=this.getLabelRotationAngle(),c=this.getLabelRotationPoint(),p=this.getLabelBounds();return g&&p&&(null!=u&&(p=t.BaseDiagram.RotateBounds(p,u,c)),h.x=Math.min(e.x,p.x+g.x),h.y=Math.min(e.y,p.y+g.y),h.w=Math.max(e.x+e.w,p.x+g.x+p.w)-h.x,h.h=Math.max(e.y+e.h,p.y+g.y+p.h)-h.y),h},t.BaseDiagramLink.prototype.setPoints=function(e){this._arPoints=e,t.DiagramLinkUtils.IsPath(e)?(this._pathCmds=e,this._points=t.DiagramLinkUtils.ConvertToPoints(e)):(this._points=e,this._pathCmds=t.DiagramLinkUtils.ConvertToPath(e)),this._shape&&this._shape instanceof t.Path&&(this._shape.setCommandsArray(this._pathCmds),this._endConnector?t.DiagramLinkConnectorUtils.TransformConnector(this._endConnector,this.getEndConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.END_CONNECTOR),this._points,1):this._endConnector=this.CreateConnector(this._points,this.getEndConnectorType(),1,this.getConnectorTemplate(t.DiagramLinkConnectorUtils.END_CONNECTOR)),this._startConnector?t.DiagramLinkConnectorUtils.TransformConnector(this._startConnector,this.getStartConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.START_CONNECTOR),this._points,0):this._startConnector=this.CreateConnector(this._points,this.getStartConnectorType(),0,this.getConnectorTemplate(t.DiagramLinkConnectorUtils.START_CONNECTOR)));var n=null,i=null;this._linkUnderlay&&this._linkUnderlay.getUnderlay()instanceof t.Path&&this._linkUnderlay.getUnderlay().setCommandsArray(this._pathCmds),this._linkUnderlay&&(n=this._linkUnderlay.getUnderlayStart())&&t.DiagramLinkConnectorUtils.TransformConnector(n,this.getStartConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.START_CONNECTOR),this._points,0),this._linkUnderlay&&(i=this._linkUnderlay.getUnderlayEnd())&&t.DiagramLinkConnectorUtils.TransformConnector(i,this.getEndConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.END_CONNECTOR),this._points,1),this._hitDetectionUnderlay&&this._hitDetectionUnderlay.getUnderlay()instanceof t.Path&&this._hitDetectionUnderlay.getUnderlay().setCommandsArray(this._pathCmds),this._startHandle&&this._startHandle.setPosition(this.getLinkStart()),this._endHandle&&this._endHandle.setPosition(this.getLinkEnd())},t.BaseDiagramLink.prototype.getPoints=function(){return this._arPoints},t.BaseDiagramLink.prototype.getLinkStart=function(){if(!this._points)return null;var e=this._points[0],n=this._points[1];return new t.Point(e,n)},t.BaseDiagramLink.prototype.getLinkEnd=function(){if(!this._points)return null;var e=this._points.length,n=this._points[e-2],i=this._points[e-1];return new t.Point(n,i)},t.BaseDiagramLink.CalcLabelMatrix=function(e,n,i,o){var a=new t.Matrix;return null!=i&&(o&&(a=a.translate(-o.x,-o.y)),a=a.rotate(i),o&&(a=a.translate(o.x,o.y))),e&&(a=a.translate(e.x,e.y)),a},t.BaseDiagramLink.PositionLabel=function(e,n,i,o,a){if(e){var s=t.BaseDiagramLink.CalcLabelMatrix(n,i,o,a);e.setMatrix(s)}},t.BaseDiagramLink.prototype.CreateUnderlay=function(e,n,i,o,a){n||0==n||(n=1),i||0==i||(i=0);var r=this.GetAppliedLinkWidth()+i,d=new t.Stroke(e,n,r,!0);return new s(this.getCtx(),this._pathCmds,d,o,a)},t.BaseDiagramLink.prototype.CreateFeedbackUnderlay=function(e,n,i,o,a){var s=this.CreateUnderlay(e,n,i,o,a);return this._startConnector&&this.getStartConnectorType()&&s.addUnderlayStart(this._points,this.getStartConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.START_CONNECTOR),this),this._endConnector&&this.getEndConnectorType()&&s.addUnderlayEnd(this._points,this.getEndConnectorType(),this.getConnectorTemplate(t.DiagramLinkConnectorUtils.END_CONNECTOR),this),s},t.BaseDiagramLink.prototype.GetStyledLinkStroke=function(e,n,i){var o,a=this.GetAppliedLinkStyle();return"solid"!==strokeType&&(o={dashArray:t.DiagramLinkUtils.GetStrokeDash(a,!0),dashOffset:t.DiagramLinkUtils.GetStrokeDashOffset(a,!0)}),new t.Stroke(n,e.getAlpha(),i,!0,o)},t.BaseDiagramLink.prototype.ReplaceConnectorColor=function(e,n){if(e){var i=null;if(n.getColor&&(i=n.getColor()),i){var o=e.getStroke(),a=e.getFill();o&&e.setStroke(new t.Stroke(i,o.getAlpha(),o.getWidth(),o.isFixedWidth(),o.getDashProps())),a&&e.setSolidFill(i)}}},t.BaseDiagramLink.prototype.getNextNavigable=function(t){return null},t.BaseDiagramLink.prototype.getKeyboardBoundingBox=function(t){return this.getGroupId()&&this._diagram.getOptions().renderer?this._diagram.getCustomObjKeyboardBoundingBox(this):this.getDimensions(t)},t.BaseDiagramLink.prototype.getTargetElem=function(){return this.getElem()},t.BaseDiagramLink.prototype.showKeyboardFocusEffect=function(){},t.BaseDiagramLink.prototype.hideKeyboardFocusEffect=function(){},t.BaseDiagramLink.prototype.isShowingKeyboardFocusEffect=function(){},t.BaseDiagramLink.prototype.setKeyboardFocusNode=function(t){this._keyboardNavNode=t},t.BaseDiagramLink.prototype.getKeyboardFocusNode=function(){return this._keyboardNavNode},t.BaseDiagramLink.prototype.getCategories=function(){return null},t.BaseDiagramLink.prototype.setLabelAlignments=function(t,e){},t.BaseDiagramLink.prototype.getGroupId=function(){return null},
/**
   * @license
   * Copyright (c) 2011 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.DiagramLayoutUtils={},t.Obj.createSubclass(t.DiagramLayoutUtils,t.Obj,"dvt.DiagramLayoutUtils"),t.DiagramLayoutUtils.convertRectToDiagramRect=function(e){return void 0===e||null==e?null:new t.DiagramRectangle(e.x,e.y,e.w,e.h)},t.DiagramLayoutUtils.convertPointToDiagramPoint=function(e){return void 0===e||null==e?null:new t.DiagramPoint(e.x,e.y)},t.DiagramLayoutUtils.convertDiagramRectToRect=function(e){return e?new t.Rectangle(e.x,e.y,e.w,e.h):null},t.DiagramLayoutUtils.convertDiagramPointToPoint=function(e){return e?new t.Point(e.x,e.y):null};
/**
   * @license
   * Copyright (c) 2011 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var s=function t(e,n,i,o,a){t.superclass.Init.call(this,e),this.Init(e,n,i,o,a)};t.Obj.createSubclass(s,t.Container,"DvtDiagramLinkUnderlay"),s.prototype.Init=function(e,n,i,o,a){n||(n=["M",0,0,"L",1,0]),this._stroke=i,this._stroke||(this._stroke=new t.Stroke("#ffffff",1,1,!0)),this._underlay=new t.Path(e,n),this._underlay.setStroke(this._stroke),this._underlay.setFill(null),this._underlay.setStyle(o).setClassName(a),this.addChild(this._underlay),this._underlayStart=null,this._underlayStartType=null,this._underlayEnd=null,this._underlayEndType=null},s.prototype.addUnderlayStart=function(t,e,n,i){var o=this.CreateConnectorUnderlay(t,e,n,i,0);this._underlayStart&&this.removeChild(this._underlayStart),this._underlayStart=o,this._underlayStartType=e,this.addChild(this._underlayStart)},s.prototype.addUnderlayEnd=function(t,e,n,i){var o=this.CreateConnectorUnderlay(t,e,n,i,1);this._underlayEnd&&this.removeChild(this._underlayEnd),this._underlayEnd=o,this._underlayEndType=e,this.addChild(this._underlayEnd)},s.prototype.CreateConnectorUnderlay=function(e,n,i,o,a){var s=new t.Stroke(this._stroke.getColor(),this._stroke.getAlpha(),this._stroke.getWidth(),!1,this._stroke.getDashProps()),r=t.DiagramLinkConnectorUtils.CreateConnectorShape(this.getCtx(),n,i,s,o);return t.DiagramLinkConnectorUtils.TransformConnector(r,n,i,e,a),r},s.prototype.getUnderlay=function(){return this._underlay},s.prototype.getUnderlayStart=function(){return this._underlayStart},s.prototype.getUnderlayEnd=function(){return this._underlayEnd},s.prototype.setStroke=function(e,n){var i,o;(this._stroke=e,this._underlay.setStroke(e),this._underlayStart)&&(this._underlayStartType==t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW||this._underlayStartType==t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_CONCAVE?(i=new t.Stroke(e.getColor(),e.getAlpha(),n),this._underlayStart.setSolidFill(e.getColor())):i=new t.Stroke(e.getColor(),e.getAlpha(),e.getWidth()),this._underlayStart.setStroke(i));this._underlayEnd&&(this._underlayEndType==t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW||this._underlayEndType==t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_CONCAVE?(o=new t.Stroke(e.getColor(),e.getAlpha(),n),this._underlayEnd.setSolidFill(e.getColor())):o=new t.Stroke(e.getColor(),e.getAlpha(),e.getWidth()),this._underlayEnd.setStroke(o))},s.prototype.getStroke=function(){return this._stroke},s.prototype.hideUnderlayStart=function(){this._underlayStart&&this.removeChild(this._underlayStart)},s.prototype.hideUnderlayEnd=function(){this._underlayEnd&&this.removeChild(this._underlayEnd)},s.prototype.showUnderlayStart=function(){this._underlayStart&&this.addChild(this._underlayStart)},s.prototype.showUnderlayEnd=function(){this._underlayEnd&&this.addChild(this._underlayEnd)},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.DiagramLinkUtils={},t.Obj.createSubclass(t.DiagramLinkUtils,t.Obj,"dvt.DiagramLinkUtils"),t.DiagramLinkUtils.GetStrokeDash=function(t,e){return"solid"==t?null:"dash"===t?e?"8,2":"6,4":"dot"===t?e?"4,1":"2,3":"dashDot"===t?e?"10,1,4,1":"8,3,2,3":void 0},t.DiagramLinkUtils.GetStrokeDashOffset=function(t,e){return e&&"solid"!=t?1:null},t.DiagramLinkUtils.getStrokeObject=function(e,n){return{_type:e,strokeDasharray:t.DiagramLinkUtils.GetStrokeDash(e,n),strokeDashoffset:t.DiagramLinkUtils.GetStrokeDashOffset(e,n)}},t.DiagramLinkUtils.processStrokeDashArray=function(t){if(t){var e=t.split(/[\s,]+/);return e.length%2>0&&(e=e.concat(e)),e.toString()}return t},t.DiagramLinkUtils.getCustomUnderlay=function(e){if(e){for(var n=e.split(/[\s,]+/),i="",o=0;o<n.length;o++){var a=t.CSSStyle.toNumber(n[o].trim());i+=o%2==0?a+2:a>=2?a-2:0,o<n.length-1&&(i+=", ")}return i}return null},t.DiagramLinkUtils.ConvertToPath=function(t){var e=[];if(t)for(var n=0;n<t.length;n+=2)0==n?e.push("M"):e.push("L"),e.push(t[n]),e.push(t[n+1]);return e},t.DiagramLinkUtils.ConvertToPoints=function(t){var e=[];if(t)for(var n=0;n<t.length;n++)isNaN(t[n])||e.push(t[n]);return e},t.DiagramLinkUtils.IsPath=function(t){return!!(t&&t.length>0)&&isNaN(t[0])},t.DiagramLinkUtils.GetControlPoints=function(e){var n,i=[];n=t.DiagramLinkUtils.IsPath(e)?t.DiagramLinkUtils.ConvertToPoints(e):e;for(var o=0;o<n.length;o+=2)i.push(new t.Point(n[o],n[o+1]));return i},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.DiagramLinkConnectorUtils={},t.Obj.createSubclass(t.DiagramLinkConnectorUtils,t.Obj,"dvt.DiagramLinkConnectorUtils"),t.DiagramLinkConnectorUtils.END_CONNECTOR="endConnector",t.DiagramLinkConnectorUtils.START_CONNECTOR="startConnector",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_OPEN="arrowOpen",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW="arrow",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_CONCAVE="arrowConcave",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE="rectangle",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE_ROUNDED="rectangleRounded",t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_CIRCLE="circle",t.DiagramLinkConnectorUtils.CreateConnectorShape=function(e,n,i,o,a){if(i)return t.DiagramLinkConnectorUtils.CreateCustomConnector(e,i,a);var s=a.GetAppliedLinkWidth();switch(n){case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW:return t.DiagramLinkConnectorUtils.CreateFilledArrowConnector(e,s,a.getLinkColor());case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_CONCAVE:return t.DiagramLinkConnectorUtils.CreateFilledConcaveArrowConnector(e,s,a.getLinkColor());case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_OPEN:return t.DiagramLinkConnectorUtils.CreateOpenArrowConnector(e,s,o);case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_CIRCLE:return t.DiagramLinkConnectorUtils.CreateCircleConnector(e,s,o);case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE:return t.DiagramLinkConnectorUtils.CreateRectangleConnector(e,s,o);case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE_ROUNDED:return t.DiagramLinkConnectorUtils.CreateRoundedRectangleConnector(e,s,o)}return null},t.DiagramLinkConnectorUtils.TransformConnector=function(e,n,i,o,a){var s=t.DiagramLinkConnectorUtils.CalcConnectorTransform(e,n,i,o,a);e.setMatrix(s)},t.DiagramLinkConnectorUtils.CalcConnectorTransform=function(e,n,i,o,a){var s=-1,r=0,d=0,l=0;if(o){var h=o.length;1===a?(h>=2&&(d=o[h-2],l=o[h-1]),h>=4?(s=o[h-4],r=o[h-3]):(s=d-1e-4,r=l)):(h>=2&&(d=o[0],l=o[1]),h>=4?(s=o[2],r=o[3]):(s=d+1e-4,r=l))}else;var g=d,u=l,c=t.DiagramLinkConnectorUtils.CalcConnectorRotation(s,r,d,l),p=e._connectorOrigMat;p||(p=e.getMatrix(),e._connectorOrigMat=p);var m=new t.Matrix;if(i){var _=t.DiagramLinkConnectorUtils._getCachedDims(e),f=e.getScaleX(),y=e.getScaleY(),C=_.w*f*-.5,v=_.h*y*-.5;m=m.translate(C,v)}return(m=(m=m.rotate(c)).translate(g,u)).concat(p)},t.DiagramLinkConnectorUtils._getCachedDims=function(t){var e=t._cachedDims;return e||(e=t.getDimensions(),t._cachedDims=e),e},t.DiagramLinkConnectorUtils.CalcConnectorRotation=function(t,e,n,i){var o=i-e,a=n-t;return Math.atan2(o,a)},t.DiagramLinkConnectorUtils.CreateFilledConcaveArrowConnector=function(e,n,i){var o=6*t.DiagramLinkConnectorUtils._getReduce(n,.5),a=.8*o,s=[-.22*o,-.5*a,.78*o,0,-.22*o,.5*a,0,0],r=new t.Polygon(e,s);return r.setSolidFill(i),r},t.DiagramLinkConnectorUtils.CreateFilledArrowConnector=function(e,n,i){var o=5*t.DiagramLinkConnectorUtils._getReduce(n,.5),a=.8*o,s=[0,-.5*a,o,0,0,.5*a],r=new t.Polygon(e,s);return r.setSolidFill(i),r},t.DiagramLinkConnectorUtils._getReduce=function(t,e){if(t<=1)return t;var n=t-1;return 1+(n*=e)},t.DiagramLinkConnectorUtils.CreateOpenArrowConnector=function(e,n,i){var o=3*n,a=i.getWidth(),s=[-o+a*Math.sqrt(2)/2,-o,a*Math.sqrt(2)/2,0,-o+a*Math.sqrt(2)/2,o],r=new t.Polyline(e,s);return r.setStroke(i),r.setFill(null),r},t.DiagramLinkConnectorUtils.getCircleRadius=function(t){return 2*t},t.DiagramLinkConnectorUtils.getRectangleLength=function(t){return 3*t},t.DiagramLinkConnectorUtils.CreateCircleConnector=function(e,n,i){var o=t.DiagramLinkConnectorUtils.getCircleRadius(n),a=new t.Circle(e,o,0,o);return a.setStroke(i),a.setFill(null),a},t.DiagramLinkConnectorUtils.CreateRectangleConnector=function(e,n,i){var o=t.DiagramLinkConnectorUtils.getRectangleLength(n),a=new t.Rect(e,0,-o/2,o,o);return a.setStroke(i),a.setFill(null),a},t.DiagramLinkConnectorUtils.CreateRoundedRectangleConnector=function(e,n,i){var o=t.DiagramLinkConnectorUtils.CreateRectangleConnector(e,n,i);return o.setCornerRadius(n),o},t.DiagramLinkConnectorUtils.CreateCustomConnector=function(e,n,i){var o=i.GetDiagram().createAfContext();return o.setELContext(i.getData().getElAttributes()),o.setContextCallback(i,i.eventContextCallback),o.setTabStopsArray(i.getTabStopsArray()),t.AfComponentFactory.parseAndLayout(o,n,i)},t.DiagramLinkConnectorUtils.GetConnectorOffset=function(e,n,i,o,a){if(i){var s=t.DiagramLinkConnectorUtils._getCachedDims(e),r=e.getScaleX();return s.w*r*.5}return t.DiagramLinkConnectorUtils.getStandardConnectorOffset(n,a.GetAppliedLinkWidth(),o.getWidth())},t.DiagramLinkConnectorUtils.getStandardConnectorOffset=function(e,n,i){switch(e){case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_OPEN:return i*Math.sqrt(2);case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW:return 5*t.DiagramLinkConnectorUtils._getReduce(n,.5);case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_ARROW_CONCAVE:return.78*(6*t.DiagramLinkConnectorUtils._getReduce(n,.5));case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_CIRCLE:return 2*t.DiagramLinkConnectorUtils.getCircleRadius(i)+i/2;case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE:case t.DiagramLinkConnectorUtils.CONNECTOR_TYPE_RECTANGLE_ROUNDED:return t.DiagramLinkConnectorUtils.getRectangleLength(i)+i/2;default:return 0}}}(e),
/**
 * @license
 * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
function(t){
/**
   * @license
   * Copyright (c) 2017 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var e=new Object;t.Obj.createSubclass(e,t.Obj),e.prepareNodeStyle=function(e,n){!e||null==e[n]||e[n]instanceof Object||(e[n]=t.CSSStyle.cssStringToObject(e[n]))},e.prepareLinkStyle=function(e,n){e&&null!=e[n]&&(e[n]instanceof Object?null==e[n]._type&&(e[n]._type=g.CUSTOM_STYLE):e[n]=t.DiagramLinkUtils.getStrokeObject(e[n]))},e.getNodeDefaultStyles=function(t){var n=t.getOptions().styleDefaults.nodeDefaults;return e.prepareNodeStyle(n,"backgroundStyle"),e.prepareNodeStyle(n,"containerStyle"),n},e.getNodeStyles=function(n,i,o){if(n.isDataProviderMode())return t.JsonUtils.merge(i,o,{_itemData:!0,id:!0,nodes:!0});var a=u.ConvertNodeData(i);if(n.getOptions().nodeProperties){var s=t.JsonUtils.clone(n.getOptions().nodeProperties(i));e.prepareNodeStyle(s,"backgroundStyle"),e.prepareNodeStyle(s,"containerStyle"),a=t.JsonUtils.merge(a,s,{_itemData:!0})}return t.JsonUtils.merge(a,o,{_itemData:!0})},e.getLinkDefaultStyles=function(n,i){var o=n.getOptions().styleDefaults[i];e.prepareLinkStyle(o,"style");var a=n.getCtx().isCustomElement()?"svgStyle":"style";return o[a]=t.JsonUtils.merge(o[a],o._style),n.getCtx().isCustomElement()&&["_type"].forEach((function(t){delete o[a][t]})),o},e.getLinkStyles=function(n,i,o){if(n.isDataProviderMode())return t.JsonUtils.merge(i,o,{_itemData:!0,id:!0});var a=g.ConvertLinkData(i);if(n.getOptions().linkProperties){var s=t.JsonUtils.clone(n.getOptions().linkProperties(i));e.prepareLinkStyle(s,"style"),a=t.JsonUtils.merge(a,s,{_itemData:!0})}return t.JsonUtils.merge(a,o,{_itemData:!0})},e.getAnimationDuration=function(e){return t.CSSStyle.getTimeMilliseconds(e.getOptions().styleDefaults.animationDuration)/1e3},e.getAnimationOnDisplay=function(t){return t.getOptions().animationOnDisplay},e.getAnimationOnDataChange=function(t){return t.getOptions().animationOnDataChange};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var n=new Object;t.Obj.createSubclass(n,t.Obj),n.GetCollapsedContainers=function(t,e){for(var n=[];e.length>0;){var i=e.shift();if(i.nodes)i.nodes.forEach((function(t){e.push(t)}));else{var o=t.getChildDataProvider(i.id);!o||"yes"===o.isEmpty()||"disjoint"===i.descendantsConnectivity||n.push(i)}}return n},n.GetNodeOption=function(e,n){for(var i=[n.getId()];n&&n.getGroupId();){var o=n.getGroupId();i.push(o),n=e.getNodeById(o)}for(var a=i.pop(),s=[e.getOptions()],r=e.getCtx();a&&s[0].nodes;)s=s[0].nodes.filter((function(e){return t.BaseDiagram.compareValues(r,e.id,a)})),a=i.pop();return s[0]};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var i={};t.Obj.createSubclass(i,t.Obj,"DvtDiagramOverviewUtils"),i.CalcViewportFromMatrix=function(e){var n=e.getPanZoomCanvas().getContentPaneMatrix(),i=new t.Rectangle(0,0,e.getWidth(),e.getHeight()),o=n.getTx(),a=n.getTy(),s=n.getA(),r=i.x-o/s,d=i.y-a/s,l=i.w/s,h=i.h/s;return new t.Rectangle(r,d,l,h)},i.CreateOverviewWindow=function(e){var n=new t.Container(e.getCtx()),a=new o(e);n.addChild(a),e.addChild(n),a.render(),i._positionOverviewWindow(e,a);var s=a.getOverviewWidth(),r=a.getOverviewHeight(),d=new t.ClipPath(e.getId()+"dgr_ovClip");d.addRect(a.getTranslateX()-1,a.getTranslateY()-1,s+2,r+2),a.setClipPath(d),a.UpdateViewport();var l=e.Options.styleDefaults._overviewStyles,h=new t.Rect(e.getCtx(),0,0,s,r);return h.setInvisibleFill(),h.setStroke(new t.Stroke(l.overview.backgroundColor,1,1)),h.setMouseEnabled(!1),n.addChild(h),a},i.CreateOverviewContent=function(e,n,o,a){var s=new t.Container(e.getCtx());s.setMouseEnabled(!1),n.Nodes=new(e.getCtx().ojMap);var r=e.GetViewBounds();n.ContentBounds=r?r.clone():null,n.StretchFactor={h:1,v:1};var d=e.GetRootNodeObjects();return d.length>0&&(d.forEach((function(t){i.CreateOverviewNode(e,n,t,s)})),i._adjustNodePositionsForAspectRatio(e,n,o,a),i.ZoomToFitOverviewContent(e,n,s,o,a)),s},i.CreateOverviewNode=function(e,n,o,a){if(o){var s=i._createOverviewNodeShape(e,o);if(i._positionOverviewNode(o,s),n.Nodes.set(o.getId(),s),a.addChild(s),o.isDisclosed()){s._ovChildNodePane=new t.Container(e.getCtx()),s.addChild(s._ovChildNodePane);var r=o.getContainerPadding();s._ovChildNodePane.setTranslate(r.left,r.top),o.getChildNodeIds().forEach((function(t){var o=e.getNodeById(t);i.CreateOverviewNode(e,n,o,s._ovChildNodePane)}))}}},i.RemoveOverviewWindow=function(t,e){if(e){e.setClipPath(null);var n=e.getParent();t.removeChild(n)}},i.UpdateOverviewWindow=function(e,n){i._positionOverviewWindow(e,n),i._updateOverviewNodes(e,n),n.Nodes.size>0&&i.ZoomToFitOverviewContent(e,n,n.Content,n.Width,n.Height),n.UpdateViewport();var o=n.getOverviewWidth(),a=n.getOverviewHeight();n.setClipPath(null);var s=new t.ClipPath(e.getId()+"dgr_ovClip");s.addRect(n.getTranslateX()-1,n.getTranslateY()-1,o+2,a+2),n.setClipPath(s);var r=n.getParent().getChildIndex(1);r instanceof t.Rect&&(r.setWidth(o),r.setHeight(a))},i.UpdateOverviewContent=function(t,e,n,o){var a=o.data.nodes;if(a&&0!==a.length){var s=o.parentId,r=s?t.getNodeById(s):null,d=[];if("add"==n)if(r){var l=i._findRootNode(t,r);i._removeNode(t,e,l.getId()),d.push(l)}else a.forEach((function(e){d.push(t.getNodeById(e.id))}));else if("change"==n){var h=new(t.getCtx().ojMap);a.forEach((function(e){var n=i._findRootNode(t,t.getNodeById(e.id));n&&h.set(n.getId(),n)})),h.forEach((function(n,o,a){i._removeNode(t,e,o),d.push(n)}))}else if("remove"==n)if(r){l=i._findRootNode(t,r);i._removeNode(t,e,l.getId()),d.push(l)}else a.forEach((function(n){i._removeNode(t,e,n.id)}));d.forEach((function(n){i.CreateOverviewNode(t,e,n,e.Content)}))}},i.TransformFromContentToViewportCoords=function(e,n,i){var o=i.Content,a=o.getTranslateX(),s=o.getTranslateY(),r=o.getScaleX(),d=o.getScaleY(),l=e*r*i.StretchFactor.h+a,h=n*d*i.StretchFactor.v+s;return new t.Point(l,h)},i.TransformFromViewportToContentCoords=function(e,n,i){var o=i.Content,a=o.getTranslateX(),s=o.getTranslateY(),r=o.getScaleX(),d=o.getScaleY(),l=(e-a)/r/i.StretchFactor.h,h=(n-s)/d/i.StretchFactor.v;return new t.Point(l,h)},i.ZoomToFitOverviewContent=function(t,e,n,o,a){var s=e.ContentBounds,r=i._calcOverviewScale(t,s,o,a,e);n.setScale(r,r);var d=(o-s.w*r)/2-s.x*r,l=(a-s.h*r)/2-s.y*r;n.setTranslate(d,l)},i._adjustNodePositionsForAspectRatio=function(e,n,o,a){if("meet"!==e.Options.overview.preserveAspectRatio){var s=e.GetViewBounds(),r=2*t.CSSStyle.toNumber(e.Options.styleDefaults._overviewStyles.overviewContent.padding);if("canvas"===e.Options.overview.fitArea)var d=i._getCanvasDimensions(e),l=d.w/d.h;else l=s.w/s.h;var h=(o-r)/(a-r);if(h==l)return;var g=h>l?h/l:1,u=h<l?l/h:1;n.ContentBounds=s.clone(),n.ContentBounds.w=n.ContentBounds.w*g,n.ContentBounds.h=n.ContentBounds.h*u,n.StretchFactor={h:g,v:u};var c=e.GetRootNodeObjects();if(c.length>0){var p=i._getNodesStretchFactor(n,c,n.StretchFactor);if(1===p.h&&1===p.v)return n.ContentBounds=s.clone(),void(n.StretchFactor={h:1,v:1});c.forEach((function(t){i._adjustNodePosition(n.Nodes.get(t.getId()),p)}))}}},i._getCanvasDimensions=function(e){var n;if("fixed"===e.Options.panning||"none"===e.Options.panning)n=new t.Dimension(e.Width,e.Height);else{var i=e.GetViewBounds(),o=e.getPanZoomCanvas().getMinZoom();n=new t.Dimension(2*i.w*o,2*i.h*o)}return n},i._adjustNodePosition=function(t,e){var n=t.getCenterDimensions(),i=t.getTranslateX(),o=t.getTranslateY();if(e.h>1){var a=(i+n.x-e.tx)*e.h+e.tx;t.setTranslateX(a-.5*n.w)}else if(e.v>1){var s=(o+n.y-e.ty)*e.v+e.ty;t.setTranslateY(s-.5*n.h)}},i._getNodesStretchFactor=function(t,e,n){var i={h:1,v:1};if(n.h>1){var o=Number.MAX_VALUE,a=-Number.MAX_VALUE;e.forEach((function(t){var e=t.getContentBounds(),n=t.getTranslateX()+e.x+.5*e.w;d=n<o?e:d,l=n>a?e:l,o=Math.min(n,o),a=Math.max(n,a)}));var s=.5*d.w,r=.5*l.w;i={h:a===o?1:(t.ContentBounds.w-s-r)/(a-o),v:1,tx:s}}if(n.v>1){var d,l,h=Number.MAX_VALUE,g=-Number.MAX_VALUE;e.forEach((function(t){var e=t.getContentBounds(),n=t.getTranslateY()+e.y+.5*e.h;d=n<h?e:d,l=n>g?e:l,h=Math.min(n,h),g=Math.max(n,g)}));s=.5*d.h,r=.5*l.h;i={h:1,v:g===h?1:(t.ContentBounds.h-s-r)/(g-h),ty:s}}return i},i._calcOverviewScale=function(e,n,o,a,s){var r=2*t.CSSStyle.toNumber(e.Options.styleDefaults._overviewStyles.overviewContent.padding),d=o-r,l=a-r;if("canvas"===e.Options.overview.fitArea){var h=e.GetViewBounds(),g=e.getPanZoomCanvas().getMinZoom(),u=i._getCanvasDimensions(e),c=Math.min((u.h-h.h*g)/2,(u.w-h.w*g)/2),p=s.StretchFactor.h,m=s.StretchFactor.v,_=d/u.w*p,f=l/u.h*m,y=Math.min(_,f);d-=2*c*p*y,l-=2*c*m*y}var C=d/n.w,v=l/n.h;return Math.min(C,v)},i._createOverviewNodeShape=function(e,n){var i=e.Options.styleDefaults._overviewStyles.node;n.getData().overview&&(i=t.JsonUtils.merge(n.getData().overview.icon,i));var o=i.shape;n.isDisclosed()||e.Options.renderer&&"inherit"==o?o="rectangle":"inherit"==o&&(o=n.getData().icon.shape);var a=n.getLayoutBounds(),s=a.w,r=a.h,d=new t.SimpleMarker(e.getCtx(),o,s/2,r/2,s,r,0),l=n.isDisclosed()?"oj-diagram-overview-container-node":"oj-diagram-overview-node";return i.svgClassName&&(l+=" "+i.svgClassName),d.setStyle(i.svgStyle).setClassName(l),d},i._findRootNode=function(t,e){for(var n=e,i=e?e.getGroupId():null;i;)i=(n=t.getNodeById(i)?t.getNodeById(i):n).getGroupId();return n},i._positionOverviewNode=function(t,e){var n=t.getTranslateX(),i=t.getTranslateY();e.setTranslate(n,i)},i._positionOverviewWindow=function(e,n){var i=e.Options.overview.halign,o=e.Options.overview.valign,a=t.CSSStyle.toNumber(e.Options.styleDefaults._overviewStyles.overview.padding),s=n.getOverviewWidth(),r=n.getOverviewHeight(),d=e.Width,l=e.Height;switch(i){case"start":i=t.Agent.isRightToLeft(e.getCtx())?"right":"left";break;case"end":i=t.Agent.isRightToLeft(e.getCtx())?"left":"right"}var h="center"==i?(d-s)/2:"right"==i?d-s-a:a,g="middle"==o?(l-r)/2:"bottom"==o?l-r-a:a;n.getParent().setTranslate(h,g)},i._removeNode=function(t,e,n){var i=e.Nodes.get(n);i&&i.getParent().removeChild(i)},i._updateOverviewNodes=function(t,e){e.Nodes.forEach((function(n,o,a){var s=t.getNodeById(o);s&&n?i._positionOverviewNode(s,n):n&&!s&&e.Nodes.delete(o)})),i._adjustNodePositionsForAspectRatio(t,e,e.Width,e.Height)};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var o=function(t){this.Init(t.getCtx(),t.processEvent,t),this.Diagram=t,this._id=t.getId()+"_overview"};t.Obj.createSubclass(o,t.Overview),o.prototype.renderData=function(t,e){this.Content=i.CreateOverviewContent(this.Diagram,this,t,e),this.addChild(this.Content),this.Content.setMouseEnabled(!1)},o.prototype.render=function(){var t=Math.min(this.Diagram.Width,this.Diagram.Options.overview.width),e=Math.min(this.Diagram.Height,this.Diagram.Options.overview.height),n=this.Diagram.Options.styleDefaults._overviewStyles,i={xMin:0,xMax:t,yMin:0,yMax:e,x1:0,x2:t,y1:0,y2:e,style:{overviewBackgroundColor:n.overview.backgroundColor,windowBackgroundColor:n.viewport.backgroundColor,windowBorderTopColor:n.viewport.borderColor,windowBorderRightColor:n.viewport.borderColor,windowBorderBottomColor:n.viewport.borderColor,windowBorderLeftColor:n.viewport.borderColor,timeAxisBarColor:"#00000000"},animationOnClick:"off",featuresOff:"zoom"},a=0===this.Diagram.GetAllRoots().length;this._viewportConstraints={xMin:a?0:-Number.MAX_VALUE,yMin:a?0:-Number.MAX_VALUE,xMax:a?t:Number.MAX_VALUE,yMax:a?e:Number.MAX_VALUE},this.Diagram.IsPanningEnabled()||this.setMouseEnabled(!1),o.superclass.render.call(this,i,t,e)},o.prototype.animateUpdate=function(e,n){this.Content.setAlpha(0),e.add(new t.AnimFadeIn(this.getCtx(),this.Content,e.getAnimationDuration()),d.UPDATE);var i=this.getChildIndex(this.Content);this.addChildAt(n.Content,i+1);var o=new t.AnimFadeOut(this.getCtx(),n.Content,e.getAnimationDuration());t.Playable.appendOnEnd(o,(function(){n.Content.getParent().removeChild(n.Content)})),e.add(o,d.UPDATE);var a=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration()),s=n.GetAnimationParams(),r=this.GetAnimationParams();this.SetAnimationParams(s),a.getAnimator().addProp(t.Animator.TYPE_NUMBER_ARRAY,this,this.GetAnimationParams,this.SetAnimationParams,r),e.add(a,d.UPDATE)},o.prototype.updateConstraints=function(t,e,n,o){var a=this.Diagram.getPanZoomCanvas().getZoom(),s=i.TransformFromContentToViewportCoords(-n/a,-o/a,this),r=i.TransformFromContentToViewportCoords(-t/a,-e/a,this),d=this._viewportPosition.x2-this._viewportPosition.x1,l=this._viewportPosition.y2-this._viewportPosition.y1,h=this.Diagram.getPanDirection();this._viewportConstraints={xMin:"y"===h?this._viewportPosition.x1:s.x,xMax:"y"===h?this._viewportPosition.x2:r.x+d,yMin:"x"===h?this._viewportPosition.y1:s.y,yMax:"x"===h?this._viewportPosition.y2:r.y+l}},o.prototype.getMinimumPositionX=function(){return this._viewportConstraints.xMin},o.prototype.getMinimumPositionY=function(){return this._viewportConstraints.yMin},o.prototype.getMaximumPositionX=function(){return this._viewportConstraints.xMax},o.prototype.getMaximumPositionY=function(){return this._viewportConstraints.yMax},o.prototype.getMinimumWindowWidth=function(){return 0},o.prototype.getMaximumWindowWidth=function(){return Number.MAX_VALUE},o.prototype.getMinimumWindowHeight=function(){return 0},o.prototype.getMaximumWindowHeight=function(){return Number.MAX_VALUE},o.prototype.UpdateViewport=function(){if(!this._bCancelUpdateViewport){var t=i.CalcViewportFromMatrix(this.Diagram),e=i.TransformFromContentToViewportCoords(t.x,t.y,this),n=i.TransformFromContentToViewportCoords(t.x+t.w,t.y+t.h,this);this._viewportPosition={x1:e.x,x2:n.x,y1:e.y,y2:n.y},this.setViewportRange(e.x,n.x,e.y,n.y)}},o.prototype.HandleViewportChange=function(t){var e=void 0!==t.newX1?t.newX1:this._viewportPosition.x1,n=void 0!==t.newY1?t.newY1:this._viewportPosition.y1,o=i.TransformFromViewportToContentCoords(this._viewportPosition.x1,this._viewportPosition.y1,this),a=i.TransformFromViewportToContentCoords(e,n,this);this._viewportPosition.x1=e,this._viewportPosition.y1=n;var s=this.Diagram.getPanZoomCanvas().getZoom(),r=(a.x-o.x)*s,d=(a.y-o.y)*s;0===r&&0===d||(this._bCancelUpdateViewport=!0,this.Diagram.getPanZoomCanvas().panBy(-r,-d),this._bCancelUpdateViewport=!1)},o.prototype.GetAnimationParams=function(){var t=[],e=this.getSlidingWindow(),n=this.getLeftHandle(),i=this.getRightHandle(),o=this.getBottomBar(),a=this.getTopBar();return t.push(e.getTranslateX()),t.push(e.getTranslateY()),t.push(e.getWidth()),t.push(e.getHeight()),t.push(n.getX1()),t.push(n.getY1()),t.push(n.getX2()),t.push(n.getY2()),t.push(i.getX1()),t.push(i.getY1()),t.push(i.getX2()),t.push(i.getY2()),t.push(o.getX1()),t.push(o.getY1()),t.push(o.getX2()),t.push(o.getY2()),t.push(a.getX1()),t.push(a.getY1()),t.push(a.getX2()),t.push(a.getY2()),t},o.prototype.SetAnimationParams=function(t){var e=this.getSlidingWindow(),n=this.getLeftHandle(),i=this.getRightHandle(),o=this.getBottomBar(),a=this.getTopBar(),s=0;e.setTranslateX(t[s++]),e.setTranslateY(t[s++]),e.setWidth(t[s++]),e.setHeight(t[s++]),n.setX1(t[s++]),n.setY1(t[s++]),n.setX2(t[s++]),n.setY2(t[s++]),i.setX1(t[s++]),i.setY1(t[s++]),i.setX2(t[s++]),i.setY2(t[s++]),o.setX1(t[s++]),o.setY1(t[s++]),o.setX2(t[s++]),o.setY2(t[s++]),a.setX1(t[s++]),a.setY1(t[s++]),a.setX2(t[s++]),a.setY2(t[s++])},o.prototype.CreateAnimationClone=function(){var e=this.getCtx(),n=new t.Container(e,this.getId());n.setMouseEnabled(!1);var o=new t.Container(e,"ovContentClone");n.addChild(o),n.Content=o,n.Nodes=new e.ojMap,n.Diagram=this.Diagram;var a=this.Diagram.GetRootNodeObjects();a.length>0&&(a.forEach((function(t){i.CreateOverviewNode(n.Diagram,n,t,o)})),i.ZoomToFitOverviewContent(n.Diagram,n,o,this.Width,this.Height));var s=this.GetAnimationParams();return n.GetAnimationParams=function(){return s},n},
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
t.Diagram=function(t,e,n){this.Init(t,e,n)},t.Obj.createSubclass(t.Diagram,t.BaseDiagram),t.Diagram.prototype.Init=function(e,n,i){t.Diagram.superclass.Init.call(this,e,n,i),this.Defaults=new s(e),this.EventManager=new l(e,this.processEvent,this),this.EventManager.addListeners(this),t.Agent.isTouchDevice()||this.EventManager.setKeyboardHandler(new h(this,this.EventManager)),this._nodes=new e.ojMap,this._arNodeIds=[],this._arRootIds=[],this._links=new e.ojMap,this._arLinkIds=[],this._renderCount=0,this._deferredObjCount=0,this._allNodeIdsMap=new e.ojMap,this._unresolvedNodeIds=[],this._nodesToResolve=[],this._touchEventContentDiagramObjRef=null,this.setId("diagram")},t.Diagram.newInstance=function(e,n,i){return new t.Diagram(e,n,i)},t.Diagram.prototype.PreRender=function(){!this.IsResize()&&this._bRendered&&("none"!=e.getAnimationOnDataChange(this)&&(this._oldDataAnimState=new r(this)),this._currentViewport=this.getPanZoomCanvas().getViewport(),this._bRendered=!1,this._oldPanZoomCanvas=this.getPanZoomCanvas(),this._setDataSourceListeners(this.getOptions().data,!1)),this.IsResize()?this._layoutContext&&(this._layoutContext.setEventData(null),this._layoutContext.setComponentSize(new t.DiagramRectangle(0,0,this.getWidth(),this.getHeight())),this._layoutContext.setCurrentViewport(null)):(this.ResetNodesAndLinks(),this._oldLayoutContext=this._layoutContext,this._layoutContext=null)},t.Diagram.prototype.ResetNodesAndLinks=function(){var e=this.getCtx();this.setLinksPane(new t.Container(e)),this.setNodesPane(new t.Container(e)),this.setTopPane(new t.Container(e)),this._nodes=new e.ojMap,this._arNodeIds=[],this._arRootIds=[],this._links=new e.ojMap,this._arLinkIds=[],this._highlightedObjects=null,this._promotedLinksMap=null,this._linkToPromotedMap=null,this._collapsedNodes=null,this.isDataProviderMode()||(this.getOptions().nodes=[],this.getOptions().links=[]),this._allNodeIdsMap=new e.ojMap,this._unresolvedNodeIds=[],i.RemoveOverviewWindow(this,this.Overview),this.Overview=null},t.Diagram.prototype._onAnimationEnd=function(){this._deleteContainer&&(this.removeChild(this._deleteContainer),this._deleteContainer.destroy()),this._deleteContainer=null,this.Animation&&this.getEventManager().addListeners(this),this.AnimationStopped||this.RenderComplete(),this.Animation=null,this.AnimationStopped=!1,this._bRendered&&(this._oldDataAnimState=null)},t.Diagram.prototype.animateUpdate=function(e,n){var i=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration()),o=n.PanZoomMatrix,a=this.getPanZoomCanvas().getContentPane().getMatrix();o.equals(a)||(this.getPanZoomCanvas().getContentPane().setMatrix(o),i.getAnimator().addProp(t.Animator.TYPE_MATRIX,this.getPanZoomCanvas().getContentPane(),this.getPanZoomCanvas().getContentPane().getMatrix,this.getPanZoomCanvas().getContentPane().setMatrix,a));var s=n.IsPartialUpdate?n.getNewNodes():this.GetRootNodeObjects(),r=n.IsPartialUpdate?n.getNewLinks():this.GetAllLinkObjects();e.constructAnimation(n.getNodes(),s),e.constructAnimation(n.getLinks(),r),e.constructAnimation([n.Overview],[this.Overview]),e.add(i,d.UPDATE)},t.Diagram.prototype._resolveDeferredData=function(t,e){if(null==e||this._isNodeDisclosed(e.id)||this._discoverLinks(t,e)){var n=t.getData(e);this._deferredObjCount++;var i=this,o=this._renderCount;n.then((function(n){i._renderDeferredData(o,t,e||i.getOptions(),n)}),(function(n){i._renderDeferredData(o,t,e||i.getOptions(),null)}))}},t.Diagram.prototype._renderDeferredData=function(t,e,n,i){if(t===this._renderCount&&this.getCtx().isReadyToRender()){if(null!=i){if(n.nodes=i.nodes,Array.isArray(i.links)&&(this.getOptions().links=this.getOptions().links.concat(i.links)),this._findUnresolvedLinks(i),Array.isArray(n.nodes))for(this._nodesToResolve=this._nodesToResolve.concat(n.nodes);this._nodesToResolve.length>0;)this._resolveDeferredData(e,this._nodesToResolve.shift())}else n.nodes=null;this._deferredObjCount--,0===this._deferredObjCount&&this.RenderComponentInternal()}},t.Diagram.prototype._findUnresolvedLinks=function(t,e){if(!("none"===this.getOptions().promotedLinkBehavior||this.isDataProviderMode()&&"lazy"===this.getOptions().promotedLinkBehavior)){!function t(n,i){Array.isArray(n.nodes)&&n.nodes.forEach((function(n){i.set(n.id,!0),e&&t(n,i)}))}(t,this._allNodeIdsMap);for(var n=this._unresolvedNodeIds.length-1;n>=0;n--)this._allNodeIdsMap.has(this._unresolvedNodeIds[n])&&this._unresolvedNodeIds.splice(n,1);if(Array.isArray(t.links))for(n=0;n<t.links.length;n++){var i=t.links[n];this._allNodeIdsMap.has(i.startNode)||this._unresolvedNodeIds.push(i.startNode),this._allNodeIdsMap.has(i.endNode)||this._unresolvedNodeIds.push(i.endNode)}}},t.Diagram.prototype._discoverLinks=function(t,e){var n=this.getOptions().promotedLinkBehavior;return!("none"===n||0==this._unresolvedNodeIds.length||"lazy"==n&&t.getChildCount(e)<=0)&&"disjoint"!=t.getDescendantsConnectivity(e)},t.Diagram.prototype._setDataSourceListeners=function(t,e){t&&(this._dataSourceAddEventHandler||(this._dataSourceAddEventHandler=this.handleDataSourceChangeEvent.bind(this,"add")),this._dataSourceRemoveEventHandler||(this._dataSourceRemoveEventHandler=this.handleDataSourceChangeEvent.bind(this,"remove")),this._dataSourceChangeEventHandler||(this._dataSourceChangeEventHandler=this.handleDataSourceChangeEvent.bind(this,"change")),e?(t.on("add",this._dataSourceAddEventHandler),t.on("remove",this._dataSourceRemoveEventHandler),t.on("change",this._dataSourceChangeEventHandler)):(t.off("add",this._dataSourceAddEventHandler),t.off("remove",this._dataSourceRemoveEventHandler),t.off("change",this._dataSourceChangeEventHandler)))},t.Diagram.prototype.addDataSourceEventListeners=function(){this._setDataSourceListeners(this.getOptions().data,!0)},t.Diagram.prototype.removeDataSourceEventListeners=function(){this._setDataSourceListeners(this.getOptions().data,!1)},t.Diagram.prototype._fetchDataProviderData=function(t,e){var i=this.isTreeDataProvider()?n.GetCollapsedContainers(t,e,[]):[];if(i.length>0){var o=this,a=i.map((function(e){return o.Options._fetchDataHandler(t,o._context.KeySetImpl([e.id]),e,e.id)})),s=this._renderCount;Promise.all(a).then((function(n){if(s===o._renderCount&&o.getCtx().isReadyToRender()){e=[],n.forEach((function(t){Array.isArray(t)&&t.forEach((function(t){o._allNodeIdsMap.set(t.id,!0),e.push(t)}))}));for(var i=o._unresolvedNodeIds.length-1;i>=0;i--)o._allNodeIdsMap.has(o._unresolvedNodeIds[i])&&o._unresolvedNodeIds.splice(i,1);o._unresolvedNodeIds.length>0?o._fetchDataProviderData(t,e):o.RenderComponentInternal()}}))}else this.RenderComponentInternal()},t.Diagram.prototype.isDataProviderMode=function(){return!!this.getOptions().nodeData},t.Diagram.prototype.isTreeDataProvider=function(){var t=this.getOptions().nodeData;return!(!t||!t.getChildDataProvider)},t.Diagram.prototype.Render=function(){if(t.Diagram.superclass.Render.call(this),this.InitComponentInternal(),this._deferredObjCount=0,this._nodesToResolve=[],this._bRendered||this.IsResize())0===this._deferredObjCount&&this.RenderComponentInternal();else if(this._renderCount++,this.isDataProviderMode()){this._findUnresolvedLinks({nodes:this.Options.nodes,links:this.Options.links},!0);var e=this._unresolvedNodeIds.length>0?this.Options.nodes.slice():[];this._fetchDataProviderData(this.Options.nodeData,e)}else if(this.getOptions().data){var n=this.getOptions().data;this._setDataSourceListeners(n,!1),this._resolveDeferredData(n,null)}else this.RenderComponentInternal()},t.Diagram.prototype.RenderComponentInternal=function(){var t;if(this._bRendered||this.IsResize()||(this._setDataSourceListeners(this.getOptions().data,!0),this.prepareNodes(this.getOptions().nodes),this.renderLinks(this.getOptions().links),this.getCtx().setKeyboardFocusArray([this])),t=0===this._nodes.size)this._processContent(t);else{this.contains(this._oldPanZoomCanvas)||this.addChild(this._oldPanZoomCanvas);var e=this.layout(),n=this,i=this._renderCount;e.then((function(){i===n._renderCount&&n._processContent(t)}),(function(){i===n._renderCount&&(n.removeChild(n._oldPanZoomCanvas),n._oldPanZoomCanvas=null,n._bRendered=!0,this._currentViewport=null)}))}},t.Diagram.prototype._processContent=function(n){var o;if(n||(this.removeChild(this._oldPanZoomCanvas),this._processHighlighting(),this._processInitialSelections(),this._updateKeyboardFocusEffect(),(o=null==this._cachedViewBounds)&&(this._cachedViewBounds=this.GetViewBounds()),this._fitContent()),!this._bRendered){var a=this.getPanZoomCanvas();a.setPanningEnabled(this.IsPanningEnabled()),a.setPanDirection(this.getPanDirection()),a.setZoomingEnabled(this.IsZoomingEnabled()),a.setZoomToFitEnabled(this.IsZoomingEnabled())}!this.Overview&&this.Options.overview&&"on"==this.Options.overview.rendered?this.Overview=i.CreateOverviewWindow(this):this.Overview&&i.UpdateOverviewWindow(this,this.Overview),this._oldPanZoomCanvas=null,this.StopAnimation(!0);var s=e.getAnimationOnDisplay(this),r=e.getAnimationOnDataChange(this);if(this._bRendered||"none"===s||this._oldDataAnimState){if("none"!==r&&this._oldDataAnimState){this._deleteContainer=new t.Container(this.getCtx(),"Delete Container"),this.addChild(this._deleteContainer);var l=new d(this.getCtx(),this._deleteContainer,this._oldDataAnimState,this);l.constructAnimation([this._oldDataAnimState],[this]),this.Animation=l.getAnimation()}}else this.Animation=t.BlackBoxAnimationHandler.getInAnimation(this.getCtx(),t.BlackBoxAnimationHandler.ALPHA_FADE,this,null,e.getAnimationDuration(this));if(this.Animation?(this.getEventManager().hideTooltip(),this.getEventManager().removeListeners(this),this.Animation.setOnEnd(this._onAnimationEnd,this),this.Animation.play()):this._onAnimationEnd(),this._bRendered=!0,this._currentViewport=null,this.RefreshEmptyText(n),this.IsPanningEnabled()){var h=this._cachedViewBounds;if(null!=h){var g=this.getPanZoomCanvas().getZoom();this.ConstrainPanning(h.x,h.y,h.w,h.h,g)}}this.ClearLayoutViewport(),o&&(this._cachedViewBounds=null)},t.Diagram.prototype._fitContent=function(){var e=this.getPanZoomCanvas();if(this._bRendered){if(this.IsResize()||this._partialUpdate){var n=this.AdjustMinZoom();o=(i=this.IsLayoutViewport())?this.GetLayoutViewport():n||this._cachedViewBounds;e.setZoomToFitPadding(i?0:t.PanZoomCanvas.DEFAULT_PADDING),e.setZoomToFitEnabled(!0),e.zoomToFit(null,o),e.setZoomToFitEnabled(this.IsZoomingEnabled())}}else{this.AdjustMinZoom();var i,o=(i=this.IsLayoutViewport())?this.GetLayoutViewport():this._cachedViewBounds;i&&e.setZoomToFitPadding(0),e.zoomToFit(null,o)}},t.Diagram.prototype.SetOptions=function(e){t.Diagram.superclass.SetOptions.call(this,e),this.isDataProviderMode()||(this.Options.nodes=[],this.Options.links=[]),this.SetPanningEnabled("none"!=this.Options.panning),this.SetZoomingEnabled("none"!=this.Options.zooming),this.setSelectionMode(this.Options.selectionMode),this.setEmptyText(this.Options.emptyText?this.Options.emptyText:this.Options.translations.labelNoData)},t.Diagram.getDefaults=function(t){return(new s).getDefaults(t)},t.Diagram.prototype.getMaxZoom=function(){var t=this.getOptions().maxZoom,e=parseFloat(t);return e>0?e:1},t.Diagram.prototype.getMinZoom=function(){var t=this.getOptions().minZoom;if(t){var e=parseFloat(t);return e>0&&(t=Math.min(e,this.getMaxZoom())),t}return 0},t.Diagram.prototype.getPanDirection=function(){return this.getOptions().panDirection},t.Diagram.prototype.getAnimationDuration=function(){return e.getAnimationDuration(this)},t.Diagram.prototype.processEvent=function(t,e){var n=t.type;if("categoryHighlight"==n)this._processHighlighting(!0);else if("selection"==n)this.getOptions().selection=t.selection;else if("overview"==n){var i=t.subtype;return void("scrollPos"!=i&&"scrollTime"!=i||this.Overview.HandleViewportChange(t))}t&&this.dispatchEvent(t)},t.Diagram.prototype.prepareNodes=function(t){if(t){this._prepareNodes(null,t);var e=this.getOptions().expanded;e&&(e.has||this.DisclosedNodes)||(this.DisclosedNodes=e?"all"===e?this._arNodeIds.slice(0):e:[])}},t.Diagram.prototype.renderLinks=function(n){if(n){for(var i=e.getLinkDefaultStyles(this,"linkDefaults"),o=0;o<n.length;o++){var a=n[o];if(!this._isLinkPromoted(a)){a=e.getLinkStyles(this,a,i);var s=g.newInstance(this,a,!1),r=s.getId();if(this._arLinkIds.push(r),!s.isHidden()){var d=this.getNodeById(s.getStartId()),l=this.getNodeById(s.getEndId());d.addOutLinkId(r),l.addInLinkId(r),s.render(),this._links.set(r,s)}}}if(this._promotedLinksMap){var h=e.getLinkDefaultStyles(this,"promotedLink"),u=this;this._promotedLinksMap.forEach((function(e,n,i){if(!u._links.has(n)){var o=t.JsonUtils.merge(e,h),a=g.newInstance(u,o,!0),s=a.getId(),r=u.getNodeById(a.getStartId()),d=u.getNodeById(a.getEndId());r.addOutLinkId(s),d.addInLinkId(s),a.render(),u._arLinkIds.push(s),u._links.set(s,a)}}))}}},t.Diagram.prototype.layout=function(){var e=this.getOptions().layout,n=this._getLayoutContext();if(n.setDirtyContext(new(this.getCtx().ojMap)),this._currentViewport){var i=this._currentViewport,o=this.getLayoutOffset(),a=new t.DiagramRectangle(i.x-o.x,i.y-o.y,i.w,i.h);n.setCurrentViewport(a)}if(e&&"function"==typeof e){for(var s=n.getNodeCount(),r=0;r<s;r++){var d=n.getNodeByIndex(r);this.renderLeafNodeFromContext(d)}var l=this,h=e(n);h||(h={then:function(t,e){t()}}),this.setAlphas(0);var g=this._renderCount;return h.then((function(t){if(l._renderCount===g||l.IsResize()){l.setAlphas(1),l._oldDataAnimState&&l._oldDataAnimState.updateStateFromLayoutContext(n);for(var e=n.getNodeCount(),i=0;i<e;i++){var o=n.getNodeByIndex(i);l.renderNodeFromContext(o,!0)}l.ApplyLayoutContext(n,!0)}}),(function(t){})),h}this.Log("dvt.Diagram: Layout function is not defined",1)},t.Diagram.prototype.setAlphas=function(t){this._bRendered||(this.getLinksPane().setAlpha(t),this.getNodesPane().setAlpha(t))},t.Diagram.prototype.getNodeById=function(t){return this._nodes.get(t)},t.Diagram.prototype.getLinkById=function(t){return this._links.get(t)},t.Diagram.prototype.GetAllLinks=function(){return this._arLinkIds},t.Diagram.prototype.GetAllLinksMap=function(){var t=new(this.getCtx().ojMap);return this._links&&this._links.forEach((function(e,n,i){t.set(n,e)})),t},t.Diagram.prototype.GetAllLinkObjects=function(){var t=[];return this._links&&this._links.forEach((function(e,n,i){t.push(e)})),t},t.Diagram.prototype.GetAllNodes=function(){return this._arNodeIds},t.Diagram.prototype.GetAllNodesMap=function(){var t=new(this.getCtx().ojMap);return this._nodes&&this._nodes.forEach((function(e,n,i){t.set(n,e)})),t},t.Diagram.prototype.GetAllNodeObjects=function(){var t=[];return this._nodes&&this._nodes.forEach((function(e,n,i){t.push(e)})),t},t.Diagram.prototype.GetAllRoots=function(){return this._arRootIds},t.Diagram.prototype.GetRootNodeObjects=function(){for(var t=[],e=0;this._arRootIds&&e<this._arRootIds.length;e++){var n=this._nodes.get(this._arRootIds[e]);n&&t.push(n)}return t},t.Diagram.prototype.HandlePanEvent=function(e){t.Diagram.superclass.HandlePanEvent.call(this,e),this.Overview&&this.Overview.UpdateViewport()},t.Diagram.prototype.HandleZoomEvent=function(e){switch(t.Diagram.superclass.HandleZoomEvent.call(this,e),this.Overview&&this.Overview.UpdateViewport(),e.subtype){case"adjustPanConstraints":if(this.IsPanningEnabled()){var n=e.newZoom,i=this.GetViewBounds();this.ConstrainPanning(i.x,i.y,i.w,i.h,n)}break;case"zoomed":var o=this.getOptions().nodeContent||{};!t.Agent.isTouchDevice()&&o.zoomRenderer&&e.oldZoom!==e.newZoom&&this._nodes.forEach((function(t,n,i){t.rerenderOnZoom(e)}));break;case"zoomToFitEnd":case"zoomEnd":o=this.getOptions().nodeContent||{};t.Agent.isTouchDevice()&&o.zoomRenderer&&e.oldZoom!==e.newZoom&&this._nodes.forEach((function(t,n,i){t.rerenderOnZoom(e)}))}},t.Diagram.prototype.getNavigableLinksForNodeId=function(t){var e=[];return this._links.forEach((function(n,i,o){var a=n.getStartId(),s=n.getEndId();a!=t&&s!=t||!n.getVisible()||e.push(n)})),e},t.Diagram.prototype._processInitialSelections=function(){if(this.Options.selection&&this.isSelectionSupported()){var t=[];this._nodes.forEach((function(e,n,i){t.push(e)})),this._links.forEach((function(e,n,i){t.push(e)})),this.getSelectionHandler().processInitialSelections(this.Options.selection,t)}},t.Diagram.prototype._processHighlighting=function(e){e&&this.EventManager.removeListeners(this,!0),this._highlightedObjects&&(this._updateAlphas(!1,this._highlightedObjects),this._highlightedObjects=null);var n=this.Options.highlightedCategories;if(n&&0!==n.length){var i="any"==this.Options.highlightMatch;this._highlightedObjects=new(this.getCtx().ojMap);var o=[],a=this;this._nodes.forEach((function(e,s,r){(i?t.ArrayUtils.hasAnyItem(e.getCategories(),n):t.ArrayUtils.hasAllItems(e.getCategories(),n))&&(a._highlightedObjects.set(s,e),o.push(e))})),this._processNodeConnections(o);var s=[];if(this._links.forEach((function(e,o,r){(i?t.ArrayUtils.hasAnyItem(e.getCategories(),n):t.ArrayUtils.hasAllItems(e.getCategories(),n))&&(a._highlightedObjects.set(o,e),s.push(e))})),"linkAndNodes"==this.Options.linkHighlightMode&&this._processLinkConnections(s),this._updateAlphas(!0,this._highlightedObjects),e){a=this;setTimeout((function(){a.getEventManager().addListeners(a)}),0)}}else e&&this.EventManager.addListeners(this)},t.Diagram.prototype._processNodeConnections=function(t){var e=this.Options.nodeHighlightMode;if("node"!=e){for(var n="nodeAndIncomingLinks"==e||"nodeAndLinks"==e,i="nodeAndOutgoingLinks"==e||"nodeAndLinks"==e,o=[],a=0;a<t.length;a++){var s=t[a],r=n&&s.getInLinkIds()?s.getInLinkIds():[];r=i&&s.getOutLinkIds()?r.concat(s.getOutLinkIds()):r;for(var d=0;d<r.length;d++){var l=r[d];this._highlightedObjects.set(l,this.getLinkById(l)),o.push(this.getLinkById(l))}}this._processLinkConnections(o)}},t.Diagram.prototype._processLinkConnections=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=n.getStartId(),o=n.getEndId();this._highlightedObjects.set(i,this.getNodeById(i)),this._highlightedObjects.set(o,this.getNodeById(o))}},t.Diagram.prototype._updateAlphas=function(t,e){var n=this._nodes.size+this._links.size;if(e.size!==n)if(this._arNodeIds.length==this._arRootIds.length){var i=t?this.Options.styleDefaults._highlightAlpha:1,o=this.getLinksPane(),a=this.getNodesPane();if(e.size>.5*n){var s=this.getBottomPane();s.setAlpha(i),this._links.forEach((function(n,i,a){var r=e.get(i);!r&&t?s.addChild(n):r||o.addChild(n)})),this._nodes.forEach((function(n,i,o){var r=e.get(i);!r&&t?s.addChild(n):r||a.addChild(n)}))}else{var r=this.getTopPane();o.setAlpha(i),a.setAlpha(i);var d=[],l=[];e.forEach((function(t,e,n){t instanceof g?d.push(t):t instanceof u&&l.push(t)}));for(var h=0;h<d.length;h++)t?r.addChild(d[h]):o.addChild(d[h]);for(h=0;h<l.length;h++)t?r.addChild(l[h]):a.addChild(l[h])}}else t?(e.forEach((function(t,e,n){t.highlight(!0)})),this._nodes.forEach((function(t,n,i){e.has(n)||t.highlight(!1)})),this._links.forEach((function(t,n,i){e.has(n)||t.highlight(!1)}))):(this._nodes.forEach((function(t,e,n){t.highlight(!0)})),this._links.forEach((function(t,e,n){t.highlight(!0)})))},t.Diagram.prototype.highlight=function(e){this.Options.highlightedCategories=t.JsonUtils.clone(e),this._processHighlighting()},t.Diagram.prototype.select=function(e){this.Options.selection=t.JsonUtils.clone(e),this._processInitialSelections()},t.Diagram.prototype.getAutomation=function(){return this.Automation||(this.Automation=new c(this)),this.Automation},t.Diagram.prototype.Log=function(t,e){var n=this.getOptions()._logger;if(n)switch(e){case 1:n.error&&n.error(t);break;case 2:n.warn&&n.warn(t);break;case 3:n.info&&n.info(t);break;default:n.log&&n.log(t)}},t.Diagram.prototype.processDefaultHoverEffect=function(t,e){var n=this.getNodeById(t);n&&n.processDefaultHoverEffect(e)},t.Diagram.prototype.processDefaultSelectionEffect=function(t,e){var n=this.getNodeById(t);n&&n.processDefaultSelectionEffect(e)},t.Diagram.prototype.processDefaultFocusEffect=function(t,e){var n=this.getNodeById(t);n&&n.processDefaultFocusEffect(e)},t.Diagram.prototype.updateNodeDims=function(e){if(e.IsRendered){var n=this.getNodeById(e.getId());e.setBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(n.getLayoutBounds(!0))),e.setContentBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(n.getContentBounds(!0))),e.setLabelBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(n.getLabelBounds(!0)))}else this.renderNodeFromContext(e,!0)},t.Diagram.prototype.renderLeafNodeFromContext=function(t){if(this.getNodeById(t.getId()).isDisclosed())for(var e=t.getChildNodes(),n=0;n<e.length;n++){var i=e[n];this.renderLeafNodeFromContext(i)}else this.renderNodeFromContext(t,!1)},t.Diagram.prototype.renderNodeFromContext=function(e,n){if(!e.IsRendered){var i=this.getNodeById(e.getId());if(i.isDisclosed()){var o=this.CreateEmptyLayoutContext();o.setDirtyContext(e.LayoutContext?e.LayoutContext.getDirtyContext():null),this._oldDataAnimState&&this._oldDataAnimState.updateStateFromLayoutContext(o);for(var a=e.getChildNodes(),s=0;s<a.length;s++){var r=a[s];this.renderNodeFromContext(r,!1),o.addNode(r)}for(s=0;s<a.length;s++)this.updateNodeDims(a[s]);this.ApplyLayoutContext(o)}i.render();var d=i.isDisclosed()?i.getContainerPadding():null;d&&e.setContainerPadding(d.top,d.right,d.bottom,d.left),e.setBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(i.getLayoutBounds(n))),e.setContentBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(i.getContentBounds(n))),e.setLabelBounds(t.DiagramLayoutUtils.convertRectToDiagramRect(i.getLabelBounds(n))),e.IsRendered=!0}},t.Diagram.prototype._prepareNodes=function(t,n){if(n)for(var i=e.getNodeDefaultStyles(this),o=0;o<n.length;o++){var a=e.getNodeStyles(this,n[o],i),s=u.newInstance(this,a),r=s.getId();t?(t.addChildNodeId(r),s.setGroupId(t.getId())):this._arRootIds.push(r),this._arNodeIds.push(r),a.nodes&&a.nodes.length>0&&(this._isNodeDisclosed(r)?(s.setDisclosed(!0),this._prepareNodes(s,a.nodes)):this._addToCollapsedArray(s)),s.isHidden()||(t&&t.GetChildNodePane()?t.GetChildNodePane().addChild(s):this.getNodesPane().addChild(s),this._nodes.set(r,s))}},t.Diagram.prototype.setNodeDisclosed=function(e,n){n!=this._isNodeDisclosed(e)&&this.dispatchEvent(new t.EventFactory.newEvent(n?"beforeExpand":"beforeCollapse",e))},t.Diagram.prototype.expand=function(e){var i=!1,o=this.getOptions().expanded;o&&o.has&&!o.has(e)?(i=!0,o=o.add([e]),this.applyOptions({expanded:o},this.Defaults.getNoCloneObject())):(this.DisclosedNodes||(this.DisclosedNodes=[]),this.DisclosedNodes.indexOf(e)<0&&(this.DisclosedNodes.push(e),i=!0));if(i){var a=this.getNodeById(e);if(this.isDataProviderMode()&&!a.getData().nodes){var s=n.GetNodeOption(this,a),r=this,d=this._renderCount;this.getOptions()._fetchDataHandler(this.getOptions().nodeData,o,s,e).then((function(n){d===r._renderCount&&(r.render(r.getOptions(),r.Width,r.Height),r.dispatchEvent(new t.EventFactory.newEvent("expand",e)))}))}else this.render(this.getOptions(),this.Width,this.Height),this.dispatchEvent(new t.EventFactory.newEvent("expand",e))}},t.Diagram.prototype.collapse=function(e){var n=!1,i=this.getOptions().expanded;if(i&&i.has&&i.has(e))n=!0,i=i.delete([e]),this.applyOptions({expanded:i},this.Defaults.getNoCloneObject());else{var o=-1;this.DisclosedNodes&&(o=this.DisclosedNodes.indexOf(e)),o>-1&&(this.DisclosedNodes.splice(o,1),n=!0)}n&&(this.render(this.getOptions(),this.Width,this.Height),this.dispatchEvent(new t.EventFactory.newEvent("collapse",e)))},t.Diagram.prototype._addLayoutContextForChildNodes=function(t,e,n,i){if(t.isDisclosed()){var o=t.getChildNodeIds(),a=this._createLayoutContextForChildNodes(e,n,o,i);e.setChildNodes(a)}},t.Diagram.prototype._appendLayoutContextForChildNodes=function(e,n,i,o,a){if(e.isDisclosed()){var s=o.reduce((function(t,e){return t.push(e.id),t}),[]),r=this._createLayoutContextForChildNodes(n,i,s,!0),d=n.getChildNodes()||[];r=t.ArrayUtils.insert(d,r,a),n.setChildNodes(r),n.setDisclosed(!0),n.SetContainerPaddingObj(t.BaseDiagram.getLayoutContainerPadding(e.getContainerPadding())),n.UpdateParentNodes()}},t.Diagram.prototype._createLayoutContextForChildNodes=function(t,e,n,i){for(var o=[],a=0;a<n.length;a++){var s=this.getNodeById(n[a]);if(s.getVisible()){var r=this.CreateLayoutContextNode(s,null,i,e);r.copyFrom(this._oldLayoutContext?this._oldLayoutContext.getNodeById(n[a]):null),e.addNodeToMap(r),r.setParentNode(t),o.push(r),this._addLayoutContextForChildNodes(s,r,e,i)}}return o},t.Diagram.prototype._isNodeDisclosed=function(t){var e=this.getOptions().expanded;if(e&&e.has)return e.has(t);var n=this.DisclosedNodes?this.DisclosedNodes:e;return n&&n.indexOf(t)>-1||n&&n.indexOf("all")>-1},t.Diagram.prototype._isLinkPromoted=function(t){var e=this.getNodeById(t.startNode),n=this.getNodeById(t.endNode);if(e&&n||!this._collapsedNodes)return!1;if("none"===this.getOptions().promotedLinkBehavior)return!0;var i=e?e.getId():this._findFirstVisibleAncestor(t.startNode),o=n?n.getId():this._findFirstVisibleAncestor(t.endNode);if(!i||!o)return!1;if(i===o)return!1;var a=g.GetPromotedLinkId(this,i,o);return this._promotedLinksMap||(this._promotedLinksMap=new(this.getCtx().ojMap)),this._promotedLinksMap.has(a)?this._promotedLinksMap.get(a)._links.push(t):this._promotedLinksMap.set(a,{id:a,startNode:i,endNode:o,_links:[t]}),this._linkToPromotedMap||(this._linkToPromotedMap=new(this.getCtx().ojMap)),this._linkToPromotedMap.set(t.id,a),!0},t.Diagram.prototype._addToCollapsedArray=function(t){this._collapsedNodes||(this._collapsedNodes=[]),this._collapsedNodes.push(t)},t.Diagram.prototype._findFirstVisibleAncestor=function(e){for(var n=this.getCtx(),i=function e(i,o){if(i)for(var a=0;a<i.length;a++)if(t.BaseDiagram.compareValues(n,i[a].id,o)||e(i[a].nodes,o))return!0;return!1},o=0;o<this._collapsedNodes.length;o++){var a=this._collapsedNodes[o];if(i(a.getData().nodes,e))return a.getId()}return null},t.Diagram.prototype._updateKeyboardFocusEffect=function(){var t,e=this.getEventManager().getFocus(),n=!1;e&&(e instanceof u?t=this.getNodeById(e.getId()):e instanceof g&&(t=this.getLinkById(e.getId())),n=e.isShowingKeyboardFocusEffect(),t&&n&&t.showKeyboardFocusEffect(),this.getEventManager().setFocus(t))},t.Diagram.prototype.clearDisclosedState=function(){this.DisclosedNodes=null},t.Diagram.prototype.ShowLinkCreationFeedback=function(n){if(this.getEventManager().LinkCreationStarted){var i=this._context.pageToStageCoords(n.pageX,n.pageY),o=this.getPanZoomCanvas().getContentPane().stageToLocal({x:i.x,y:i.y});if(this._linkCreationFeedBack){var a=this._linkCreationFeedBack.GetCreationFeedbackPoints(o);this._linkCreationFeedBack.setPoints(a)}else{var s=this.getEventManager().DragSource.getDragObject();if(s instanceof u){var r=this.getEventManager().DragSource.getDragCoords(),d=this.getPanZoomCanvas().getContentPane().stageToLocal({x:r.x,y:r.y}),l=this.getOptions().styleDefaults.linkDefaults;e.prepareLinkStyle(l,"style");var h=this.getOptions().dnd.drag.ports.linkStyle;if(h&&"function"==typeof h){var c=h({dataContext:s.getDataContext(),portElement:s.__dragPort});c&&(l.style=t.JsonUtils.merge(c.svgStyle,l.style),l.svgClassName=c.svgClassName||l.className)}var p={id:"linkFeedback",startNode:s.getId(),endNode:s.getId()};p=t.JsonUtils.merge(p,l);var m=g.newInstance(this,p,!1);this.getNodesPane().addChild(m),m.setMouseEnabled(!1),m.setPoints([d.x,d.y,o.x,o.y]),this._linkCreationFeedBack=m}}}},t.Diagram.prototype.HideLinkCreationFeedback=function(){this.getNodesPane().removeChild(this._linkCreationFeedBack),this._linkCreationFeedBack=null},t.Diagram.prototype.handleDataSourceChangeEvent=function(t,n){if("none"!==e.getAnimationOnDataChange(this)&&(this._oldDataAnimState=new r(this,t,n)),this._currentViewport=this.getPanZoomCanvas().getViewport(),this.IsPanningEnabled()){var i=this.getPanZoomCanvas();i.setMinPanY(null),i.setMaxPanY(null),i.setMinPanX(null),i.setMaxPanX(null)}var o,a,s=n.data.nodes,d=n.data.links;if("add"==t){if(a=(o=n.parentId)?this.getNodeById(o):null,"all"===this.getOptions().expanded&&s){var l=this.DisclosedNodes;!function t(e){for(var n=0;n<e.length;n++)l.push(e[n].id),e[n].nodes&&t(e[n].nodes)}(s)}a?(a.appendChildNodesData(s,n.index),this._isNodeDisclosed(o)&&(a.setDisclosed(!0),this._prepareNodes(a,s))):this._prepareNodes(null,s),this.renderLinks(d)}else if("change"==t){if(s)for(var h=e.getNodeDefaultStyles(this),g=0;g<s.length;g++){var u=this.getNodeById(s[g].id);if(u){var c=e.getNodeStyles(this,s[g],h);u.setData(c)}}d&&(this._removeLinks(d),this.renderLinks(d))}else"remove"==t&&((a=(o=n.parentId)?this.getNodeById(o):null)?(this._removeNodes(a,s),a.removeChildNodesData(s),a.getData().nodes&&0!==a.getData().nodes.length||a.setDisclosed(!1)):this._removeNodes(null,s),this._removeLinks(d));this._oldDataAnimState&&this._oldDataAnimState.updateStateFromEvent(t,n),this._updateLayoutContext(t,n);var p=0===this.GetAllNodes().length;if(p)this._processContent(p);else{this._renderCount++;var m=this.layout(),_=this,f=this._renderCount;m.then((function(){f===_._renderCount&&(_._partialUpdate=!0,_._updateOverview(t,n),_._processContent(!1),_._partialUpdate=!1)}),(function(){f===_._renderCount&&(_.removeChild(_._oldPanZoomCanvas),_._oldPanZoomCanvas=null,_._bRendered=!0,this._currentViewport=null)}))}},t.Diagram.prototype._updateOverview=function(t,e){this.Overview&&i.UpdateOverviewContent(this,this.Overview,t,e)},t.Diagram.prototype._updateLayoutContext=function(t,e){this._layoutContext||(this._layoutContext=this.CreateEmptyLayoutContext());var n=this._layoutContext;n.setEventData({type:t,data:e});var i,o,a,s,r,d,l=e.data.nodes,h=e.data.links;if(e.parentId&&(s=n.getNodeById(e.parentId),r=this.getNodeById(e.parentId)),"add"==t){if(l)if(s&&r)s.Reset(),this._appendLayoutContextForChildNodes(r,s,n,l,e.index);else for(i=0;i<l.length;i++)a=l[i].id,this.getNodeById(a)&&(o=this.CreateLayoutContextNode(this.getNodeById(a),null,!0,n),this._addLayoutContextForChildNodes(this.getNodeById(a),o,n,!0),n.addNode(o));if(h)for(i=0;i<h.length;i++){if(d=h[i].id,p=this.getLinkById(d)||this.getLinkById(this._linkToPromotedMap.get(d))){if(n.getLinkById(p.getId()))continue;var g=p.getData().startNode,u=p.getData().endNode;n.getNodeById(g)&&n.getNodeById(u)&&n.addLink(this.CreateLayoutContextLink(p,g,u,null,n))}}}else if("change"==t){if(l)for(i=0;i<l.length;i++)a=l[i].id,(o=n.getNodeById(a))&&(o.Reset(),o.UpdateParentNodes());if(h){for(i=n.getLinkCount()-1;i>=0;i--){var c=n.getLinkByIndex(i);this._links.get(c.getId())||n.removeLink(c)}for(i=0;i<h.length;i++){var p;if(d=h[i].id,p=this.getLinkById(d)||this.getLinkById(this._linkToPromotedMap.get(d))){n.removeLink(n.getLinkById(p.getId()));g=p.getData().startNode,u=p.getData().endNode;n.getNodeById(g)&&n.getNodeById(u)&&n.addLink(this.CreateLayoutContextLink(p,g,u,null,n))}}}}else if("remove"==t){if(l){for(i=0;i<l.length;i++)a=l[i].id,o=n.getNodeById(a),n.removeNode(s,o);s&&r&&(s.Reset(),s.UpdateParentNodes(),s.setDisclosed(r.isDisclosed()))}for(i=n.getLinkCount()-1;i>=0;i--){c=n.getLinkByIndex(i);this._links.get(c.getId())||n.removeLink(c)}}},t.Diagram.prototype._getLayoutContext=function(){if(!this._layoutContext){for(var t=this.CreateEmptyLayoutContext(),e=0;e<this._arRootIds.length;e++){var n=this._arRootIds[e];if(this.getNodeById(n)){var i=!this._bRendered,o=this.getNodeById(n),a=this.CreateLayoutContextNode(o,null,i,t);a.copyFrom(this._oldLayoutContext?this._oldLayoutContext.getNodeById(n):null),this._addLayoutContextForChildNodes(o,a,t,i),t.addNode(a)}}var s=this;this._links.forEach((function(e,n,i){var o=e.getData().startNode,a=e.getData().endNode;if(t.getNodeById(o)&&t.getNodeById(a)){var r=s.CreateLayoutContextLink(e,o,a,null,t);r.copyFrom(s._oldLayoutContext?s._oldLayoutContext.getLinkById(n):null),t.addLink(r)}})),this._layoutContext=t,this._oldLayoutContext=null}return this._layoutContext},t.Diagram.prototype._removeNodes=function(e,n){if(n&&(!e||e.isDisclosed())){for(var i=[],o=0;o<n.length;o++){var a=n[o].id,s=this.getNodeById(a);this._removeNodes(s,s.getData().nodes),this._links.forEach((function(t,e,n){t.getStartId()!=a&&t.getEndId()!=a||i.push(t.getData())})),
e?e.removeChildNode(s):(t.ArrayUtils.removeItem(this._arRootIds,a),this.getNodesPane().removeChild(s)),t.ArrayUtils.removeItem(this._arNodeIds,a),this._nodes.delete(a)}this._removeLinks(i)}},t.Diagram.prototype._removeLinks=function(e){if(e&&0!=e.length)for(var n=0;n<e.length;n++){var i=e[n].id,o=this.getLinkById(i);if(o){o.getParent().removeChild(o);var a=this.getNodeById(o.getStartId()),s=this.getNodeById(o.getEndId());a&&a.removeOutLinkId(i),s&&s.removeInLinkId(i),t.ArrayUtils.removeItem(this._arLinkIds,i),this._links.delete(i)}else if(this._linkToPromotedMap&&this._linkToPromotedMap.has(i)){var r=this._linkToPromotedMap.get(i),d=this._links.get(r),l=d?d.getData()._links:null;if(l&&1==l.length&&l[0].id==i){d.getParent().removeChild(d);a=this.getNodeById(d.getStartId()),s=this.getNodeById(d.getEndId());a&&a.removeOutLinkId(r),s&&s.removeInLinkId(r),t.ArrayUtils.removeItem(this._arLinkIds,d.getId()),this._links.delete(d.getId()),this._promotedLinksMap.delete(d.getId()),this._linkToPromotedMap.delete(i)}else if(l){for(n=0;n<l.length;n++)t.BaseDiagram.compareValues(this.getCtx(),l[n].id,i)&&l.splice(n,1);this._linkToPromotedMap.delete(i)}}}},t.Diagram.prototype.handleTouchStart=function(){},t.Diagram.prototype.handleTouchEnd=function(){this._clearTouchEventContent(),this._touchEventContentDiagramObjRef&&this._touchEventContentDiagramObjRef.handleTouchEnd&&(this._touchEventContentDiagramObjRef.handleTouchEnd(),this._touchEventContentDiagramObjRef=null)},t.Diagram.prototype.storeTouchEventContent=function(e,n){this.getTouchEventPane()&&e&&(this._touchEventContentDiagramObjRef=n,e.namespaceURI===t.ToolkitUtils.SVG_NS?t.ToolkitUtils.appendChildElem(this.getTouchEventPane().getElem(),e):Array.isArray(e)&&e.forEach(function(e){t.ToolkitUtils.appendChildElem(this.getTouchEventPane().getElem(),e)}.bind(this)))},t.Diagram.prototype._clearTouchEventContent=function(){if(this.getTouchEventPane())for(var t=this.getTouchEventPane().getElem();t.firstChild;)t.removeChild(t.firstChild)};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var a=function t(e,n){t.superclass.constructor.call(this,e,n),this.setHoverDelay(t._HOVER_DELAY),this._diagram=n};t.Obj.createSubclass(a,t.CategoryRolloverHandler,"DvtDiagramCategoryRolloverHandler"),a._HOVER_DELAY=100,a.prototype.GetRolloverCallback=function(e,n,i,o){return t.Obj.createCallback(this,(function(){this.SetHighlightMode(!0),this._diagram.processEvent(e)}))},a.prototype.GetRolloutCallback=function(e,n,i,o){return t.Obj.createCallback(this,(function(){this.SetHighlightModeTimeout(),this._diagram.processEvent(e)}))};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var s=function t(e){this.Init({alta:t.SKIN_ALTA},e)};t.Obj.createSubclass(s,t.BaseComponentDefaults,"DvtDiagramDefaults"),s.SKIN_ALTA={skin:t.CSSStyle.SKIN_ALTA,emptyText:null,selectionMode:"none",animationOnDataChange:"none",animationOnDisplay:"none",maxZoom:1,highlightMatch:"all",nodeHighlightMode:"node",linkHighlightMode:"link",panning:"none",overview:{fitArea:"content",preserveAspectRatio:"meet"},touchResponse:"auto",zooming:"none",promotedLinkBehavior:"lazy",_statusMessageStyle:new t.CSSStyle(t.BaseComponentDefaults.FONT_FAMILY_ALTA),dnd:{drag:{nodes:{},ports:{}},drop:{background:{},nodes:{},links:{},ports:{}}},styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,_highlightAlpha:.1,_overviewStyles:{overview:{backgroundColor:"rgb(228,229,230)"},overviewContent:{padding:"10px"},viewport:{backgroundColor:"rgb(255,255,255)",borderColor:"rgb(74,76,78)"},node:{shape:"inherit"}},nodeDefaults:{_containerStyle:new t.CSSStyle("border-color:#abb3ba;background-color:#f9f9f9;border-width:.5px;border-radius:1px;padding-top:20px;padding-left:20px;padding-bottom:20px;padding-right:20px;"),labelStyle:new t.CSSStyle(t.BaseComponentDefaults.FONT_FAMILY_ALTA_BOLD_12+"color:#383A47"),hoverInnerColor:"rgb(255,255,255)",hoverOuterColor:"rgba(0,0,0, .3)",selectionColor:"rgb(0,0,0)",icon:{width:10,height:10,fillPattern:"none",shape:"circle"}},linkDefaults:{startConnectorType:"none",endConnectorType:"none",width:1,_style:{_type:"solid"},hoverInnerColor:"rgb(255,255,255)",hoverOuterColor:"rgba(0,0,0, .3)",selectionColor:"rgb(0,0,0)",labelStyle:new t.CSSStyle(t.BaseComponentDefaults.FONT_FAMILY_ALTA_BOLD_12+"color:#383A47"),_hitDetectionOffset:10},promotedLink:{startConnectorType:"none",endConnectorType:"none",width:1,_style:{_type:"dot",strokeDasharray:"2,3"},color:"#778999",hoverInnerColor:"rgb(255,255,255)",hoverOuterColor:"rgba(0,0,0, .3)",selectionColor:"rgb(0,0,0)",_hitDetectionOffset:10}}},s.prototype.getNoCloneObject=function(){return{data:!0,nodeData:!0,linkData:!0,nodes:!0,links:!0}};
/**
   * @license
   * Copyright (c) 2017 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var r=function(t,e,n){this.Init(t,e,n)};t.Obj.createSubclass(r,t.Obj,"DvtDiagramDataAnimationState"),r.prototype.Init=function(t,e,n){this._diagram=t,this._context=t.getCtx(),this._nodes=[],this._newNodes=[],this._links=[],this._newLinks=[],this._processedObjMap=new this._context.ojMap,this.PanZoomMatrix=this._diagram.getPanZoomCanvas().getContentPane().getMatrix(),this.IsPartialUpdate=!(!e||!n),t.Overview&&(this.Overview=this.IsPartialUpdate?t.Overview.CreateAnimationClone():t.Overview),this.NodesMap=this._diagram.GetAllNodesMap(),this.LinksMap=this._diagram.GetAllLinksMap(),this._setNodes(e,n),this._setLinks(e,n)},r.prototype.getId=function(){return this._diagram.getId()},r.prototype.getOptions=function(){return this._diagram.getOptions()},r.prototype.getNodes=function(){return this._nodes},r.prototype.getLinks=function(){return this._links},r.prototype.getNewNodes=function(){return this._newNodes},r.prototype.getNewLinks=function(){return this._newLinks},r.prototype.updateStateFromEvent=function(t,e){if(e){var n,i,o,a=e.data.nodes,s=e.data.links;if("add"==t){for(n=0;a&&n<a.length;n++){var r=this._diagram.getNodeById(a[n].id);r&&(!0===this._wasParentDisclosed&&this._newNodes.push(r),this._processedObjMap.set(r.getId(),!0))}for(n=0;s&&n<s.length;n++)o=s[n].id,(i=this._diagram.getLinkById(o)||this._diagram._linkToPromotedMap&&this._diagram.getLinkById(this._diagram._linkToPromotedMap[o]))&&(this._newLinks.push(i),this._processedObjMap.set(i.getId(),!0))}else if("change"==t)for(n=0;s&&n<s.length;n++)o=s[n].id,(i=this._diagram.getLinkById(o)||this._diagram._linkToPromotedMap&&this._diagram.getLinkById(this._diagram._linkToPromotedMap[o]))&&(this._newLinks.push(i),this._processedObjMap.set(i.getId(),!0))}},r.prototype.updateStateFromLayoutContext=function(t){if(this.IsPartialUpdate){var e=this;t.getDirtyContext().forEach((function(t,n,i){e._processedObjMap.has(n)||((t=e._diagram.getNodeById(n)||e._diagram.getLinkById(n))instanceof u?(e._nodes.push(t.getAnimationState()),e._newNodes.push(t),e._processedObjMap.set(n,!0)):t instanceof g&&(e._links.push(t.getAnimationState()),e._newLinks.push(t),e._processedObjMap.set(n,!0)))}))}},r.prototype._setNodes=function(t,e){if(this.IsPartialUpdate){var n=e.data.nodes,i=e.parentId;if("add"==t)this._addAncestorStates(i);else if("change"==t)for(var o=0;n&&o<n.length;o++){(a=this._diagram.getNodeById(n[o].id))&&(this._addAncestorStates(a.getGroupId()),this._nodes.push(a.getAnimationState()),this._newNodes.push(a),this._processedObjMap.set(a.getId(),!0))}else if("remove"==t&&(this._addAncestorStates(i),n&&!i))for(o=0;o<n.length;o++){var a;(a=this._diagram.getNodeById(n[o].id))&&(this._nodes.push(a),this._processedObjMap.set(a.getId(),!0))}}else this._nodes=this._diagram.GetRootNodeObjects()},r.prototype._setLinks=function(t,e){if(this.IsPartialUpdate){var n,i,o,a=e.data.links;if(!a)return;if("change"==t)for(n=0;n<a.length;n++)o=a[n].id,(i=this._diagram.getLinkById(o)||this._diagram._linkToPromotedMap&&this._diagram.getLinkById(this._diagram._linkToPromotedMap[o]))&&(this._links.push(i.getAnimationState()),this._processedObjMap.set(i.getId(),!0));else if("remove"==t)for(n=0;n<a.length;n++)o=a[n].id,(i=this._diagram.getLinkById(o)||this._diagram._linkToPromotedMap&&this._diagram.getLinkById(this._diagram._linkToPromotedMap[o]))&&(this._links.push(i),this._processedObjMap.set(i.getId(),!0))}else this._links=this._diagram.GetAllLinkObjects()},r.prototype._addAncestorStates=function(e){var n=e?this._diagram.getNodeById(e):null;for(this._wasParentDisclosed=!n||n.isDisclosed();n;){var i=t.BaseDiagram.compareValues(this._context,n.getId(),e)||n.isDisclosed()&&this._diagram.getOptions().renderer,o=n.getAnimationState(i);this._nodes.push(o),this._newNodes.push(n),this._processedObjMap.set(n.getId(),!0),n=n.getGroupId()?this._diagram.getNodeById(n.getGroupId()):null}};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var d=function(t,e,n,i){this.Init(t,e,n,i)};t.Obj.createSubclass(d,t.DataAnimationHandler,"DvtDiagramDataAnimationHandler"),d.DELETE=0,d.UPDATE=1,d.INSERT=2,d.prototype.Init=function(t,e,n,i){d.superclass.Init.call(this,t,e),this._oldDiagram=n,this._newDiagram=i},d.prototype.getOldDiagram=function(){return this._oldDiagram},d.prototype.getNewDiagram=function(){return this._newDiagram},d.prototype.getAnimationDuration=function(){return e.getAnimationDuration(this._oldDiagram)},d.prototype.constructAnimation=function(t,e){var n=!1;if(e&&e.length>0&&(n=e[0]instanceof g),n&&!this.getCtx().isOffscreen()){var i,o,a=this.getCtx(),s=d._expandLinksArrayToMap(a,t),r=d._expandLinksArrayToMap(a,e),l=new a.ojMap,h=this;s.forEach((function(t,e,n){if(i=t,o=r.get(e))if(i.isPromoted()||o.isPromoted()){var a=i.isPromoted()?i.getData()._links.length:1,d=o.isPromoted()?o.getData()._links.length:1;a>d&&!l.has(i.getId())?h._constructExpandCollapseAnimation(i,r,l,!0):a<d&&!l.has(o.getId())?h._constructExpandCollapseAnimation(o,s,l,!1):a!=d||l.has(o.getId())||(o.animateUpdate(h,i),l.set(o.getId(),!0))}else o.animateUpdate(h,i);else-1==h.getNewDiagram().GetAllLinks().indexOf(i.getId())&&i.animateDelete(h)})),r.forEach((function(t,e,n){i=s.get(e),o=t,i||h.getOldDiagram().LinksMap.has(o.getId())||o.animateInsert(h)}))}else d.superclass.constructAnimation.call(this,t,e)},d.prototype._constructExpandCollapseAnimation=function(t,e,n,i){for(var o=[],a=t.getData()._links,s=0;s<a.length;s++){var r=e.get(a[s].id);r&&-1===o.indexOf(r)&&o.push(r)}o.length>0&&(i?t.animateExpand(this,o):t.animateCollapse(this,o),n.set(t.getId(),!0))},d._expandLinksArrayToMap=function(t,e){for(var n=new t.ojMap,i=0;i<e.length;i++){var o=e[i];if(o)if(o.isPromoted())for(var a=o.getData()._links,s=0;s<a.length;s++)n.set(a[s].id,o);else n.set(o.getId(),o)}return n};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var l=function(t,e,n){this.Init(t,e,n,n),this._diagram=n,this._linkDragSelector=null,this._linkDropSelector=null,this._prevRolloverEvent=null};t.Obj.createSubclass(l,t.EventManager,"DvtDiagramEventManager"),l.prototype.showFocusEffect=function(t,e){this.ShowFocusEffect(t,e)},l.prototype.ShowFocusEffect=function(t,e){this._diagram.isPanning()||l.superclass.ShowFocusEffect.call(this,t,e)},l.prototype.ProcessRolloverEvent=function(e,n,i){var o=this._diagram.getOptions();if("dim"==o.hoverBehavior&&(!this._prevRolloverEvent||this._prevRolloverEvent.obj!==n||this._prevRolloverEvent.bOver!==i)){var a=n.getCategories?n.getCategories():[];o.highlightedCategories=i?a.slice():null;var s=t.EventFactory.newCategoryHighlightEvent(o.highlightedCategories,i),r=t.CSSStyle.getTimeMilliseconds(o.styleDefaults.hoverBehaviorDelay);this.RolloverHandler.processEvent(s,this._diagram.GetAllNodeObjects(),r,"any"==o.highlightMatch),this._prevRolloverEvent={obj:n,bOver:i}}},l.prototype.CreateCategoryRolloverHandler=function(t,e){return new a(t,e)},l.prototype.ProcessKeyboardEvent=function(n){var i=!0,o=n.keyCode,a=this.getFocus(),s=a instanceof u?a._customNodeContent:null;if(o!=t.KeyboardEvent.TAB&&this._bPassOnEvent)s.fireKeyboardListener(n),n.preventDefault();else if(o==t.KeyboardEvent.TAB&&s instanceof t.BaseComponent)!n.shiftKey&&a.isShowingKeyboardFocusEffect()?(a.hideKeyboardFocusEffect(),s.fireKeyboardListener(n),n.preventDefault(),this._bPassOnEvent=!0):n.shiftKey&&this._bPassOnEvent?(this.ShowFocusEffect(n,a),n.preventDefault(),this._bPassOnEvent=!1):(this._bPassOnEvent&&a.showKeyboardFocusEffect(),i=l.superclass.ProcessKeyboardEvent.call(this,n),this._bPassOnEvent=!1);else if(o==t.KeyboardEvent.SPACE&&n.ctrlKey&&n.shiftKey)a&&a.HandleKeyboardEvent&&a.HandleKeyboardEvent(n);else if((o==t.KeyboardEvent.ZERO||o==t.KeyboardEvent.NUMPAD_ZERO)&&n.ctrlKey&&n.altKey){if(a){var r=this._diagram.getPanZoomCanvas(),d=a.getKeyboardBoundingBox(this.getCtx().getStage()),h=r.getContentPane().stageToLocal({x:d.x,y:d.y}),g=r.getContentPane().stageToLocal({x:d.x+d.w,y:d.y+d.h}),c={x:h.x,y:h.y,w:g.x-h.x,h:g.y-h.y},p="none"!=e.getAnimationOnDataChange(this._diagram)?new t.Animator(this.getCtx(),this._diagram.getAnimationDuration()):null;r.zoomToFit(p,c),p&&p.play()}}else o==t.KeyboardEvent.TAB&&a&&this._diagram.ensureObjInViewport(n,a),i=l.superclass.ProcessKeyboardEvent.call(this,n);return i},l.prototype.GetTouchResponse=function(){var e=this._diagram.getOptions();return"none"!==e.panning||"none"!==e.zooming?t.EventManager.TOUCH_RESPONSE_TOUCH_HOLD:e.touchResponse===t.EventManager.TOUCH_RESPONSE_TOUCH_START?t.EventManager.TOUCH_RESPONSE_TOUCH_START:t.EventManager.TOUCH_RESPONSE_AUTO},l.prototype.HandleTouchClickInternal=function(e){return this.GetEventInfo(e,t.PanZoomCanvasEventManager.EVENT_INFO_PANNED_KEY)},l.prototype.StoreInfoByEventType=function(e){return e!=t.PanZoomCanvasEventManager.EVENT_INFO_PANNED_KEY&&l.superclass.StoreInfoByEventType.call(this,e)},l.prototype.isDndSupported=function(){return!0},l.prototype.GetDragSourceType=function(t){var e,n=this.DragSource.getDragObject();return n&&n.__dragType?n.__dragType:n instanceof u?(null===this._linkDragSelector&&(this._linkDragSelector=this._diagram.getOptions().dnd.drag.ports.selector),this._linkDragSelector&&(e=this._getPortElement(document.elementFromPoint(t.getNativeEvent().clientX,t.getNativeEvent().clientY),this._linkDragSelector))&&(this.LinkCreationStarted=!0,n.__dragPort=e),n.__dragType=e?"ports":"nodes",n.__dragType):null},l.prototype.GetDragDataContexts=function(e){var n=this.DragSource.getDragObject();if(this._diagram.isSelectionSupported()&&this._diagram.getSelectionHandler().getSelectedCount()>1){for(var i=this._diagram.getSelectionHandler().getSelection(),o=this._getTopLeftContentCorner(i),a=this._diagram.getPanZoomCanvas().getZoom(),s=[],r=0;r<i.length;r++)if(i[r]instanceof u){var d=i[r].getDataContext(),l=i[r].getDimensions(this._context.getStage());d.nodeOffset=new t.Point((l.x-o.x)/a,(l.y-o.y)/a),e&&t.ToolkitUtils.cleanDragDataContext(d),s.push(d)}return s}if(n instanceof u){d=n.getDataContext();return e&&t.ToolkitUtils.cleanDragDataContext(d),"ports"===n.__dragType&&n.__dragPort?e?{dataContext:d}:{dataContext:d,portElement:n.__dragPort}:(d.nodeOffset=new t.Point(0,0),[d])}return[]},l.prototype.GetDropOffset=function(e){var n;if(this._diagram.isSelectionSupported()&&this._diagram.getSelectionHandler().getSelectedCount()>1)n=this._getTopLeftContentCorner(this._diagram.getSelectionHandler().getSelection());else{var i=this.DragSource.getDragObject();i instanceof u&&(n=i.getDimensions(this._context.getStage()))}if(n){var o=this._context.pageToStageCoords(e.pageX,e.pageY),a=this._diagram.getPanZoomCanvas().getZoom();return new t.Point((n.x-o.x)/a,(n.y-o.y)/a)}return null},l.prototype._getTopLeftContentCorner=function(e){if(!e)return null;for(var n=Number.MAX_VALUE,i=Number.MAX_VALUE,o=0;o<e.length;o++)if(e[o]instanceof u){var a=e[o].getDimensions(this._context.getStage());n=a?Math.min(a.x,n):n,i=a?Math.min(a.y,i):i}return new t.Point(n,i)},l.prototype.OnDndDragStart=function(t){var e=this.DragSource.getDragObject();e&&e.__dragType&&(e.__dragType=null,e.__dragPort=null),this.LinkCreationStarted=!1,l.superclass.OnDndDragStart.call(this,t)},l.prototype.OnDndDragOver=function(t){l.superclass.OnDndDragOver.call(this,t),this.LinkCreationStarted&&this._diagram.ShowLinkCreationFeedback(t)},l.prototype.OnDndDragEnd=function(t){l.superclass.OnDndDragEnd.call(this,t),this.LinkCreationStarted&&(this._diagram.HideLinkCreationFeedback(),this.LinkCreationStarted=!1),this._diagram.getPanZoomCanvas().panZoomEnd(),this._setPanningEnabled(!0)},l.prototype._setPanningEnabled=function(t){this._diagram.IsPanningEnabled()&&this._diagram.getPanZoomCanvas().setPanningEnabled(t)},l.prototype.IsDragSupported=function(){if(!this._isDragSupported){var t=this._diagram.getOptions();this._isDragSupported=this.isDndSupported()&&(t.dnd.drag.nodes.dataTypes||t.dnd.drag.ports.dataTypes)}return this._isDragSupported},l.prototype.OnMouseDown=function(t){var e=this.GetLogicalObject(t.target);this.IsDragSupported()&&e instanceof u&&this._setPanningEnabled(!1),l.superclass.OnMouseDown.call(this,t)},l.prototype.OnMouseUp=function(t){l.superclass.OnMouseUp.call(this,t),this._setPanningEnabled(!0)},l.prototype.HandleImmediateTouchStartInternal=function(t){var e=this.GetLogicalObject(t.target);this.IsDragSupported()&&1==t.targetTouches.length&&e instanceof u&&this._setPanningEnabled(!1),(e instanceof u||e instanceof g)&&e.handleTouchStart(),this._diagram.handleTouchStart()},l.prototype.HandleImmediateTouchEndInternal=function(t){var e=this.GetLogicalObject(t.target);this.IsDragSupported()&&this._setPanningEnabled(!0),(e instanceof u||e instanceof g)&&e.handleTouchEnd(),this._diagram.handleTouchEnd()},l.prototype.GetDropTargetType=function(t){var e,n=this.GetLogicalObject(t.target);return this._diagram.getCache().putToCache("dropTarget",n),n?n instanceof u?(null===this._linkDropSelector&&(this._linkDropSelector=this._diagram.getOptions().dnd.drop.ports.selector),this._linkDropSelector&&(e=this._getPortElement(t.getNativeEvent().target,this._linkDropSelector)),n.__dropPort=e,e?"ports":"nodes"):n instanceof g?"links":null:"background"},l.prototype.GetDropEventPayload=function(e){var n=e.getNativeEvent().dataTransfer,i=Number(n.getData(t.EventManager.DROP_OFFSET_X_DATA_TYPE))||0,o=Number(n.getData(t.EventManager.DROP_OFFSET_Y_DATA_TYPE))||0,a=this._diagram.getPanZoomCanvas().getContentPane().stageToLocal(this.getCtx().pageToStageCoords(e.pageX,e.pageY)),s=this._diagram.getLayoutOffset(),r={x:a.x-s.x+i,y:a.y-s.y+o},d=this.GetLogicalObject(e.target);if(d instanceof u){d.__dropPort?(r.dataContext=d.getDataContext(),r.portElement=d.__dropPort):r.nodeContext=d.getDataContext();var l=d.getDimensions(this._context.getStage()),h=l?this._diagram.getPanZoomCanvas().getContentPane().stageToLocal({x:l.x,y:l.y}):null;r.nodeX=h?a.x-h.x+i:null,r.nodeY=h?a.y-h.y+o:null}else d instanceof g&&(r.linkContext=d.getDataContext());return r},l.prototype.ShowDropEffect=function(e){var n=this.GetDropTargetType(e),i=this._diagram.getCache().getFromCache("dropTarget");"background"===n?this._diagram.getPanZoomCanvas().getBackgroundPane().setClassName("oj-active-drop"):"nodes"===n||"links"===n?i&&i.ShowDropEffect&&i.ShowDropEffect():i&&"ports"===n&&i.__dropPort&&t.ToolkitUtils.addClassName(i.__dropPort,"oj-active-drop")},l.prototype.ShowRejectedDropEffect=function(e){var n=this.GetDropTargetType(e),i=this._diagram.getCache().getFromCache("dropTarget");"background"===n?this._diagram.getPanZoomCanvas().getBackgroundPane().setClassName("oj-invalid-drop"):"nodes"===n||"links"===n?i&&i.ShowRejectedDropEffect&&i.ShowRejectedDropEffect():i&&"ports"===n&&i.__dropPort&&t.ToolkitUtils.addClassName(i.__dropPort,"oj-invalid-drop")},l.prototype.ClearDropEffect=function(){this._diagram.getPanZoomCanvas().getBackgroundPane().setClassName(null);var e=this._diagram.getCache().getFromCache("dropTarget");e&&e.ClearDropEffect&&e.ClearDropEffect(),e&&e.__dropPort&&(t.ToolkitUtils.removeClassName(e.__dropPort,"oj-active-drop"),t.ToolkitUtils.removeClassName(e.__dropPort,"oj-invalid-drop")),this._diagram.getCache().putToCache("dropTarget",null)},l.prototype._getPortElement=function(t,e){return t&&t.closest?t.closest(e):null};
/**
   * @license
   * Copyright (c) 2011 %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var h=function(t,e){this.Init(t,e)};t.Obj.createSubclass(h,t.BaseDiagramKeyboardHandler,"DvtDiagramKeyboardHandler"),h.prototype.isNavigationEvent=function(e){var n=!1;switch(e.keyCode){case t.KeyboardEvent.OPEN_BRACKET:case t.KeyboardEvent.CLOSE_BRACKET:n=!0;break;case t.KeyboardEvent.OPEN_ANGLED_BRACKET:case t.KeyboardEvent.CLOSE_ANGLED_BRACKET:n=!!e.altKey;break;default:n=h.superclass.isNavigationEvent.call(this,e)}return n},h.prototype.processKeyDown=function(e){if(e.keyCode==t.KeyboardEvent.TAB){var n=this._eventManager.getFocus();if(n)return t.EventManager.consumeEvent(e),n;var i=this.GetDiagram().GetRootNodeObjects();if(i.length>0){t.EventManager.consumeEvent(e);var o=this.getDefaultNavigable(i);return this.GetDiagram().ensureObjInViewport(e,o),o}}return h.superclass.processKeyDown.call(this,e)},h.prototype.GetVisibleNode=function(t){return this.GetDiagram().getNodeById(t)};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var g=function(t,e,n,i){this.Init(t,e,n,i)};t.Obj.createSubclass(g,t.BaseDiagramLink,"DvtDiagramLink"),g.CUSTOM_STYLE="customStyle",g.newInstance=function(t,e,n){return new g(t.getCtx(),t,e,n)},g.prototype.Init=function(e,n,i,o){g.superclass.Init.call(this,e,i.id,n),this._data=i,this._isHighlighted=!0,this._hasContentBoundToTouchEvent=!1,this._contentStoredInTouchEventContainer=null,this.setPromoted(o),this.isSelectable()&&this.setCursor(t.SelectionEffectUtils.getSelectingCursor()),this.setGroupId(g._getCommonAncestorId(this,n))},g.prototype.getData=function(){return this._data},g.prototype.setData=function(t){this._data=t},g.prototype.getId=function(){return this.getData().id},g.prototype.getStartId=function(){return this.getData().startNode},g.prototype.getEndId=function(){return this.getData().endNode},g.prototype.getLabelBounds=function(){var t=null;return this._labelObj&&(t=this._labelObj.getDimensions()),t},g.prototype.getLinkStyle=function(){return this.getData().svgStyle||this.getData().style},g.prototype.getLinkWidth=function(){return this.getData().width},g.prototype.getLinkColor=function(){return this.getData().color},g.prototype.getStartConnectorType=function(){return this.getData().startConnectorType},g.prototype.getEndConnectorType=function(){return this.getData().endConnectorType},g.prototype.getStartConnectorOffset=function(){return this.getStartConnectorType()?t.DiagramLinkConnectorUtils.getStandardConnectorOffset(this.getStartConnectorType(),this.GetAppliedLinkWidth(),this.GetAppliedLinkWidth()):0},g.prototype.getEndConnectorOffset=function(){return this.getEndConnectorType()?t.DiagramLinkConnectorUtils.getStandardConnectorOffset(this.getEndConnectorType(),this.GetAppliedLinkWidth(),this.GetAppliedLinkWidth()):0},g.prototype.render=function(){var e=this.GetDiagram(),n=this.getGroupId(),i=e.getNodeById(this.getStartId()).getGroupId(),o=e.getNodeById(this.getEndId()).getGroupId();if(n){var a=this.getCtx(),s=e.getNodeById(n).GetChildNodePane();t.BaseDiagram.compareValues(a,n,i)&&t.BaseDiagram.compareValues(a,n,o)?s.addChildAt(this,0):s.addChild(this)}else i||o?e.getNodesPane().addChild(this):e.getLinksPane().addChild(this);g._renderLinkLabels(e,this.getData(),this),this.setAriaRole("img"),this.UpdateAriaLabel(),this._diagram.getEventManager().associate(this,this)},g.prototype.setPoints=function(t){var e=this.GetDiagram(),n=this._getCustomRenderer("renderer");n?(this._customPoints=t,this._applyCustomLinkContent(n,this._getState(),null)):(!this._pathCmds&&t&&g._renderLinkShape(e,this.getData(),this),g.superclass.setPoints.call(this,t))},g.prototype._getState=function(){return{hovered:this._isShowingHoverEffect,selected:this.isSelected(),focused:this._isShowingKeyboardFocusEffect}},g.prototype._applyCustomLinkContent=function(e,n,i){var o=this._diagram.getOptions()._contextHandler;if(o){var a=e(o(this.isPromoted()?"promotedLink":"link",this.getElem(),this._customLinkContent,null,this.getDataContext(),n,i,this._customPoints));if(a||!this._customLinkContent){var s=g._processLinkContent(a);if(this._customLinkContent&&s!=this._customLinkContent)this._checkAndMoveContents()||(this._customLinkContent.namespaceURI===t.ToolkitUtils.SVG_NS?this.getContainerElem().removeChild(this._customLinkContent):Array.isArray(this._customLinkContent)&&this._customLinkContent.forEach(function(t){this.getContainerElem().removeChild(t)}.bind(this))),this._customLinkContent=null;s===this._contentStoredInTouchEventContainer&&(this._hasContentBoundToTouchEvent=!0),this._customLinkContent||(s&&s.namespaceURI===t.ToolkitUtils.SVG_NS?(g._insertCustomElem(this,s,this._labelObj),this._customLinkContent=s):s&&Array.isArray(s)?(s.forEach(function(t){g._insertCustomElem(this,t,this._labelObj)}.bind(this)),this._customLinkContent=s):this._diagram.Log("dvt.Diagram: could not add custom link content for the link "+this.getId()+a,1)),g._fixLinkPath(this)}}else this._diagram.Log("dvt.Diagram: could not add custom link content - context handler is undefined",1)},g._renderLinkShape=function(e,n,i){var o=i._pathCmds;o||(o=["M",0,0,"L",0,0]);var a=n.id,s=n.color,r=n.width,d=n.svgStyle||n.style,l=t.CSSStyle.toNumber(n._hitDetectionOffset);i._hitDetectionUnderlay=i.CreateUnderlay("#000000",0,l),i.addChildAt(i._hitDetectionUnderlay,0);var h,u=new t.Path(i.getCtx(),o,a),c=n.svgClassName||n.className;if(u.setFill(null),u.setClassName(c),i.getCtx().isCustomElement())u.setStyle(d);else if(d&&d instanceof Object){d._type==g.CUSTOM_STYLE&&d.strokeDasharray&&(d.strokeDasharray=t.DiagramLinkUtils.processStrokeDashArray(d.strokeDasharray)),h={dashArray:d.strokeDasharray,dashOffset:d.strokeDashoffset};var p=t.JsonUtils.clone(d);["_type","strokeDasharray","strokeDashoffset"].forEach((function(t){delete p[t]})),u.setStyle(p)}else"solid"!==d&&(h={dashArray:t.DiagramLinkUtils.GetStrokeDash(d),dashOffset:t.DiagramLinkUtils.GetStrokeDashOffset(d)});var m=new t.Stroke(s,1,r,!0,h);u.setStroke(m),i.setShape(u),i.addChildAt(u,1)},g._renderLinkLabels=function(e,n,i){var o=n.label;if(o){var a=t.Agent.isRightToLeft(e.getCtx()),s=o.indexOf("\n")>0,r=s?a?t.MultilineText.H_ALIGN_RIGHT:t.MultilineText.H_ALIGN_LEFT:a?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT,d=s?t.MultilineText.V_ALIGN_TOP:t.OutputText.V_ALIGN_TOP,l=g.createText(e.getCtx(),o,n.labelStyle,r,d,s),h=n.labelStyle.getMaxWidth()||n.labelStyle.getWidth(),u=t.CSSStyle.toNumber(h);h?u>0&&t.TextUtils.fitText(l,u,1/0,i)&&(i._labelObj=l):(i.addChild(l),i._labelObj=l)}},g.createText=function(e,n,i,o,a,s){var r;return i.hasBackgroundStyles()?r=s?new t.BackgroundMultilineText(e,n,0,0,i,null,!0):new t.BackgroundOutputText(e,n,0,0,i):(r=s?new t.MultilineText(e,n,0,0,null,!0):new t.OutputText(e,n,0,0)).setCSSStyle(i),r.setHorizAlignment(o),r.setVertAlignment(a),r},g.prototype.setSelected=function(t){var e=this._getState();g.superclass.setSelected.call(this,t);var n=this._getCustomRenderer("selectionRenderer");n?this._applyCustomLinkContent(n,this._getState(),e):t?this._showFeedback(this._isShowingHoverEffect,!0):this._hideFeedback(),this.UpdateAriaLabel()},g.prototype.isSelectable=function(){return this.GetDiagram().isSelectionSupported()&&"off"!=this.getData().selectable},g.prototype._showFeedback=function(e,n){if(e){this._savedStroke||(this._savedStroke=this.getShape().getStroke());var i=this.getShape().getStroke(),o=new t.Stroke(this.getData().hoverInnerColor,i.getAlpha(),i.getWidth(),i.isFixedWidth(),i.getDashProps());this.getShape().setStroke(o),this.ReplaceConnectorColor(this.getStartConnector(),o),this.ReplaceConnectorColor(this.getEndConnector(),o)}else this._savedStroke&&(this.getShape().setStroke(this._savedStroke),this.ReplaceConnectorColor(this.getStartConnector(),this._savedStroke),this.ReplaceConnectorColor(this.getEndConnector(),this._savedStroke),this._savedStroke=null);this._linkUnderlay||(this._linkUnderlay=this.CreateFeedbackUnderlay("#000000",1,0,this.getData().svgStyle,this.getData().svgClassName),this.addChildAt(this._linkUnderlay,0));var a=n?this.getData().selectionColor:this.getData().hoverOuterColor,s=this._linkUnderlay.getStroke(),r=2+this.GetAppliedLinkWidth(),d=this.GetStyledLinkStroke(s,a,r);this._linkUnderlay.setStroke(d,2)},g.prototype._hideFeedback=function(){this._savedStroke&&(this.getShape().setStroke(this._savedStroke),this.ReplaceConnectorColor(this.getStartConnector(),this._savedStroke),this.ReplaceConnectorColor(this.getEndConnector(),this._savedStroke),this._savedStroke=null),this._linkUnderlay&&(this.removeChild(this._linkUnderlay),this._linkUnderlay.destroy&&this._linkUnderlay.destroy(),this._linkUnderlay=null)},g.prototype.GetStyledLinkStroke=function(e,n,i){if(this.getCtx().isCustomElement())return new t.Stroke(n,e.getAlpha(),i,e.isFixedWidth());var o=this.GetAppliedLinkStyle();if(o&&o instanceof Object){var a,s=o._type;if(s==g.CUSTOM_STYLE){var r=null!=o.strokeDashoffset?t.CSSStyle.toNumber(o.strokeDashoffset)+1:1;a={dashArray:t.DiagramLinkUtils.getCustomUnderlay(o.strokeDasharray),dashOffset:r}}else a={dashArray:t.DiagramLinkUtils.GetStrokeDash(s,!0),dashOffset:t.DiagramLinkUtils.GetStrokeDashOffset(s,!0)};return new t.Stroke(n,e.getAlpha(),i,!0,a)}return g.superclass.GetStyledLinkStroke.call(this,e,n,i)},g.prototype.handleTouchStart=function(){this._hasContentBoundToTouchEvent=!0},g.prototype.handleTouchEnd=function(){this._hasContentBoundToTouchEvent=!1,this._contentStoredInTouchEventContainer=null},g.prototype.showHoverEffect=function(){if(!this._isShowingHoverEffect){var t=this._getState();this._isShowingHoverEffect=!0;var e=this._getCustomRenderer("hoverRenderer");e?this._applyCustomLinkContent(e,this._getState(),t):this._showFeedback(!0,this.isSelected())}},g.prototype.hideHoverEffect=function(){var t=this._getState();this._isShowingHoverEffect=!1;var e=this._getCustomRenderer("hoverRenderer");e?this._applyCustomLinkContent(e,this._getState(),t):this.isSelected()?this._showFeedback(!1,!0):this._hideFeedback()},g.prototype.highlight=function(t){if(this._isHighlighted!==t){var e=t?1:this._diagram.getOptions().styleDefaults._highlightAlpha;this.setAlpha(e),this._isHighlighted=t}},g.prototype.getDatatip=function(t,e,n){var i=this.GetDiagram().getOptions().tooltip,o=i?i.renderer:null;return o?this.GetDiagram().getCtx().getTooltipManager().getCustomTooltip(o,this.getDataContext()):this.getShortDesc()},g.prototype.getShortDesc=function(){var e=this.GetDiagram().getOptions().translations;if(this.isPromoted()){var n=this.getData()._links.length;return t.ResourceUtils.format(e[n>1?"promotedLinks":"promotedLink"],[n])}return this.getData().shortDesc},g.prototype.getDataContext=function(){var t,e;this.GetDiagram().isDataProviderMode()?this.isPromoted()?(t=this.getData()._links.map((function(t){return t._itemData})),e=this.getData()._links[0]._noTemplate?t:this.getData()._links):(e=this.getData(),t=this.getData()._itemData):e=this.isPromoted()?this.getData()._links:this.getData()._itemData;var n={id:this.getId(),type:this.isPromoted()?"promotedLink":"link",label:this.getData().label,data:e,itemData:t,component:this.GetDiagram().getOptions()._widgetConstructor};return this.getCtx().fixRendererContext(n)},g.prototype.getAriaLabel=function(){var e=[],n=this.GetDiagram().getOptions().translations;return this.isSelectable()&&e.push(n[this.isSelected()?"stateSelected":"stateUnselected"]),this.isPromoted()&&e.push(n.promotedLinkAriaDesc),t.Displayable.generateAriaLabel(this.getShortDesc(),e)},g.prototype.UpdateAriaLabel=function(){if(!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();e&&this.setAriaProperty("label",e)}},g.prototype.getNextNavigable=function(e){if(e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey)return this;if(e.keyCode==t.KeyboardEvent.UP_ARROW||e.keyCode==t.KeyboardEvent.DOWN_ARROW){(s=this.getKeyboardFocusNode())||(s=this.GetDiagram().getNodeById(this.getStartId()));var n=this,i=this.GetDiagram().getNavigableLinksForNodeId(s.getId()),o=this.GetDiagram().getEventManager().getKeyboardHandler();return o&&o.getNextNavigableLink&&(n=o.getNextNavigableLink(s,this,e,i)),n.setKeyboardFocusNode(s),this._diagram.ensureObjInViewport(e,n),n}if(e.keyCode==t.KeyboardEvent.RIGHT_ARROW||e.keyCode==t.KeyboardEvent.LEFT_ARROW){var a;a=this._movingToStart(e.keyCode)?this.getStartId():this.getEndId();var s=this.GetDiagram().getNodeById(a);return this._diagram.ensureObjInViewport(e,s),s}return e.type==t.MouseEvent.CLICK?this:null},g.prototype._movingToStart=function(e){var n=this.getLinkStart(),i=this.getLinkEnd(),o=n.x<i.x;return!(e==t.KeyboardEvent.RIGHT_ARROW&&o||e==t.KeyboardEvent.LEFT_ARROW&&!o)},g.prototype.showKeyboardFocusEffect=function(){var t=this._getState();this._isShowingKeyboardFocusEffect=!0;var e=this._getCustomRenderer("focusRenderer");e?this._applyCustomLinkContent(e,this._getState(),t):this.showHoverEffect()},g.prototype.hideKeyboardFocusEffect=function(){var t=this._getState();this._isShowingKeyboardFocusEffect=!1;var e=this._getCustomRenderer("focusRenderer");e?this._applyCustomLinkContent(e,this._getState(),t):this.hideHoverEffect()},g.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect},g.prototype.getCategories=function(){return this.getData().categories?this.getData().categories:[this.getId()]},g.prototype.isHidden=function(){var e=this.GetDiagram().getOptions().hiddenCategories;return!(!e||!t.ArrayUtils.hasAnyItem(e,this.getCategories()))||(!this.GetDiagram().getNodeById(this.getStartId())||!this.GetDiagram().getNodeById(this.getEndId()))},g.prototype.animateUpdate=function(e,n,i){var o=n.getPoints(),a=this.getPoints(),s=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration());if(!t.ArrayUtils.equals(o,a)){this.setPoints(o);var r=t.Animator.TYPE_POLYLINE;a.length>0&&isNaN(a[0])&&(r=t.Animator.TYPE_PATH),s.getAnimator().addProp(r,this,this.getPoints,this.setPoints,a)}if(n._labelObj&&this._labelObj){var l=n._labelObj.getMatrix(),h=this._labelObj.getMatrix();l.equals(h)||(this._labelObj.setMatrix(l),s.getAnimator().addProp(t.Animator.TYPE_MATRIX,this._labelObj,this._labelObj.getMatrix,this._labelObj.setMatrix,h))}if(n.getShape()&&this.getShape()){var u=n.getShape().getStroke(),c=this.getShape().getStroke();u&&c&&u instanceof t.Stroke&&c instanceof t.Stroke&&(u.getColor()!=c.getColor()||u.getWidth()!=c.getWidth())&&(this.getShape().setStroke(u),s.getAnimator().addProp(t.Animator.TYPE_STROKE,this.getShape(),this.getShape().getStroke,this.getShape().setStroke,c))}var p=n.getTranslateX(),m=n.getTranslateY(),_=this.getTranslateX(),f=this.getTranslateY();if(p!=_&&(this.setTranslateX(p),s.getAnimator().addProp(t.Animator.TYPE_NUMBER,this,this.getTranslateX,this.setTranslateX,_)),m!=f&&(this.setTranslateY(m),s.getAnimator().addProp(t.Animator.TYPE_NUMBER,this,this.getTranslateY,this.setTranslateY,f)),this._getCustomRenderer("renderer")){var y=n.getContainerElem().querySelector(".oj-diagram-link-path"),C=this.getContainerElem().querySelector(".oj-diagram-link-path");if(y&&C){o=t.ToolkitUtils.getAttrNullNS(y,"d"),a=t.ToolkitUtils.getAttrNullNS(C,"d");t.ToolkitUtils.setAttrNullNS(C,"d",o);s.getAnimator().addProp(t.Animator.TYPE_PATH,C,(function(e){var n=t.ToolkitUtils.getAttrNullNS(C,"d");return t.PathUtils.createPathArray(n)}),(function(e){t.ToolkitUtils.setAttrNullNS(C,"d",e.join(" "))}),t.PathUtils.createPathArray(a))}for(var v=g._getFadeInCustomItems(this._customLinkContent,C,y),D=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration()),S=0;S<v.length;S++){var b=v[S];t.ToolkitUtils.setAttrNullNS(b,"opacity","0");var k=function(e){t.ToolkitUtils.setAttrNullNS(this,"opacity",e)}.bind(b),L=function(){var e=t.ToolkitUtils.getAttrNullNS(this,"opacity");return Number(e)}.bind(b);D.getAnimator().addProp(t.Animator.TYPE_NUMBER,b,L,k,1)}e.add(D,d.INSERT)}if(i){var N=this;t.Playable.appendOnEnd(s,(function(){N.getParent().removeChild(N)}))}e.add(s,d.UPDATE)},g.prototype.animateDelete=function(e,n){this.GetDiagram().getLinksPane().addChild(this);var i=this,o=new t.AnimFadeOut(this.getCtx(),this,e.getAnimationDuration());t.Playable.appendOnEnd(o,(function(){i.getParent().removeChild(i),i.destroy()})),e.add(o,d.DELETE)},g.prototype.animateInsert=function(e){this.setAlpha(0),e.add(new t.AnimFadeIn(this.getCtx(),this,e.getAnimationDuration()),d.INSERT)},g.prototype.animateCollapse=function(e,n){if(n&&0!=n.length){var i=this._customPoints?this._customPoints:this.getPoints();Array.isArray(i)&&(i=i.slice());var o=this.getTranslateX(),a=this.getTranslateY();this.animateUpdate(e,n[0]);for(var s=1;s<n.length;s++){var r={id:"_fakeLink"+s+this.getId()};r=t.JsonUtils.merge(r,this.getData());var d=new g(this.GetDiagram().getCtx(),this.GetDiagram(),r,!0);d.render(),d.setPoints(i),d.setTranslate(o,a),d.animateUpdate(e,n[s],!0)}}},g.prototype.animateExpand=function(t,e){if(e&&0!=e.length)for(var n=0;n<e.length;n++)e[n].animateUpdate(t,this)},g.prototype.setLabelAlignments=function(e,n){var i=this._labelObj instanceof t.MultilineText||this._labelObj instanceof t.BackgroundMultilineText;"baseline"==n&&(n=i?t.MultilineText.V_ALIGN_TOP:t.OutputText.V_ALIGN_AUTO),this._labelObj.setHorizAlignment(e),this._labelObj.setVertAlignment(n)},g.prototype.setGroupId=function(t){this._groupId=t},g.prototype.getGroupId=function(){return this._groupId},g._getCommonAncestorId=function(t,e){for(var n=function(t,e){for(var n=[],i=e.getNodeById(t)?e.getNodeById(t).getGroupId():null;i;)n.push(i),i=e.getNodeById(i)?e.getNodeById(i).getGroupId():null;return n},i=n(t.getStartId(),e),o=n(t.getEndId(),e),a=0;a<i.length;a++)if(o.indexOf(i[a])>-1)return i[a];return null},g.GetPromotedLinkId=function(t,e,n){return t.isDataProviderMode()?{name:"_promoted",startId:e,endId:n}:"_plL"+e+"_L"+n},g.prototype.ShowDropEffect=function(){this._dropEffect||this._createDropEffect("oj-diagram-link oj-active-drop")},g.prototype.ShowRejectedDropEffect=function(){this._dropEffect||this._createDropEffect("oj-diagram-link oj-invalid-drop")},g.prototype.ClearDropEffect=function(){this._dropEffect&&(this.removeChild(this._dropEffect),this._dropEffect=null)},g.prototype._createDropEffect=function(e){var n=t.CSSStyle.toNumber(this.getData()._hitDetectionOffset);this._dropEffect=this.CreateFeedbackUnderlay("#000000",0,n,null,e),this._dropEffect.setMouseEnabled(!1),this.addChild(this._dropEffect)},g.ConvertLinkData=function(t){return{id:t.id,startNode:t.startNode,endNode:t.endNode,label:t.label,selectable:t.selectable,shortDesc:t.shortDesc,categories:t.categories,_itemData:t}},g.prototype.getAnimationState=function(){var t,e,n;this._labelObj&&((t={matrix:this._labelObj.getMatrix()}).getMatrix=function(){return t.matrix}),this.getShape()&&((e={stroke:this.getShape().getStroke()}).getStroke=function(){return e.stroke});var i=this.isPromoted()?this.getData()._links:null;return(n={partialUpdate:!0,id:this.getId(),promoted:this.isPromoted(),includedLinks:i,points:this.getPoints(),shape:e,_labelObj:t}).getId=function(){return n.id},n.isPromoted=function(){return n.promoted},n.getData=function(){return{_links:n.includedLinks}},n.getPoints=function(){return n.points},n.getShape=function(){return n.shape},n},g._fixLinkPath=function(e){var n=e.getContainerElem().querySelector(".oj-diagram-link-path");if(n){var i=e._customPoints,o=t.DiagramLinkUtils.IsPath(i)?i:t.DiagramLinkUtils.ConvertToPath(i);n.setAttributeNS(null,"d",t.PathUtils.getPathString(o))}},g._getFadeInCustomItems=function(t,e,n){var i,o=[];if(e&&n){var a=t;Array.isArray(t)&&t.forEach((function(t){t.contains(e)?a=t:o.push(t)}));for(var s=e;s!==a;)o=o.concat(function(t,e){for(var n=[];t;)1===t.nodeType&&t!==e&&n.push(t),t=t.nextSibling;return n}((i=s).parentNode.firstChild,i)),s=s.parentNode}else t&&(o=Array.isArray(t)?t:[t]);return o},g._insertCustomElem=function(t,e,n){var i=n?n.getOuterElem():null;t&&t.getContainerElem().insertBefore(e,i)},g.prototype._getCustomRenderer=function(t){var e=this._diagram.getOptions().linkContent,n=null;if(e){var i=e.renderer;n=e[t],n=i&&n?n:i}return n},g.prototype.GetCreationFeedbackPoints=function(t){var e=this._customPoints?this._customPoints:this.getPoints();return[e[0],e[1],t.x,t.y]},g._processLinkContent=function(e){var n=null;if(e.namespaceURI===t.ToolkitUtils.SVG_NS&&"svg"===e.tagName)n=[],Array.prototype.forEach.call(e.childNodes,(function(t){n.push(t)}));else if(e.namespaceURI===t.ToolkitUtils.SVG_NS)n=e;else if(Array.isArray(e)){n=[];for(var i=0;i<e.length;i++){if(e[i].namespaceURI===t.ToolkitUtils.SVG_NS&&"svg"===e[i].tagName){Array.prototype.forEach.call(e[i].childNodes,(function(t){n.push(t)}));break}e[i].namespaceURI===t.ToolkitUtils.SVG_NS&&n.push(e[i])}}return Array.isArray(n)&&0===n.length?null:n},g.prototype._checkAndMoveContents=function(){return!!this._hasContentBoundToTouchEvent&&(this.GetDiagram().storeTouchEventContent(this._customLinkContent,this),this._contentStoredInTouchEventContainer=this._customLinkContent,this._hasContentBoundToTouchEvent=!1,!0)};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var u=function(t,e,n){this.Init(t,e,n)};t.Obj.createSubclass(u,t.BaseDiagramNode,"DvtDiagramNode"),u.newInstance=function(t,e){return new u(t.getCtx(),t,e)},u.prototype.Init=function(e,n,i){u.superclass.Init.call(this,e,i.id,n),this._data=i,this._isHighlighted=!0,this._hasContentBoundToTouchEvent=!1,this._contentStoredInTouchEventContainer=null,this.isSelectable()&&this.setCursor(t.SelectionEffectUtils.getSelectingCursor())},u.prototype.getData=function(){return this._data},u.prototype.setData=function(t){this._data=t},u.prototype.getId=function(){return this._data.id},u.prototype.getContentBounds=function(t){return!this._contentDims&&t&&(this._contentDims=this._calcContentDims()),this._contentDims},u.prototype.getLabelBounds=function(t){var e=null;return this._labelObj&&t&&(e=this._labelObj.getDimensions()),e},u.prototype.setSelected=function(t){var e=this._getState();u.superclass.setSelected.call(this,t);var n=this._getCustomRenderer("selectionRenderer");n?this._applyCustomNodeContent(n,this._getState(),e):this.processDefaultSelectionEffect(t),this.UpdateAriaLabel()},u.prototype.processDefaultSelectionEffect=function(t){this.getSelectionShape()&&this.getSelectionShape().setSelected(t)},u.prototype.isSelectable=function(){return this.GetDiagram().isSelectionSupported()&&"off"!=this.getData().selectable},u.prototype.GetIcon=function(){return this._shape},u.prototype.render=function(){this._cleanUp();var t=this.getData(),e=this._getCustomRenderer("renderer");if(e){if(this._applyCustomNodeContent(e,this._getState(),null),this.isDisclosed()){var n=this.GetDiagram().getPanZoomCanvas().getZoom(),i=this.getElem().getBoundingClientRect(),o=this._childNodePane?this._childNodePane.getElem().getBoundingClientRect():null;this._containerPadding={left:(o.left-i.left)/n,right:(i.right-o.right)/n,top:(o.top-i.top)/n,bottom:(i.bottom-o.bottom)/n}}this._selectionShape&&(this.removeChild(this._selectionShape),this._selectionShape=null)}else this.isDisclosed()?u._renderContainer(this._diagram,t,this):(u._renderNodeBackground(this._diagram,t,this),u._renderNodeIcon(this._diagram,t,this)),u._addHoverSelectionDefaultStrokes(this.getSelectionShape(),t);u._renderNodeLabels(this._diagram,t,this),this._setDraggableStyleClass(),u._renderContainerButton(this._diagram,t,this),this.setAriaRole("img"),this.UpdateAriaLabel(),this._diagram.getEventManager().associate(this,this)},u.prototype._applyCustomNodeContent=function(e,n,i){var o=this._diagram.getOptions()._contextHandler;if(o){var a=this.getDataContext(),s=null;if(this.isDisclosed()){var r=this.GetChildNodePane(),d=r.getDimensions();s={element:r.getElem(),w:d?d.w-d.x:null,h:d?d.h-d.y:null}}var l=e(o("node",this.getElem(),this._customNodeContent,s,a,n,i));if(l||!this._customNodeContent||!this.getCtx().isCustomElement()){if(this._customNodeContent&&l!=this._customNodeContent)this._checkAndMoveContents()||(this._customNodeContent.namespaceURI===t.ToolkitUtils.SVG_NS?this.getContainerElem().removeChild(this._customNodeContent):Array.isArray(this._customNodeContent)?this._customNodeContent.forEach(function(t){this.getContainerElem().removeChild(t)}.bind(this)):this.removeChild(l)),this._customNodeContent=null;l===this._contentStoredInTouchEventContainer&&(this._hasContentBoundToTouchEvent=!0),l&&l.namespaceURI===t.ToolkitUtils.SVG_NS?this._customNodeContent||(t.ToolkitUtils.appendChildElem(this.getContainerElem(),l),this._customNodeContent=l):l&&Array.isArray(l)?this._customNodeContent||(l.forEach(function(e){t.ToolkitUtils.appendChildElem(this.getContainerElem(),e)}.bind(this)),this._customNodeContent=l):l instanceof t.BaseComponent?this._customNodeContent||(this.addChild(l),this._customNodeContent=l):l&&this._diagram.Log("dvt.Diagram: could not add custom node content for the node "+this.getId()+l,1)}}else this._diagram.Log("dvt.Diagram: could not add custom node content - context handler is undefined",1)},u._renderNodeBackground=function(e,n,i){if(!e.getCtx().isCustomElement()){var o=n.backgroundSvgStyle||n.backgroundStyle,a=t.JsonUtils.clone(o),s=[t.CSSStyle.WIDTH,t.CSSStyle.HEIGHT,t.CSSStyle.BACKGROUND_COLOR,t.CSSStyle.BORDER_COLOR,t.CSSStyle.BORDER_WIDTH,t.CSSStyle.BORDER_RADIUS];if(!(o=u._getNodeCSSStyle(a,n._backgroundStyle,s)).isEmpty()){var r=t.CSSStyle.toNumber(o.getStyle(t.CSSStyle.WIDTH)),d=t.CSSStyle.toNumber(o.getStyle(t.CSSStyle.HEIGHT)),l=o.getStyle(t.CSSStyle.BACKGROUND_COLOR),h=o.getStyle(t.CSSStyle.BORDER_COLOR),g=t.CSSStyle.toNumber(o.getStyle(t.CSSStyle.BORDER_WIDTH)),c=t.CSSStyle.toNumber(o.getStyle(t.CSSStyle.BORDER_RADIUS)),p=new t.Rect(e.getCtx(),0,0,r,d);p.setSolidFill(l),c&&(p.setRx(c),p.setRy(c)),h&&p.setStroke(new t.Stroke(h,1,g)),a&&s.forEach((function(e){delete a[t.CSSStyle.cssStringToObjectProperty(e)]}));var m=n.backgroundSvgClassName||n.backgroundClassName;p.setStyle(a).setClassName(m),i.addChild(p),i.setSelectionShape(p),i._background=p}}},u._renderNodeIcon=function(e,n,i){var o=n.icon;if(o){var a,s=o.width,r=o.height,d=o.color,l=o.borderRadius;a=o.source?new t.ImageMarker(e.getCtx(),s/2,r/2,s,r,l,o.source,o.sourceSelected,o.sourceHover,o.sourceHoverSelected):new t.SimpleMarker(e.getCtx(),o.shape,s/2,r/2,s,r,l),"none"!=o.fillPattern?a.setFill(new t.PatternFill(o.fillPattern,d,d)):a.setSolidFill(d),null!=o.opacity&&a.setAlpha(o.opacity),o.borderColor&&a.setStroke(new t.Stroke(o.borderColor,1,o.borderWidth));var h=o.svgStyle||o.style,g=o.svgClassName||o.className;a.setStyle(h).setClassName(g),i.addChild(a),i._shape=a,u._setIconPosition(e,n,i),i._background||i.setSelectionShape(a)}},u._setIconPosition=function(e,n,i){if(i._background){var o=n.icon,a=i._background.getWidth(),s=i._background.getHeight(),r=o.width,d=o.height,l=.5*(a-r),h=.5*(s-d);if(void 0!==o.positionX)l=parseFloat(o.positionX),t.Agent.isRightToLeft(i.getCtx())&&(l=a-l-r);else{var g=o.halign;"start"==g?g=t.Agent.isRightToLeft(i.getCtx())?"right":"left":"end"==g&&(g=t.Agent.isRightToLeft(i.getCtx())?"left":"right"),l="left"==g?0:"right"==g?a-r:l}void 0!==o.positionY?h=parseFloat(o.positionY):"top"==o.valign?h=0:"bottom"==o.valign&&(h=s-d),i._shape.setTranslate(l,h)}},u._renderNodeLabels=function(e,n,i){var o=n.label;if(o){var a=t.Agent.isRightToLeft(e.getCtx()),s=o.indexOf("\n")>0,r=s?a?t.MultilineText.H_ALIGN_RIGHT:t.MultilineText.H_ALIGN_LEFT:a?t.OutputText.H_ALIGN_RIGHT:t.OutputText.H_ALIGN_LEFT,d=s?t.MultilineText.V_ALIGN_TOP:t.OutputText.V_ALIGN_TOP,l=u.createText(e.getCtx(),o,n.labelStyle,r,d,s),h=n.labelStyle.getMaxWidth()||n.labelStyle.getWidth(),g=t.CSSStyle.toNumber(h);h?g>0&&t.TextUtils.fitText(l,g,1/0,i)&&(i._labelObj=l):(i.addChild(l),i._labelObj=l)}},u.createText=function(e,n,i,o,a,s){var r;return i.hasBackgroundStyles()?r=s?new t.BackgroundMultilineText(e,n,0,0,i,null,!0):new t.BackgroundOutputText(e,n,0,0,i):(r=s?new t.MultilineText(e,n,0,0,null,!0):new t.OutputText(e,n,0,0)).setCSSStyle(i),r.setHorizAlignment(o),r.setVertAlignment(a),r},u._addHoverSelectionDefaultStrokes=function(e,n){var i=n.hoverInnerColor,o=n.hoverOuterColor,a=n.selectionColor,s=new t.Stroke(i,1,4,!0),r=new t.Stroke(o,1,8,!0),d=new t.Stroke(i,1,2,!0),l=new t.Stroke(a,1,6,!0),h=new t.Stroke(i,1,4,!0),g=new t.Stroke(a,1,8,!0);e.setHoverStroke(s,r).setSelectedStroke(d,l).setSelectedHoverStroke(h,g)},u._addHoverSelectionOuterStrokes=function(e,n){var i=n.hoverInnerColor,o=n.hoverOuterColor,a=n.selectionColor,s=new t.Stroke(i,1,2,!0),r=new t.Stroke(o,1,2,!0),d=new t.Stroke(i,1,1,!0),l=new t.Stroke(a,1,2,!0),h=new t.Stroke(i,1,2,!0),g=new t.Stroke(a,1,2,!0);e.setHoverStroke(s,r).setSelectedStroke(d,l).setSelectedHoverStroke(h,g)},u.prototype.setSelectionShape=function(t){this._selectionShape=t},u.prototype.getSelectionShape=function(){if(!this._selectionShape){var e=this.getContentBounds(!0);if(e){var n=new t.Rect(this._diagram.getCtx(),e.x,e.y,e.w,e.h);n.setInvisibleFill(),n.setStrokeAlignment("outer"),this.setSelectionShape(n),this.addChildAt(n,0),u._addHoverSelectionOuterStrokes(n,this.getData()),this._selectionShape=n}}return this._selectionShape},u.prototype.handleTouchStart=function(){this._hasContentBoundToTouchEvent=!0},u.prototype.handleTouchEnd=function(){this._hasContentBoundToTouchEvent=!1,this._contentStoredInTouchEventContainer=null},u.prototype.showHoverEffect=function(){if(!this._isShowingHoverEffect){var t=this._getState();this._isShowingHoverEffect=!0;var e=this._getCustomRenderer("hoverRenderer");e?this._applyCustomNodeContent(e,this._getState(),t):this.processDefaultHoverEffect(!0)}},u.prototype.hideHoverEffect=function(){if(this._isShowingHoverEffect){var t=this._getState();this._isShowingHoverEffect=!1;var e=this._getCustomRenderer("hoverRenderer");e?this._applyCustomNodeContent(e,this._getState(),t):this.processDefaultHoverEffect(!1)}},u.prototype.processDefaultHoverEffect=function(t){this.getSelectionShape()&&(t?this.getSelectionShape().showHoverEffect():this.getSelectionShape().hideHoverEffect())},u.prototype.getDatatip=function(t,e,n){var i=this.GetDiagram().getOptions().tooltip,o=i?i.renderer:null;return o?this.GetDiagram().getCtx().getTooltipManager().getCustomTooltip(o,this.getDataContext()):this.getShortDesc()},u.prototype.getShortDesc=function(){return this.getData().shortDesc},u.prototype.getDataContext=function(){var t=this.getData(),e={id:this.getId(),type:"node",label:t.label,data:this.GetDiagram().isDataProviderMode()?t._noTemplate?t._itemData:t:t._itemData,itemData:this.GetDiagram().isDataProviderMode()?t._itemData:null,component:this.GetDiagram().getOptions()._widgetConstructor};return this.getCtx().fixRendererContext(e)},u.prototype.getAriaLabel=function(){var e=[],n=this.GetDiagram().getOptions().translations;return this.isSelectable()&&e.push(n[this.isSelected()?"stateSelected":"stateUnselected"]),this.isContainer()&&e.push(n[this.isDisclosed()?"stateExpanded":"stateCollapsed"]),t.Displayable.generateAriaLabel(this.getShortDesc(),e)},u.prototype.UpdateAriaLabel=function(){if(!t.Agent.deferAriaCreation()){var e=this.getAriaLabel();e&&this.setAriaProperty("label",e)}},u.prototype.getNextNavigable=function(e){var n=null;if(e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey)n=this;else if((e.keyCode==t.KeyboardEvent.OPEN_ANGLED_BRACKET||t.KeyboardEvent.CLOSE_ANGLED_BRACKET)&&e.altKey){var i=this.GetDiagram().getNavigableLinksForNodeId(this.getId()),o=this.GetDiagram().getEventManager().getKeyboardHandler();o&&o.getFirstNavigableLink&&(n=o.getFirstNavigableLink(this,e,i)),n?n.setKeyboardFocusNode(this):n=this}else if(e.keyCode==t.KeyboardEvent.OPEN_BRACKET){if(this.isDisclosed())n=this.getChildNodes()[0];else n=this}else if(e.keyCode==t.KeyboardEvent.CLOSE_BRACKET){n=(a=this.getGroupId()?this.GetDiagram().getNodeById(this.getGroupId()):null)||this}else if(e.type==t.MouseEvent.CLICK)n=this;else{var a,s=(a=this.getGroupId()?this.GetDiagram().getNodeById(this.getGroupId()):null)?a.getChildNodes():this.GetDiagram().GetRootNodeObjects();n=t.KeyboardHandler.getNextAdjacentNavigable(this,e,s)}return e instanceof t.KeyboardEvent&&this._diagram.ensureObjInViewport(e,n),n},u.prototype.HandleKeyboardEvent=function(e){e.keyCode==t.KeyboardEvent.SPACE&&e.ctrlKey&&e.shiftKey&&this.isContainer()&&this.GetDiagram().setNodeDisclosed(this.getId(),!this.isDisclosed())},u.prototype.isContainer=function(){if(this._diagram.isTreeDataProvider()){var t=this._diagram.getOptions().nodeData.getChildDataProvider(this.getId());return!!t&&"yes"!==t.isEmpty()}return!this._diagram.isDataProviderMode()&&0!=this.GetDiagram().getOptions().data.getChildCount(this.getData())},u.prototype.showKeyboardFocusEffect=function(){if(!this.isShowingKeyboardFocusEffect()){var t=this._getState();this._isShowingKeyboardFocusEffect=!0;var e=this._getCustomRenderer("focusRenderer");e?this._applyCustomNodeContent(e,this._getState(),t):this.processDefaultFocusEffect(!0)}},u.prototype.hideKeyboardFocusEffect=function(){if(this.isShowingKeyboardFocusEffect()){var t=this._getState();this._isShowingKeyboardFocusEffect=!1;var e=this._getCustomRenderer("focusRenderer");e?this._applyCustomNodeContent(e,this._getState(),t):this.processDefaultFocusEffect(!1)}},u.prototype.processDefaultFocusEffect=function(t){this.processDefaultHoverEffect(t)},u.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect},u.prototype.getCategories=function(){return this.getData().categories?this.getData().categories:[this.getId()]},u.prototype.isHidden=function(){var e=this.GetDiagram().getOptions().hiddenCategories;return!(!e||!t.ArrayUtils.hasAnyItem(e,this.getCategories()))},u.prototype._calcContentDims=function(){var e,n=null;if(this._customNodeContent)if(this._customNodeContent instanceof t.BaseComponent)(e=this._customNodeContent.getDimensions())&&(n=new t.Rectangle(e.x,e.y,e.w,e.h));else{var i=this._customNodeContent;if(Array.isArray(i))for(var o=0;o<i.length;o++)if(i[o].namespaceURI===t.ToolkitUtils.SVG_NS){i=i[o];break}(e=i.getBBox())&&(n=new t.Rectangle(e.x,e.y,e.width,e.height))}else this.isDisclosed()?n=this._containerShape.GetDimensionsWithStroke(this):(n=this._background?this._background.GetDimensionsWithStroke(this):null)&&this._shape?n=n.getUnion(this._shape.GetDimensionsWithStroke(this)):!n&&this._shape&&(n=this._shape.GetDimensionsWithStroke(this));return n},u.prototype.animateUpdate=function(e,n){var i=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration());if(this.isDisclosed()||n.isDisclosed())if(this.isDisclosed()&&n.isDisclosed()){if(n._labelObj&&this._labelObj){p=n._labelObj.getMatrix(),m=this._labelObj.getMatrix();p.equals(m)||(this._labelObj.setMatrix(p),i.getAnimator().addProp(t.Animator.TYPE_MATRIX,this._labelObj,this._labelObj.getMatrix,this._labelObj.setMatrix,m))}if(this._getCustomRenderer("renderer"))this._animateCustomUpdate(e,n);else{if(u._animatePosition(i,n,this),u._animateContainer(i,n._containerShape,this._containerShape),t.Agent.isRightToLeft(this.getCtx())&&n._containerButton&&this._containerButton){var o=n._containerButton.getTranslateX(),a=this._containerButton.getTranslateX();o!=a&&(this._containerButton.setTranslateX(o),i.getAnimator().addProp(t.Animator.TYPE_NUMBER,this._containerButton,this._containerButton.getTranslateX,this._containerButton.setTranslateX,a))}if(!n.partialUpdate){for(var s=[],r=[],l=this.getChildNodeIds(),h=0;h<l.length;h++)s.push(this.GetDiagram().getNodeById(l[h]));var g=n.getChildNodeIds(),c=e.getOldDiagram().NodesMap;for(h=0;h<g.length;h++)r.push(c.get(g[h]));e.constructAnimation(r,s)}}}else this._animateCustomUpdate(e,n);else{if(u._animatePosition(i,n,this),n._shape&&this._shape&&(i.getAnimator().addProp(t.Animator.TYPE_RECTANGLE,this._shape,this._shape.getCenterDimensions,this._shape.setCenterDimensions,this._shape.getCenterDimensions()),this._shape.setCenterDimensions(n._shape.getCenterDimensions())),n._labelObj&&this._labelObj){var p=n._labelObj.getMatrix(),m=this._labelObj.getMatrix();p.equals(m)||(this._labelObj.setMatrix(p),i.getAnimator().addProp(t.Animator.TYPE_MATRIX,this._labelObj,this._labelObj.getMatrix,this._labelObj.setMatrix,m))}u._animateFill(i,n._background,this._background),u._animateFill(i,n._shape,this._shape)}e.add(i,d.UPDATE)},u.prototype._animateCustomUpdate=function(e,n){var i=n.getContentBounds(),o=this.getContentBounds();if(i.equals(o)){var a=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration());return u._animatePosition(a,n,this),void e.add(a,d.UPDATE)}var s=o.w/i.w,r=i.w/o.w,l=(a=new t.CustomAnimation(this.getCtx(),null,e.getAnimationDuration()),new t.Point(n.getTranslateX()+.5*i.w,n.getTranslateY()+.5*i.h)),h=this.getTranslateX(),g=this.getTranslateY();this.setTranslateX(l.x-o.w*r*.5),this.setTranslateY(l.y-o.w*r*.5),a.getAnimator().addProp(t.Animator.TYPE_NUMBER,this,this.getTranslateX,this.setTranslateX,h),a.getAnimator().addProp(t.Animator.TYPE_NUMBER,this,this.getTranslateY,this.setTranslateY,g),e.add(a,d.UPDATE),this.setScaleX(r),this.setScaleY(r);var c=new t.AnimScaleTo(this.getCtx(),this,new t.Point(1,1),e.getAnimationDuration());e.add(c,d.UPDATE);var p=n.partialUpdate?n.origContent:n;if(p){this.getParent().addChild(p);var m=new t.Point(this.getTranslateX()+.5*o.w,this.getTranslateY()+.5*o.h);a.getAnimator().addProp(t.Animator.TYPE_NUMBER,p,n.getTranslateX,p.setTranslateX,m.x-i.w*s*.5),a.getAnimator().addProp(t.Animator.TYPE_NUMBER,p,n.getTranslateY,p.setTranslateY,m.y-i.h*s*.5);var _=new t.AnimScaleTo(this.getCtx(),p,new t.Point(s,s),e.getAnimationDuration());e.add(_,d.UPDATE);var f=new t.AnimFadeOut(this.getCtx(),p,e.getAnimationDuration());e.add(f,d.UPDATE);var y=this;t.Playable.appendOnEnd(f,(function(){y.getParent().removeChild(p)})),this.setAlpha(0);var C=new t.AnimFadeIn(this.getCtx(),this,e.getAnimationDuration());e.add(C,d.UPDATE)}},u._animatePosition=function(e,n,i){if(i&&n){var o=n.getTranslateX(),a=n.getTranslateY(),s=i.getTranslateX(),r=i.getTranslateY();o!=s&&(i.setTranslateX(o),e.getAnimator().addProp(t.Animator.TYPE_NUMBER,i,i.getTranslateX,i.setTranslateX,s)),a!=r&&(i.setTranslateY(a),e.getAnimator().addProp(t.Animator.TYPE_NUMBER,i,i.getTranslateY,i.setTranslateY,r))}},u._animateContainer=function(e,n,i){i&&n&&(u._animateFill(e,n,i),e.getAnimator().addProp(t.Animator.TYPE_NUMBER,i,i.getWidth,i.setWidth,i.getWidth()),i.setWidth(n.getWidth()),e.getAnimator().addProp(t.Animator.TYPE_NUMBER,i,i.getHeight,i.setHeight,i.getHeight()),i.setHeight(n.getHeight()))},u._animateFill=function(e,n,i){n&&i&&i.getFill()instanceof t.SolidFill&&!i.getFill().equals(n.getFill())&&(e.getAnimator().addProp(t.Animator.TYPE_FILL,i,i.getFill,i.setFill,i.getFill()),i.setFill(n.getFill()))},u.prototype.animateDelete=function(e,n){this.GetDiagram().getNodesPane().addChild(this);var i=this,o=new t.AnimFadeOut(this.getCtx(),this,e.getAnimationDuration());t.Playable.appendOnEnd(o,(function(){i.getParent().removeChild(i),i.destroy()})),e.add(o,d.DELETE)},u.prototype.animateInsert=function(e){this.setAlpha(0),e.add(new t.AnimFadeIn(this.getCtx(),this,e.getAnimationDuration()),d.INSERT)},u.prototype._getState=function(t){return{hovered:this._isShowingHoverEffect,selected:this.isSelected(),focused:this._isShowingKeyboardFocusEffect,zoom:t||this.GetDiagram().getPanZoomCanvas().getZoom(),expanded:this.isDisclosed()}},u.prototype.rerenderOnZoom=function(t){var e=this._getCustomRenderer("zoomRenderer");if(e){var n=this._getState(t.oldZoom),i=this._getState(t.newZoom);this._applyCustomNodeContent(e,i,n)}},u.prototype.highlight=function(t){if(this._isHighlighted!==t){this._isHighlighted=t;var e=t?1:this._diagram.getOptions().styleDefaults._highlightAlpha;!this._customNodeContent&&this.isDisclosed()?(this._containerShape&&this._containerShape.setAlpha(e),this._containerButton&&this._containerButton.setAlpha(e),this._labelObj&&this._labelObj.setAlpha(e),this._selectionShape&&this._selectionShape.setAlpha(e)):this.setAlpha(e)}},u.prototype.setLabelAlignments=function(e,n){var i=this._labelObj instanceof t.MultilineText||this._labelObj instanceof t.BackgroundMultilineText;"baseline"==n&&(n=i?t.MultilineText.V_ALIGN_TOP:t.OutputText.V_ALIGN_AUTO),this._labelObj.setHorizAlignment(e),this._labelObj.setVertAlignment(n)},u.prototype.getContainerPadding=function(){if(!this._containerPadding&&this._getCustomRenderer("renderer")){var t=this.GetDiagram().getPanZoomCanvas().getZoom(),e=this.getElem().getBoundingClientRect(),n=this._childNodePane?this._childNodePane.getElem().getBoundingClientRect():null;this._containerPadding={left:(n.left-e.left)/t,right:(e.right-n.right)/t,top:(n.top-e.top)/t,bottom:(e.bottom-n.bottom)/t}}else if(!this._containerPadding){var i=this._data.containerSvgStyle||this._data.containerStyle,o=u._getNodeCSSStyle(i,this._data._containerStyle,["padding-left","padding-right","padding-top","padding-bottom"]);this._containerPadding={left:o.getPadding("padding-left"),right:o.getPadding("padding-right"),top:o.getPadding("padding-top"),bottom:o.getPadding("padding-bottom")}}return this._containerPadding},u.prototype.getChildNodeIds=function(){return this._childNodeIds},u.prototype.addChildNodeId=function(t){this._childNodeIds||(this._childNodeIds=[]),this._childNodeIds.push(t)},u.prototype.removeChildNodeId=function(e){this._childNodeIds&&t.ArrayUtils.removeItem(this._childNodeIds,e)},u.prototype.removeChildNode=function(t){t&&(this.removeChildNodeId(t.getId()),this._childNodePane.removeChild(t))},u.prototype.getChildNodes=function(){for(var t=[],e=this._childNodeIds?this._childNodeIds.length:-1,n=0;n<e;n++){var i=this.GetDiagram().getNodeById(this._childNodeIds[n]);i&&t.push(i)}return t},u.prototype.setGroupId=function(t){this._groupId=t},u.prototype.getGroupId=function(){return this._groupId},u.prototype.GetChildNodePane=function(){return this._childNodePane||(this._childNodePane=new t.Container(this.getCtx()),this.addChild(this._childNodePane)),this._childNodePane},u.prototype.handleDisclosure=function(e){t.EventManager.consumeEvent(e),this._diagram.setNodeDisclosed(this.getId(),!this.isDisclosed())},u._renderContainer=function(e,n,i){var o=e.getCtx().isCustomElement()?null:n.containerSvgStyle||n.containerStyle,a=t.JsonUtils.clone(o),s=[t.CSSStyle.BACKGROUND_COLOR,t.CSSStyle.BORDER_COLOR,t.CSSStyle.BORDER_WIDTH,t.CSSStyle.BORDER_RADIUS],r=u._getNodeCSSStyle(a,n._containerStyle,s),d=r.getStyle(t.CSSStyle.BACKGROUND_COLOR),l=r.getStyle(t.CSSStyle.BORDER_COLOR),h=t.CSSStyle.toNumber(r.getStyle(t.CSSStyle.BORDER_WIDTH)),g=t.CSSStyle.toNumber(r.getStyle(t.CSSStyle.BORDER_RADIUS)),c=i.GetChildNodePane(),p=i.getContainerPadding();c.setTranslate(p.left,p.top);var m=c.getDimensionsWithStroke(),_=new t.Rect(e.getCtx(),0,0,m.w+p.left+p.right,m.h+p.top+p.bottom);_.setSolidFill(d),g&&(_.setRx(g),_.setRy(g)),l&&_.setStroke(new t.Stroke(l,1,h)),a&&s.forEach((function(e){delete a[t.CSSStyle.cssStringToObjectProperty(e)]}));var f=e.getCtx().isCustomElement()?null:n.containerSvgClassName||n.containerClassName;_.setStyle(a).setClassName(f),i.addChildAt(_,0),i.setSelectionShape(_),i._containerShape=_},u._getNodeCSSStyle=function(e,n,i){var o=new t.CSSStyle;return i.forEach((function(i){var a=null,s=t.CSSStyle.cssStringToObjectProperty(i);e&&null!=e[s]?a=e[s]:n&&(a=n.getStyle(i)),o.setStyle(i,a)})),o},u._renderContainerButton=function(e,n,i){if(i.isContainer()&&"off"!=n.showDisclosure){var o,a,s,r=e.getOptions();i.isDisclosed()?(o=r._resources.collapse_ena,a=r._resources.collapse_ovr,s=r._resources.collapse_dwn):(o=r._resources.expand_ena,a=r._resources.expand_ovr,s=r._resources.expand_dwn);var d=new t.Image(e.getCtx(),o.src,0,0,o.width,o.height),l=new t.Image(e.getCtx(),a.src,0,0,a.width,a.height),h=new t.Image(e.getCtx(),s.src,0,0,s.width,s.height),g=new t.Button(e.getCtx(),d,l,h,null,null,i.handleDisclosure,i);i.addChild(g);var u=i.getContentBounds(!0);if(u){var c=t.Agent.isRightToLeft(e.getCtx())?u.x+u.w-o.width:u.x,p=u.y;g.setTranslate(c,p)}i._containerButton=g}},u.prototype.isDragAvailable=function(t){return!0},u.prototype.getDragTransferable=function(t,e){return this._isDraggable()?[this.getId()]:null},u.prototype.getDragFeedback=function(t,e){if(this._diagram.getEventManager().LinkCreationStarted)return null;if(this._diagram.isSelectionSupported()&&this._diagram.getSelectionHandler().getSelectedCount()>1){for(var n=this._diagram.getSelectionHandler().getSelection(),i=[],o=0;o<n.length;o++)i.push(n[o]);return i}return this},u.prototype.ShowDropEffect=function(){this._dropEffect||this._createDropEffect("oj-diagram-node oj-active-drop")},u.prototype.ShowRejectedDropEffect=function(){this._dropEffect||this._createDropEffect("oj-diagram-node oj-invalid-drop")},u.prototype.ClearDropEffect=function(){this._dropEffect&&(this.removeChild(this._dropEffect),this._dropEffect=null)},u.prototype._createDropEffect=function(e){var n;if(this._customNodeContent||this.isDisclosed()||this._background||this._shape&&this._shape instanceof t.ImageMarker){var i=this.getContentBounds(!0);if(i){n=new t.Rect(this._diagram.getCtx(),i.x,i.y,i.w,i.h);var o=this._customNodeContent?null:this.isDisclosed()?this._containerShape.getRx():this._background?this._background.getRx():null;o&&(n.setRx(o),n.setRy(o))}}else this._shape&&this._shape instanceof t.SimpleMarker&&(n=this._shape.copyShape());n.setInvisibleFill(),n.setClassName(e),n.setMouseEnabled(!1),this.addChild(n),this._dropEffect=n},u.prototype._setDraggableStyleClass=function(){if(this._diagram.getEventManager().IsDragSupported()&&this._isDraggable()){var e=this._customNodeContent?this:this.isDisclosed()?this._containerShape:this._background?this._background:this._shape,n=e.getElem()?e.getElem():e;t.ToolkitUtils.addClassName(n,"oj-diagram-node"),t.ToolkitUtils.addClassName(n,"oj-draggable")}},u.prototype._isDraggable=function(){return"off"!==this.getData().draggable&&!1!==this.getData().draggable},u.ConvertNodeData=function(t){return{id:t.id,label:t.label,selectable:t.selectable,shortDesc:t.shortDesc,categories:t.categories,nodes:t.nodes,_itemData:t}},u.prototype._cleanUp=function(e){if(this._containerShape&&(this.removeChild(this._containerShape),e&&e.addChild(this._containerShape),this._containerShape=null),this._background&&(this.removeChild(this._background),e&&e.addChild(this._background),this._background=null),this._shape&&(this.removeChild(this._shape),e&&e.addChild(this._shape),this._shape=null),this._labelObj&&(this.removeChild(this._labelObj),e&&e.addChild(this._labelObj),this._labelObj=null),this._containerButton&&(this.removeChild(this._containerButton),e&&e.addChild(this._containerButton),this._containerButton=null),this._customNodeContent){if(this._childNodePane&&(this._childNodePane.setParent(null),this.addChild(this._childNodePane)),this._customNodeContent.namespaceURI===t.ToolkitUtils.SVG_NS)this.getContainerElem().removeChild(this._customNodeContent),e&&t.ToolkitUtils.appendChildElem(e.getContainerElem(),this._customNodeContent);else if(Array.isArray(this._customNodeContent))for(var n=0;n<this._customNodeContent.length;n++)this.getContainerElem().removeChild(this._customNodeContent[n]),e&&t.ToolkitUtils.appendChildElem(e.getContainerElem(),this._customNodeContent[n]);else this._customNodeContent instanceof t.BaseComponent&&(this.removeChild(this._customNodeContent),e&&e.addChild(this._customNodeContent));this._customNodeContent=null}this._contentDims=null},u.prototype.getAnimationState=function(e){var n,i,o,a,s,r=this.getContentBounds();return this._shape&&((n={centerDimensions:this._shape.getCenterDimensions(),fill:this._shape.getFill()}).getCenterDimensions=function(){return n.centerDimensions},n.getFill=function(){return n.fill}),this._labelObj&&((i={matrix:this._labelObj.getMatrix()}).getMatrix=function(){return i.matrix}),this.isDisclosed()&&this._containerShape&&((o={fill:this._containerShape.getFill(),width:this._containerShape.getWidth(),height:this._containerShape.getHeight()}).getFill=function(){return o.fill},o.getWidth=function(){return o.width},o.getHeight=function(){return o.height}),e&&(s=new t.Container(this.getCtx()),this._cleanUp(s),s.setTranslate(this.getTranslateX(),this.getTranslateY())),(a={partialUpdate:!0,id:this.getId(),disclosed:this.isDisclosed(),tx:this.getTranslateX(),ty:this.getTranslateY(),contentBounds:r,origContent:s,_shape:n,_labelObj:i,_containerShape:o}).getId=function(){return a.id},a.isDisclosed=function(){return a.disclosed},a.getTranslateX=function(){return a.tx},a.getTranslateY=function(){return a.ty},a.getContentBounds=function(){return a.contentBounds},a},u.prototype.appendChildNodesData=function(e,n){this._data.nodes instanceof Array||(this._data.nodes=[]),this._data.nodes=t.ArrayUtils.insert(this._data.nodes,e,n)},u.prototype.removeChildNodesData=function(t){if(this._data.nodes instanceof Array)for(var e=0;e<t.length;e++)for(var n=t[e].id,i=0;i<this._data.nodes.length;i++)if(this._data.nodes[i].id===n){this._data.nodes.splice(i,1);break}},u.prototype._getCustomRenderer=function(t){var e=this._diagram.getOptions().nodeContent,n=null;if(e){var i=e.renderer;n=e[t],n=i&&n?n:null}return n},u.prototype._checkAndMoveContents=function(){return!!this._hasContentBoundToTouchEvent&&(this.GetDiagram().storeTouchEventContent(this._customNodeContent,this),this._contentStoredInTouchEventContainer=this._customNodeContent,this._hasContentBoundToTouchEvent=!1,!0)};
/**
   * @license
   * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * @ignore
   */
var c=function(t){this.Init(t)};t.Obj.createSubclass(c,t.Automation,"DvtDiagramAutomation"),c.prototype.Init=function(t){this._diagram=t},c.prototype.GetSubIdForDomElement=function(t){var e=this._diagram.getEventManager().GetLogicalObject(t);return e&&e instanceof u?"node["+this._diagram.GetAllNodes().indexOf(e.getId())+"]":e&&e instanceof g?"link["+this._diagram.GetAllLinks().indexOf(e.getId())+"]":null},c.prototype.getDomElementForSubId=function(e){if(e==t.Automation.TOOLTIP_SUBID)return this.GetTooltipElement(this._diagram);var n=this._parseSubId(e),i=n.component,o=n.index,a=null;return"node"==i?a=this._getNode(o):"link"==i&&(a=this._getLink(o)),a?a.getElem():null},c.prototype._parseSubId=function(t){var e=t,n=-1,i=t.substring(0,t.indexOf("["));return i&&(e="node"==i||"link"==i?i:null,n=parseInt(t.substring(t.indexOf("[")+1,t.indexOf("]")))),{component:e,index:n}},c.prototype.getNodeCount=function(){return this._diagram.GetAllNodes().length},c.prototype.getLinkCount=function(){return this._diagram.GetAllLinks().length},c.prototype.getNode=function(e){var n=this._getNode(e);if(n){var i={};i.id=n.getId(),i.selected=n.isSelected(),i.tooltip=n.getShortDesc(),i.label=n.getData().label;var o=n.getData().backgroundStyle;return o&&o instanceof Object&&(o=t.CSSStyle.cssObjectToString(o)),i.background=o,i.icon=this._getMarkerData(n.GetIcon()),i.expanded=n.isDisclosed(),i}return null},c.prototype.getLink=function(e){var n=this._getLink(e);if(n){var i={};return i.id=n.getId(),i.selected=n.isSelected(),i.tooltip=n.getShortDesc(),i.label=n.getData().label,i.color=n.getLinkColor(),i.width=n.getLinkWidth(),i.style=this._getLinkStyleFromObject(n.getLinkStyle()),i.startNode=n.getStartId(),i.endNode=n.getEndId(),i.startConnectorType=n.getStartConnectorType(),i.endConnectorType=n.getEndConnectorType(),i.promoted=n.isPromoted(),n.isPromoted()&&(i.links=t.JsonUtils.clone(n.getData()._links)),i}return null},c.prototype.getPromotedLink=function(t,e){var n=this._getNode(t),i=this._getNode(e);if(!n||!i)return null;var o=g.GetPromotedLinkId(this._diagram,n.getId(),i.getId()),a=this._diagram.getLinkById(o);if(a){var s={};return s.id=a.getId(),s.selected=a.isSelected(),s.tooltip=a.getShortDesc(),s.color=a.getLinkColor(),s.width=a.getLinkWidth(),s.style=this._getLinkStyleFromObject(a.getLinkStyle()),s.startNode=a.getStartId(),s.endNode=a.getEndId(),s.startConnectorType=a.getStartConnectorType(),s.endConnectorType=a.getEndConnectorType(),s.count=a.getData()._links.length,s}return null},c.prototype._getLinkStyleFromObject=function(e){if(this._diagram.getCtx().isCustomElement())return t.CSSStyle.cssObjectToString(e);if(e&&e instanceof Object){if(e._type==g.CUSTOM_STYLE){var n=t.JsonUtils.clone(e);return delete n._type,t.CSSStyle.cssObjectToString(n)}return e._type}return e},c.prototype.getExpanded=function(){return this._diagram.DisclosedNodes},c.prototype._getMarkerData=function(e){if(e){var n={};return n.shape=e instanceof t.SimpleMarker?e.getType():"none",e.getFill()&&(n.color=e.getFill().getColor()),n}return null},c.prototype._getNode=function(t){var e=this._diagram.GetAllNodes();return t>=0&&t<e.length?this._diagram.getNodeById(e[t]):null},c.prototype._getLink=function(t){var e=this._diagram.GetAllLinks();return t>=0&&t<e.length?this._diagram.getLinkById(e[t]):null}}(e),e}));