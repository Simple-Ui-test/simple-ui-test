/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
define(["ojs/ojcore","jquery","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojlogger"],(function(t,e,o,s,n){"use strict";var i={properties:{chroming:{type:"string",enumValues:["borderless","full","half","outlined","solid"]},translations:{type:"object",value:{}}},methods:{refresh:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},extension:{}};t.__registerWidget("oj.ojToolbar",e.oj.baseComponent,{widgetEventPrefix:"oj",options:{chroming:"borderless"},_InitOptions:function(t,e){this._super(t,e),"disabled"in e&&n.warn("Caller attempted to set the 'disabled' option on Toolbar, but Toolbar does not support the 'disabled' option.  See API doc.")},_ComponentCreate:function(){this._super();var t=this.element[0];t.setAttribute(s._OJ_CONTAINER_ATTR,this.widgetName),t.classList.add("oj-toolbar"),t.classList.add("oj-component"),t.setAttribute("role","toolbar"),this._hasInitialFocusHandler=!1,this._setup()},_NotifyContextMenuGesture:function(t,e,o){var s=this.element.find(":oj-button[tabindex=0]");this._OpenContextMenu(e,o,{launcher:s,position:{of:"keyboard"===o?s.ojButton("widget"):e}})},_setOption:function(t,e){"disabled"!==t?(this._superApply(arguments),"chroming"===t&&this._refreshChildren()):n.warn("Caller attempted to set the 'disabled' option on Toolbar, but Toolbar does not support the 'disabled' option.  See API doc.  Ignoring the call.")},refresh:function(){this._super(),this._setup(),this._refreshTabindex()},_setup:function(){var t=this,o=this.element[0];this.isRtl="rtl"===this._GetReadingDirection(),this.$enabledButtons=e(),this._IsCustomElement()?(this._hasInitialFocusHandler||(this._focusinListener=function(e){t._handleInitialFocus()},o.addEventListener("focusin",this._focusinListener,!0),this._hasInitialFocusHandler=!0),this.topLevelChildren=o.querySelectorAll("oj-button, oj-menu-button, oj-buttonset-one, oj-buttonset-many"),this._refreshChildren()):(this.$buttons=this.element.find(":oj-button").unbind("keydown"+this.eventNamespace).bind("keydown"+this.eventNamespace,(function(o){t._handleKeyDown(o,e(this))})).unbind("click"+this.eventNamespace).bind("click"+this.eventNamespace,(function(o){e(this).ojButton("option","disabled")||t._setTabStop(e(this))})).unbind("focus"+this.eventNamespace).bind("focus"+this.eventNamespace,(function(o){t._handleFocus(e(this))})),this.$buttonsets=this.element.find(":oj-buttonset").ojButtonset("refresh"),this.$topLevelButtons=this.$buttons.not(this.$buttonsets.find(":oj-button")).ojButton("refresh"))},_handleFocus:function(t){this._IsCustomElement()||0!==this.$enabledButtons.length?this._setTabStop(t):(this.$enabledButtons=this.$buttons.filter((function(){return!e(this).ojButton("option","disabled")})),this._initTabindexes(null==this._lastTabStop),this.$enabledButtons[0].focus())},_handleInitialFocus:function(){var t=this,o=this.element[0];o.removeEventListener("focusin",this._focusinListener,!0),this._hasInitialFocusHandler=!1,this.topLevelChildren=o.querySelectorAll("oj-button, oj-menu-button, oj-buttonset-one, oj-buttonset-many");var s=o.querySelectorAll("oj-button, oj-menu-button, oj-buttonset-one .oj-button, oj-buttonset-many .oj-button");this.$buttons=e(s).unbind("keydown"+this.eventNamespace).bind("keydown"+this.eventNamespace,(function(o){var s=e(this);t._handleKeyDown(o,s)})).unbind("click"+this.eventNamespace).bind("click"+this.eventNamespace,(function(o){var s=e(this);s.hasClass("oj-disabled")||t._setTabStop(s)})).unbind("focusin"+this.eventNamespace).bind("focusin"+this.eventNamespace,(function(o){var s=e(this);t._handleFocus(s)})),this._IsCustomElement()?this.$enabledButtons=this.$buttons.filter((function(){return!e(this).hasClass("oj-disabled")})):this.$enabledButtons=this.$buttons.filter((function(){return!e(this).ojButton("option","disabled")})),this._initTabindexes(null==this._lastTabStop),this._getButtonFocusElem(this.$enabledButtons[0]).focus()},_refreshTabindex:function(){void 0!==this.$buttons&&(this._IsCustomElement()?this.$enabledButtons=this.$buttons.filter((function(){return!e(this).hasClass("oj-disabled")})):this.$enabledButtons=this.$buttons.filter((function(){return!e(this).ojButton("option","disabled")})),this._initTabindexes(null==this._lastTabStop))},_getButtonFocusElem:function(t){var e=t;if(void 0!==t&&this._IsCustomElement()){var o="button";t.classList.contains("oj-button-toggle")&&(o="input");for(var s=t.children,n=0;n<s.length;n++){var i=s[n];if(i.tagName.toLowerCase()===o){e=i;break}}}return e},_initTabindexes:function(t){var o,s=e(this._lastTabStop);if(this._lastTabStop=void 0,this._IsCustomElement())for(var n=0;n<this.$buttons.length;n++)this._getButtonFocusElem(this.$buttons[n]).setAttribute("tabindex","-1");else this.$buttons.attr("tabindex","-1");o=t||!s.is(this.$enabledButtons)?this.$enabledButtons.first():s,this._setTabStop(o)},_mapToTabbable:function(t){for(var o=[],s=0;s<this.$enabledButtons.length;s++)o.push(this._getButtonFocusElem(this.$enabledButtons[s]));var n=e(o);return t.map((function(t,e){if("radio"!==e.type||e.checked||""===e.name)return e;var o=function(t,e){var o,s=t.name;if(s){var n=":radio[name='"+(s=s.replace(/'/g,"\\'"))+"']:oj-button";o=e.filter(n)}else o=e.filter(t).filter(":oj-button");return o}(e,n).filter(":checked");return o.length?o[0]:e}))},_setTabStop:function(t){var o=t,s=(o=this._IsCustomElement()?this._mapToTabbable(e(this._getButtonFocusElem(o[0]))):this._mapToTabbable(o))[0],n=this._lastTabStop;s!==n&&(e(n).attr("tabindex","-1"),o.attr("tabindex","0"),this._lastTabStop=s)},_handleKeyDown:function(t,o){switch(t.which){case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:if("radio"!==o.attr("type"))break;case e.ui.keyCode.LEFT:case e.ui.keyCode.RIGHT:t.preventDefault();var s=this.$enabledButtons,n=s.length;if(n<2)break;var i=(s.index(o)+(t.which===e.ui.keyCode.DOWN||t.which===e.ui.keyCode.RIGHT^this.isRtl?1:-1)+n)%n;this._getButtonFocusElem(s.eq(i)[0]).focus()}},_destroy:function(){var t=this.element[0];t.classList.remove("oj-toolbar"),t.classList.remove("oj-component"),t.removeAttribute(s._OJ_CONTAINER_ATTR),t.removeAttribute("role"),this.$buttons.attr("tabindex","0"),this._refreshChildren()},_refreshChildren:function(){if(this._IsCustomElement())for(var t=0;t<this.topLevelChildren.length;t++){var e=this.topLevelChildren[t];"OJ-BUTTON"===e.tagName||"OJ-MENU-BUTTON"===e.tagName?s.__GetWidgetConstructor(this._getButtonFocusElem(e),"ojButton")&&e.refresh():"OJ-BUTTONSET-ONE"!==e.tagName&&"OJ-BUTTONSET-MANY"!==e.tagName||s.__GetWidgetConstructor(e,"ojButtonset")&&e.refresh()}else this.$buttonsets.ojButtonset("refresh"),this.$topLevelButtons.ojButton("refresh")}}),s.setDefaultOptions({ojToolbar:{chroming:s.createDynamicPropertyGetter((function(){return(o.parseJSONFromFontFamily("oj-toolbar-option-defaults")||{}).chroming}))}}),i.extension._WIDGET_NAME="ojToolbar",t.CustomElementBridge.register("oj-toolbar",{metadata:i})}));